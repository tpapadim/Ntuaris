.head 0 +  Application Description: Gupta SQLWindows Standard Application Template
.data CLASSPROPSSIZE
0000: F202
.enddata
.data CLASSPROPS
0000: 5761746368566172 7300A602734B5F46 006E416B45677200 7358554567720073
0020: 46696E6400735265 6D61696E53747200 734B5F46006E416B 4567720073585545
0040: 67720073456A4567 7200734B61744567 72006E4B5F6D4567 7200734F6D616461
0060: 45677200734F6E6C 79526F6573537472 00734141526F6573 5374720073526F65
0080: 7344696C4567725B 335D0073526F6573 44696C4567725B32 5D0073526F657344
00A0: 696C4567725B315D 0073526F65734469 6C4567725B305D00 7352466F69745B69
00C0: 5D0073524567725B 6D5D0069006D006E 52466F6974007359 00734C0073480073
00E0: 4400735400735300 735A007345007349 00734D0073460073 4141526F68007341
0100: 41526F6573537472 0073526F68436F6C 756D6E0073526F68 547970650073526F
0120: 6573537472456772 00734B6174537466 0073456A4B617445 677200734B617452
0140: 6F65730073526F68 5B6E525D00735371 6C436F6D5F53656C 5970636F75727365
0160: 0053716C44617461 626173650053716C 557365720053716C 50617373776F7264
0180: 0073747253657373 696F6E00734B5F46 006E416B45677200 73456A4567720073
01A0: 4B6174456772006E 4B5F6D4567720073 4F6D616461456772 006853656C597063
01C0: 6F75727365007349 736F6C6174696F6E 4C6576656C005371 6C49736F6C617469
01E0: 6F6E4C6576656C00 7342696E645F5365 6C5970636F757273 6500735374724B6D
0200: 4F626C6900735371 6C436F6D5F53656C 5970636F75727365 4578697374730073
0220: 4D7367496E734572 726F7200734D7367 5970636F75727365 0073456A4B617445
0240: 6772006E416B4567 72007352656D6169 6E537472006E5374 724F666673657400
0260: 7353706C69747465 645374720073526F 6854797065007352 6F68436F6C756D6E
0280: 0073526F68547970 6500734141526F65 735374720073526F 68436F6465456772
02A0: 0073526F65734469 6C4567720073526F 6800004442475F50 4C41594241434B5F
02C0: 47554944001000EE C6029F05B2DE4A9B B9EAA8E5F576A500 5761746368566172
02E0: 734C656E000400A6 0200000000000000 0000
.enddata
.head 1 -  Outline Version - 4.0.35
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000003B0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE2FFFFFFFFFFFF FF00000000FC0400 00B2020000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D0200000012496E 7465726E616C2046
0080: 756E6374696F6E73 0F496E697469616C 697A655F494E544F
.enddata
.data DT_MAKERUNDLG
0000: 0900001000000000 21433A5C4E545541 5249535C494D4147 45535C49434F5C41
0020: 434144454D592E69 636F25433A5C4E54 55415249535C454B 444F534549535C45
0040: 58455C4E54554152 574549532E657865 3A433A5C4E545541 5249535C454B444F
0060: 534549535C455845 5C4B595F5745425F 4149545F45475241 4645535F76312E30
0080: 5F3037303230382E 646C6C3A433A5C4E 5455415249535C45 4B444F534549535C
00A0: 4558455C4B595F57 45425F4149545F45 4752414645535F76 312E305F30373032
00C0: 30382E6170630000 0101010064000000 0000000101010101 012ED02E0D224B59
00E0: 5F5745425F414954 5F45475241464553 5F76312E305F3037 303230382E617064
0100: 224B595F5745425F 4149545F45475241 4645535F76312E30 5F3037303230382E
0120: 646C6C224B595F57 45425F4149545F45 4752414645535F76 312E305F30373032
0140: 30382E6170630000 0101010064000000 224B595F5745425F 4149545F45475241
0160: 4645535F76312E30 5F3037303230382E 61706C224B595F57 45425F4149545F45
0180: 4752414645535F76 312E305F30373032 30382E646C6C224B 595F5745425F4149
01A0: 545F454752414645 535F76312E305F30 37303230382E6170 6300000101010064
01C0: 000000224B595F57 45425F4149545F45 4752414645535F76 312E305F30373032
01E0: 30382E657865224B 595F5745425F4149 545F454752414645 535F76312E305F30
0200: 37303230382E646C 6C224B595F574542 5F4149545F454752 414645535F76312E
0220: 305F303730323038 2E61706300000101 010064000000224B 595F5745425F4149
0240: 545F454752414645 535F76312E305F30 37303230382E646C 6C224B595F574542
0260: 5F4149545F454752 414645535F76312E 305F303730323038 2E646C6C224B595F
0280: 5745425F4149545F 454752414645535F 76312E305F303730 3230382E61706300
02A0: 0001010100640000 00224B595F574542 5F4149545F454752 414645535F76312E
02C0: 305F303730323038 2E646C6C224B595F 5745425F4149545F 454752414645535F
02E0: 76312E305F303730 3230382E646C6C22 4B595F5745425F41 49545F4547524146
0300: 45535F76312E305F 3037303230382E61 7063000001010100 6400000000000000
0320: 094E545541525745 495333C5E8EDE9EA FC20CCE5F4F3FCE2 E9EF20D0EFEBF5F4
0340: E5F7EDE5DFEF2C20 C4E9E5FDE8F5EDF3 E720D0EBE7F1EFF6 EFF1E9EADEF20731
0360: 2E302E342E30000D 4E54554152574549 532E455845063230 30352E3100000000
0380: 000000001BC4E9E5 FDE8F5EDF3E720D0 EBE7F1EFF6EFF1E9 EADEF22032303132
03A0: 4EC4E9E5FDE8F5ED F3E720D0EBE7F1EF F6EFF1E9EADEF220 D4ECDEECE120E1ED
03C0: DCF0F4F5EEE7F220 2620F3F5EDF4DEF1 E7F3E7F220F0EBE7 F12E20F3F5F3F4E7
03E0: ECDCF4F9ED20C4E9 EFDFEAE7F3E7F237 C5E9F3E1E3F9E3DE 20E1E9F4DEF3E5F9
0400: ED20E5E3E3F1E1F6 FEED20E1F0FC206F 6E6C696E6520E1E9 F4DEF3E5E9F220F6
0420: EFE9F4E7F4FEED02 000C446174652063 7265617465640744 657461696C730200
0440: 0B30312044656320 3230313650C5E9F3 DCE3E5E920F4E9F2 20E5E3E3F1E1F6DD
0460: F220F3F4EF20F4F1 DDF7EFED20E5EEDC ECE7EDEF2C20EAE1 E8FEF220EAE1E920
0480: F4E9F220F5F0EFF7 F1E5FEF3E5E9F220 F4F9ED20F6EFE9F4 E7F4FEED2E000100
04A0: 0000010000000100 0100000000000000 0001000010000000 0000000000000000
04C0: 00
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  ! File Include: C:\NTUARIS\DEPLOY\LIBRARIES\MIMAPL\mimemp.APL
.head 2 -  ! File Include: C:\NTUARIS\DEPLOY\LIBRARIES\EMP\EMP_XPButton_v1.apl
.head 2 -  File Include: C:\NTUARIS\DEPLOY\LIBRARIES\EMP\InternalFunctions.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 -  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 -  System
.head 3 -  User
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.head 3 -  ! Number: nLen
.head 3 -  ! String: sWorkTmima
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! New variables
.head 3 -  Sql Handle: hSession
.head 3 -  Sql Handle: hSqlHandler
.head 3 -  Sql Handle: hGetSxoli
.head 3 -  Sql Handle: hEgrSel
.head 3 -  Sql Handle: hSt_fUpdt
.head 3 -  Sql Handle: hSt_fProg9
.head 3 -  Sql Handle: hEgrChkExist
.head 3 -  Sql Handle: hEgrReply
.head 3 -  Sql Handle: hEgrIns
.head 3 -  Sql Handle: hEgrUpdt
.head 3 -  ! Sql Handle: hKmExistObli
.head 3 -  Sql Handle: hSelYpcourse
.head 3 -  Sql Handle: hInsObl
.head 3 -  Sql Handle: hInsEpilo
.head 3 -  Sql Handle: hGetEjDilKat
.head 3 -  Sql Handle: hInsRohfoit
.head 3 -  Sql Handle: hChkRoesFoit
.head 3 -  Sql Handle: hChkRoesFoit3
.head 3 -  Sql Handle: hOmadalekt3
.head 3 -  Sql Handle: hHlek_InsRohFoit
.head 3 -  Sql Handle: hHlek_GetYpcourse
.head 3 -  Sql Handle: hHlek_GetSymbolRoh
.head 3 -  Sql Handle: hHlek_UpdtAlterRoh
.head 3 -  ! Sql Handle: hSelYpcourseExists
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 -  Sql Handle: hCountBegEgr
.head 3 -  Sql Handle: hCountFinEgr
.head 3 -  Sql Handle: hGetSxoliCode
.head 3 -  Sql Handle: hUpdtKat
.head 3 -  Sql Handle: hCountEjEgr
.head 3 -  Sql Handle: hCountOblistu
.head 3 -  Sql Handle: hMaxChoice
.head 3 -  Sql Handle: hYpMaxChoice
.head 3 -  Sql Handle: hGetKatStf
.head 3 -  ! SQLIMMEDIATE
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 3 -  Sql Handle: hEgrPros
.head 3 -  Sql Handle: hOblDPros
.head 3 -  Sql Handle: hOblUPros
.head 3 -  Sql Handle: hEgrPrPros
.head 3 -  Sql Handle: hOblDPrPros
.head 3 -  Sql Handle: hOblUPrPros
.head 3 -  !
.head 3 -  Boolean: bExit
.head 3 -  ! Boolean: bDetails
.head 3 -  Boolean: bOkSession
.head 3 -  Boolean: bOkStatement
.head 3 -  Boolean: bContinueProc
.head 3 -  Boolean: bOblistud_Insert
.head 3 -  Boolean: bSqlError
.head 3 -  ! Boolean: bOblKmExists
.head 3 -  !
.head 3 -  String: sBaseName
.head 3 -  String: sUsername
.head 3 -  String: sPassword
.head 3 -  String: sIsolationLevel
.head 3 -  String: strSession
.head 3 -  ! String: sUseronoma
.head 3 -  String: sInto_GetSxoli
.head 3 -  String: sInto_EgrSel
.head 3 -  String: sInto_EgrChkExist
.head 3 -  ! String: sInto_KmExistObli
.head 3 -  String: sInto_SelYpcourse
.head 3 -  String: sInto_GetEjDilKat
.head 3 -  String: sInto_ChkRoesFoit
.head 3 -  String: sInto_ChkRoesFoit3
.head 3 -  String: sInto_Omadalekt3
.head 3 -  String: sInto_Hlek_GetYpcourse
.head 3 -  String: sInto_Hlek_GetSymbolRoh
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 -  String: sInto_CountBegEgr
.head 3 -  String: sInto_CountFinEgr
.head 3 -  String: sInto_GetSxoliCode
.head 3 -  String: sInto_UpdtKat
.head 3 -  String: sInto_CountEjEgr
.head 3 -  String: sInto_CountOblistu
.head 3 -  String: sInto_MaxChoice
.head 3 -  String: sInto_YpMaxChoice
.head 3 -  String: sInto_GetKatStf
.head 3 -  ! SQLIMMEDIATE
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  String: sBind_EgrSel
.head 3 -  String: sBind_StfUpdt
.head 3 -  String: sBind_StfProg9
.head 3 -  String: sBind_EgrChkExist
.head 3 -  String: sBind_EgrReply
.head 3 -  String: sBind_EgrIns
.head 3 -  String: sBind_EgrUpdt
.head 3 -  ! String: sBind_KmExistObli
.head 3 -  String: sBind_SelYpcourse
.head 3 -  String: sBind_InsObl
.head 3 -  String: sBind_InsEpilo
.head 3 -  String: sBind_GetEjDilKat
.head 3 -  String: sBind_InsRohfoit
.head 3 -  String: sBindHlek_InsRohFoit
.head 3 -  String: sBind_ChkRoesFoit
.head 3 -  String: sBind_ChkRoesFoit3
.head 3 -  String: sBind_Omadalekt3
.head 3 -  String: sBind_Hlek_GetYpcourse
.head 3 -  String: sBind_Hlek_GetSymbolRoh
.head 3 -  String: sBind_Hlek_UpdtAlterRoh
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 -  String: sBind_CountBegEgr
.head 3 -  String: sBind_CountFinEgr
.head 3 -  String: sBind_GetSxoliCode
.head 3 -  String: sBind_UpdtKat
.head 3 -  String: sBind_CountEjEgr
.head 3 -  String: sBind_CountOblistu
.head 3 -  String: sBind_MaxChoice
.head 3 -  String: sBind_YpMaxChoice
.head 3 -  String: sBind_GetKatStf
.head 3 -  ! SQLIMMEDIATE
.head 3 -  !
.head 3 -  !
.head 3 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 3 -  String: sBind_EgrPros
.head 3 -  String: sBind_St_fUpdt
.head 3 -  String: sBind_OblDPros
.head 3 -  String: sBind_OblUPros
.head 3 -  String: sBind_EgrPrPros
.head 3 -  String: sBind_St_fPrUpdt
.head 3 -  String: sBind_OblDPrPros
.head 3 -  String: sBind_OblUPrPros
.head 3 -  !
.head 3 -  String: sSqlCom_GetSxoli
.head 3 -  String: sSqlCom_EgrSel
.head 3 -  String: sSqlCom_St_fUpdt
.head 3 -  String: sSqlCom_St_fProg9
.head 3 -  String: sSqlCom_EgrChkExist
.head 3 -  String: sSqlCom_EgrReply
.head 3 -  String: sSqlCom_EgrIns
.head 3 -  String: sSqlCom_EgrUpdt
.head 3 -  ! String: sSqlCom_KmExistObli
.head 3 -  String: sSqlCom_SelYpcourse
.head 3 -  String: sSqlCom_InsObl
.head 3 -  String: sSqlCom_InsEpilo
.head 3 -  String: sSqlCom_GetEjDilKat
.head 3 -  String: sSqlCom_InsRohfoit
.head 3 -  String: sSqlComHlek_InsRohFoit
.head 3 -  String: sSqlCom_ChkRoesFoit
.head 3 -  String: sSqlCom_ChkRoesFoit3
.head 3 -  String: sSqlCom_Omadalekt3
.head 3 -  String: sSqlCom_Hlek_GetYpcourse
.head 3 -  String: sSqlCom_Hlek_GetSymbolRoh
.head 3 -  String: sSqlCom_Hlek_UpdtAlterRoh
.head 3 -  ! String: sSqlCom_SelYpcourseExists
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 -  String: sSqlCom_CountBegEgr
.head 3 -  String: sSqlCom_CountFinEgr
.head 3 -  String: sSqlCom_GetSxoliCode
.head 3 -  String: sSqlCom_UpdtKat
.head 3 -  String: sSqlCom_CountEjEgr
.head 3 -  String: sSqlCom_CountOblistu
.head 3 -  String: sSqlCom_MaxChoice
.head 3 -  String: sSqlCom_YpMaxChoice
.head 3 -  String: sSqlCom_GetKatStf
.head 3 -  ! SQLIMMEDIATE
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 3 -  String: sSqlCom_EgrPros
.head 3 -  String: sSqlCom_OblDPros
.head 3 -  String: sSqlCom_OblUPros
.head 3 -  String: sSqlCom_EgrPrPros
.head 3 -  String: sSqlCom_OblDPrPros
.head 3 -  String: sSqlCom_OblUPrPros
.head 3 -  !
.head 3 -  String: sSqlCom_DelEgrPros
.head 3 -  String: sSqlCom_DelOblDPros
.head 3 -  String: sSqlCom_DelOblUPros
.head 3 -  String: sSqlCom_DelEgrPrPros
.head 3 -  String: sSqlCom_DelOblDPrPros
.head 3 -  String: sSqlCom_DelOblUPrPros
.head 3 -  !
.head 3 -  Number: nCodeTmima
.head 3 -  !
.head 3 -  String: sK_F
.head 3 -  Long String: sMsg
.head 3 -  String: sMsgEgr
.head 3 -  String: sMsgEgr1
.head 3 -  String: sMsgEgr2
.head 3 -  String: sMsgEgr3
.head 3 -  String: sMsgEgr4
.head 3 -  String: sMsgEgr5
.head 3 -  String: sMsgEgr6
.head 3 -  String: sMsgEgr7
.head 3 -  String: sMsgEgr8
.head 3 -  String: sMsgEgr9
.head 3 -  String: sMsgKatRoes
.head 3 -  String: sMsgKatRoes1
.head 3 -  String: sMsgKatRoes2
.head 3 -  String: sMsgKatRoes3a
.head 3 -  String: sMsgKatRoes3b
.head 3 -  String: sMsgKatRoes4
.head 3 -  String: sMsgKatRoes5
.head 3 -  String: sMsgKatRoes6
.head 3 -  String: sMsgKatRoes7
.head 3 -  String: sMsgKatRoes8
.head 3 -  String: sMsgKatRoes9
.head 3 -  String: sMsgKatRoes10
.head 3 -  String: sMsgKatRoes11
.head 3 -  String: sMsgKatRoes12
.head 3 -  String: sMsgKatRoes13
.head 3 -  String: sMsgKatRoes14
.head 3 -  String: sMsgExistStf
.head 3 -  String: sMsgYpcourse
.head 3 -  String: sMsgInsError
.head 3 -  String: sMsgInsError1
.head 3 -  String: sMsgInsError_init
.head 3 -  String: sMsgInsError2
.head 3 -  String: sMsgInsOblDError
.head 3 -  String: sKatRoes
.head 3 -  String: sRoesFoit
.head 3 -  String: sRohCodeFoit[*]
.head 3 -  String: sRoesStrEgr
.head 3 -  String: sAARoesStr
.head 3 -  String: sOnlyRoesStr
.head 3 -  String: sRohCodeEgr[*]
.head 3 -  String: sRohSymbolEgr[*]
.head 3 -  String: sSplitter
.head 3 -  String: sRohColumn[*]
.head 3 -  String: sRohType[*]
.head 3 -  ! String: sRoesDil
.head 3 -  String: sEjKatEgr
.head 3 -  String: sPerioxi
.head 3 -  String: sOdos
.head 3 -  String: sTT
.head 3 -  String: sTel1
.head 3 -  String: sTel2
.head 3 -  String: sEmail
.head 3 -  String: sAARoh
.head 3 -  String: sAAPar
.head 3 -  Number: nEgrExist
.head 3 -  Number: nAkEgr
.head 3 -  Number: nK_mEgr
.head 3 -  Number: nCountEjEgr
.head 3 -  Number: nCountOblistu
.head 3 -  Number: nBeginEgr
.head 3 -  Number: nFinalEgr
.head 3 -  Number: nCountFoitEgrafi
.head 3 -  Number: nCountFoitOblistud
.head 3 -  Number: nCountFoitOblistu
.head 3 -  Number: nSt_fUpdt
.head 3 -  Number: nRoesFoit
.head 3 -  Number: nRoesEgr
.head 3 -  Number: nErr
.head 3 -  Number: nPos
.head 3 -  !
.head 3 -  String: sEjEgr
.head 3 -  String: sXUEgr
.head 3 -  String: sKatEgr
.head 3 -  String: sK_mEgrMsg
.head 3 -  String: sKatStf
.head 3 -  String: sOmadaEgr
.head 3 -  String: sKmExistObli
.head 3 -  String: sStrKmObli
.head 3 -  String: strNum
.head 3 -  String: strErrmsg
.head 3 -  Date/Time: dDateEgr
.head 3 -  !
.head 3 -  ! ses
.head 3 -  Sql Handle: hSqlError
.head 3 -  Sql Handle: hSel_EgrPros
.head 3 -  Sql Handle: hSel_EgrPrPros
.head 3 -  Sql Handle: hSel_OblDPros
.head 3 -  Sql Handle: hSel_OblDPrPros
.head 3 -  Sql Handle: hSel_OblUPros
.head 3 -  Sql Handle: hSel_OblUPrPros
.head 3 -  Sql Handle: hDel_EgrPros
.head 3 -  Sql Handle: hDel_EgrPrPros
.head 3 -  Sql Handle: hDel_OblDPros
.head 3 -  Sql Handle: hDel_OblDPrPros
.head 3 -  Sql Handle: hDel_OblUPros
.head 3 -  Sql Handle: hDel_OblUPrPros
.head 3 -  Boolean: bReturnMsg
.head 3 -  ! ses
.head 3 -  ! String: sError
.head 3 -  ! Number: nError
.head 3 -  String: sProgrSpoud
.head 3 -  !
.head 3 -  ! ! 6/3/2013
.head 3 -  String: sPassw02
.head 3 -  String: sPassw08
.head 3 -  String: sStored_SqlUser
.head 3 -  String: sStored_SqlPassword
.head 3 -  Sql Handle: hConSysadm
.head 3 -  Sql Handle: hStoredUser
.head 3 -  ! ! 6/3/2013
.head 3 -  !
.head 2 +  Internal Functions
.head 3 +  Function: CreateSession
.head 4 -  Description: Δημιουργία του session των εγγραφών και δηλώσεων μαθημάτων
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bOkSession = SqlCreateSession(hSession, strSession )
.head 5 +  If bOkSession
.head 6 -  ! Call SalMessageBox( 'Create session done', 'Good!', MB_Ok )
.head 6 -  Call SalMessageBox( 'Η σύνδεση με τη βάση δεδομένων πραγματοποιήθηκε με επιτυχία', 'Επιτυχής σύνδεση!', MB_Ok )
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Η σύνδεση απέτυχε', 'Αποτυχία σύνδεσης! Προσπαθήστε ξανά', MB_Ok )
.head 6 -  Return FALSE
.head 3 +  Function: CommitSession
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bOkSession = SqlCommitSession(hSession )
.head 5 +  If bOkSession
.head 6 -  ! Call SalMessageBox( 'Commit session done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Commit session failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: RollbackSession
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bOkSession = SqlRollbackSession(hSession )
.head 5 +  If bOkSession
.head 6 -  Call SalMessageBox( 'Rollback session done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Rollback session failed', 'error!', MB_Ok )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: FreeSession
.head 4 -  Description: Δημιουργία του session των εγγραφών και δηλώσεων μαθημάτων
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bOkSession = SqlFreeSession(hSession )
.head 5 +  If bOkSession
.head 6 -  ! Call SalMessageBox( 'Free session done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Free session failed', 'error!', MB_Ok )
.head 3 +  Function: CreateStatements
.head 4 -  Description: Δημιουργία των Statements για το δοσμένο session
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: n
.head 4 +  Actions
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetSxoli )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrSel )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hSt_fUpdt )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hSt_fProg9 )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrIns )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrUpdt )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrReply )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrChkExist )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  ! Set bOkStatement = SqlCreateStatement(hSession, hKmExistObli )
.head 5 +  ! If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  ! Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hSelYpcourse )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hInsObl )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hInsEpilo )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetEjDilKat )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hInsRohfoit)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hHlek_InsRohFoit)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hChkRoesFoit)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hChkRoesFoit3)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOmadalekt3)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hHlek_GetYpcourse)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hHlek_GetSymbolRoh)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hHlek_UpdtAlterRoh)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountBegEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountFinEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetSxoliCode)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hUpdtKat)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountEjEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountOblistu)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hMaxChoice)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hYpMaxChoice)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetKatStf)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblDPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblUPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblDPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblUPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_EgrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_OblDPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_OblUPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_EgrPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_OblDPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hDel_OblUPrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 5 -  !
.head 3 +  Function: SetInitValues
.head 4 -  Description: Καθορισμός παραμέτρων σύνδεσης
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 4 +  Actions
.head 5 +  ! If NOT SqlImmediate ( ' Lock Database ' )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  ! Set SqlDatabase = sBase
.head 5 -  ! Set SqlUser = sUseronoma
.head 5 -  ! Set SqlPassword = sPassw
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! Sxolio gia nCodeTmima = 2, 6
.head 5 -  ! Set SqlIsolationLevel = 'RL'
.head 5 -  ! Sxolio gia nCodeTmima = 2, 6
.head 5 -  Set sIsolationLevel = SqlIsolationLevel
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! Set SqlDatabase = 'BASE01'
.head 5 -  ! Set SqlUser = 'SYSADM'
.head 5 -  ! Set SqlPassword = 'sysadm'
.head 5 -  ! Set SqlIsolationLevel = 'RL'
.head 5 -  ! Set sIsolationLevel = SqlIsolationLevel
.head 5 -  ! Set sUseronoma = SqlUser
.head 5 -  !
.head 5 -  ! Call SqlImmediate (' SELECT DISTINCT(K_TM) 
		FROM ST_F INTO :nCodeTmima 
		ORDER BY K_TM DESC ' )
.head 5 -  !
.head 5 +  If NOT SqlRetrieve (hGetSxoliCode,  'WEB_GET_SXCODE',  '', sInto_GetSxoliCode )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT SqlExecute(hGetSxoliCode)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hGetSxoliCode, nFetch)
.head 6 -  ! Return FALSE
.head 5 -  Return TRUE
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' Unlock Database ' )
.head 5 -  ! Call SqlClearImmediate()
.head 3 +  Function: RestoreValues
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call SqlClearImmediate()
.head 5 -  Set SqlIsolationLevel = 'RL'
.head 3 +  ! Function: ConnectHandles
.head 4 -  Description: Εκκίνηση των Handles
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 -  !
.head 5 +  If NOT SqlConnect(hEgrSel)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hSt_fUpdt)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hEgrIns)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hEgrUpdt)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hEgrChkExist)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hEgrReply)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hInsObl)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hInsEpilo)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hSelYpcourse)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hChkRoesFoit)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hGetEjDilKat)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 +  If NOT SqlConnect(hEgrPros)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hOblDPros)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hOblUPros)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hEgrPrPros)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hOblDPrPros)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlConnect(hOblUPrPros)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 5 -  !
.head 3 +  Function: Initialize_BINDS
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα BIND Strings
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  !
.head 5 -  ! 2. BIND VARIABLES LISTS
.head 5 -  !
.head 5 -  ! Set sBind_EgrSel 		= ' :sK_F, :nAKEgr, :sXUEgr, :sEJ, :dDateEgr, :sKAT '
.head 5 -  Set sBind_StfUpdt 		= '  :sPerioxi, :sOdos, :sTT, :sTel1, :sEmail, :sK_F '
.head 5 -  Set sBind_StfProg9 	= '  :sProgrSpoud, :sK_F '
.head 5 -  Set sBind_EgrIns 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_EgrUpdt 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_EgrReply	= ' :sK_F, :nAkEgr, :sXUEgr, :sMsg '
.head 5 -  Set sBind_EgrChkExist 	= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  !
.head 5 +  ! If nCodeTmima = 2 OR nCodeTmima = 6
.head 6 -  Set sBind_KmExistObli 	= ' :sK_F, :sEjEgr '
.head 6 -  Set sBind_SelYpcourse 	= ' :nAkEgr, :sEjEgr, :sKatEgr '
.head 5 +  ! Else
.head 6 -  Set sBind_SelYpcourse 	= ' :sK_F, :nAkEgr, :sEjEgr, :sKatEgr '
.head 5 -  !
.head 5 -  Set sBind_SelYpcourse 	= ' :sK_F, :nAkEgr, :sEjEgr, :sKatEgr '
.head 5 -  !
.head 5 -  ! Set sBind_SelYpcourse 	= ' :sK_F, :nAkEgr, :sXUEgr, :nCodeTmima, :sEjEgr, :sKatEgr '
.head 5 -  Set sBind_InsObl		= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  Set sBind_InsEpilo		= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 5 -  Set sBind_InsRohfoit	= ' :sK_F, :sKatEgr, :sRohCodeEgr[nPlithos], :nCodeTmima, :nAkEgr '
.head 5 -  Set sBindHlek_InsRohFoit	= ' :sK_F, :sKatEgr, :sAARoh, :sY, :sL, :sH, :sD, :sT, :sS, :sZ, :sE, :sO, :sI, :sM, :sF '
.head 5 +  If nCodeTmima != 9
.head 6 -  Set sBind_GetEjDilKat	= ' :nCodeTmima, :nAkEgr '
.head 5 +  Else
.head 6 -  Set sBind_GetEjDilKat	= ' :nCodeTmima, :nAkEgr, :sKatEgr '
.head 5 -  Set sBind_ChkRoesFoit	= ' :nCodeTmima, :sK_F '
.head 5 -  !
.head 5 -  Set sBind_ChkRoesFoit3	= ' :sK_F '
.head 5 -  Set sBind_Omadalekt3	= ' :nCodeTmima, :nAkEgr '
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sBind_UpdtKat		= ' :sKatEgr, :sK_F '
.head 5 -  Set sBind_CountEjEgr	= ' :nAkEgr, :sEjEgr, :sK_F '
.head 5 -  Set sBind_CountOblistu	= ' :sEjEgr, :sK_F '
.head 5 -  Set sBind_MaxChoice	= ' :sEjEgr, :nCodeTmima, :sKatEgr, :nAkEgr '
.head 5 -  Set sBind_YpMaxChoice	= ' :sEjEgr, :nCodeTmima, :sKatEgr, :nAkEgr '
.head 5 -  Set sBind_GetKatStf	= ' :sK_F'
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set sBind_EgrPros 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_OblDPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  Set sBind_OblUPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 5 -  Set sBind_EgrPrPros 	= ' :sK_F, :nAkEgr, :sXUEgr  '
.head 5 -  Set sBind_OblDPrPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  Set sBind_OblUPrPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 3 +  Function: Initialize_INTO
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα INTO Strings
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! 1. INTO VARIABLES LISTS
.head 5 -  !
.head 5 -  ! ST_F
.head 5 -  Set sInto_EgrSel 		= ' :sK_F, :nAkEgr, :sXUEgr, :sEjEgr, :sKatEgr , :sRoesStrEgr, :nSt_fUpdt, :sPerioxi, :sOdos, :sTT, :sTel1, :sTel2, :sProgrSpoud, :sEmail '
.head 5 -  ! Set sInto_EgrSel 		= ' :sK_F, :nAkEgr, :sXUEgr, :sEjEgr, :sKatEgr '
.head 5 -  ! ST_F
.head 5 -  Set sInto_EgrChkExist	= ' :nEgrExist '
.head 5 -  !
.head 5 -  ! Set sInto_KmExistObli	= ' :sKmExistObli '
.head 5 -  !
.head 5 -  Set sInto_SelYpcourse	= ' :nK_mEgr, :sOmadaEgr '
.head 5 -  Set sInto_GetEjDilKat	= ' :sEjKatEgr '
.head 5 -  Set sInto_ChkRoesFoit	= ' :sKatRoes, :sRoesFoit '
.head 5 -  !
.head 5 -  Set sInto_ChkRoesFoit3	= ' :sKatRoes, :sY, :sL, :sH, :sD, :sT, :sS, :sZ, :sE, :sO, :sI, :sF, :sM '
.head 5 -  ! Set sInto_ChkRoesFoit3	= ' :sKatRoes, :sY, :sL, :sH, :sD, :sT, :sS, :sZ, :sE, :sO, :sI, :sM,  :sF '
.head 5 -  Set sInto_Omadalekt3	= ' :sRohOmadalekt '
.head 5 -  ! Set sInto_InsObl		= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  ! Set sInto_InsEpilo		= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sInto_CountBegEgr	= ' :nBeginEgr '
.head 5 -  Set sInto_CountFinEgr	= ' :nFinalEgr '
.head 5 -  Set sInto_GetSxoliCode	= ' :nCodeTmima '
.head 5 -  Set sInto_CountEjEgr	= ' :nCountEjEgr '
.head 5 -  Set sInto_CountOblistu	= ' :nCountOblistu '
.head 5 -  Set sInto_MaxChoice	= ' :nOmMaxChoice '
.head 5 -  Set sInto_YpMaxChoice	= ' :nYpMaxChoice '
.head 5 -  Set sInto_GetKatStf		= ' :sKatStf, :sTroposEis '
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 3 +  Function: Initialize_COMMANDS
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα SqlCommands Strings.
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! 3. SQL COMMANDS STRINGS
.head 5 -  !
.head 5 -  !
.head 5 -  ! ! 	!EGRAFI
.head 5 -  ! ST_F
.head 5 -  Set sSqlCom_EgrSel 	      =  	' SELECT K_F, AK, XU ,EJ, KAT, ROH, ST_F_CHANGE, PERIOXI, ODOS, TT, TEL1, TEL2, K_PROG, EMAIL
				FROM  WEBAIT_EGR
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  ! Set sSqlCom_EgrSel 	      =  	' SELECT K_F, AK, XU ,EJ, KAT
				FROM  WEBAIT_EGR
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  ! 1/3/2013
.head 5 -  ! Δεν γίνεται update πλέον το πεδίο tel2 γιατί δεν ενημερώνεται από το ΚΥ 
.head 5 -  ! Set sSqlCom_St_fUpdt 	      =  	' UPDATE ST_F
				SET PERIOXI = :1, ODOS = :2, TT = :3, TEL1 = :4, TEL2 = :5, EMAIL = :6
				WHERE K_F = :7 '
.head 5 -  Set sSqlCom_St_fUpdt 	      =  	' UPDATE ST_F
				SET PERIOXI = :1, ODOS = :2, TT = :3, TEL1 = :4, EMAIL = :5
				WHERE K_F = :6 '
.head 5 -  ! 1/3/2013
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_St_fProg9 	      =  	' UPDATE ST_F
				SET K_PROG = :1
				WHERE K_F = :2 '
.head 5 -  !
.head 5 -  ! ST_F
.head 5 -  !
.head 5 -  Set sSqlCom_EgrChkExist 	      =  	' SELECT COUNT(*)			
				FROM  EGRAFI
				WHERE K_F = :1 AND AK = :2 AND XU = :3  '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrReply	      =  	' UPDATE  WEBAIT_EGR
				SET EGRREPLY = :4
				WHERE K_F = :1 AND AK = :2 AND XU = :3 '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrIns 	      =  	' INSERT INTO EGRAFI 
				(K_F, AK, XU ,EJ, EGRDATE, KAT)
				SELECT K_F, AK, XU ,EJ, EGRDATE, KAT
				FROM  WEBAIT_EGR
				WHERE K_F = :1 AND AK = :2 AND XU = :3 ' 
.head 5 -  !
.head 5 -  Set sSqlCom_EgrUpdt	      =  	' UPDATE  WEBAIT_EGR
				SET EGRSTATUS = 1
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) 
				AND K_F = :1 AND AK = :2 AND XU = :3 '
.head 5 -  !
.head 5 -  ! 8/3/2013
.head 5 +  ! If nCodeTmima = 2 OR nCodeTmima = 6
.head 6 -  Set sSqlCom_KmExistObli	      =  	" SELECT  OBLISTUD.K_M
		      		FROM OBLISTUD
                                   		WHERE K_F = :1 AND EJ = :2 "
.head 6 -  !
.head 6 -  Set sSqlCom_SelYpcourse	      =  	" SELECT  YPCOURSE.K_M,  OMADA
		      		from YPCOURSE
                                   		where  ypcourse.ak = :1
                                          		and ypcourse.ej = :2  AND YPCOURSE.KAT = :3 "
.head 5 +  ! Else
.head 6 -  Set sSqlCom_SelYpcourse	      =  	' SELECT  YPCOURSE.K_M,  OMADA
		      		from YPCOURSE
                                   		where  ypcourse.ak = :2
                                          		and ypcourse.ej = :3  AND YPCOURSE.KAT = :4
		          		and ypcourse.k_m not in (select  k_m from oblistud where k_f = :1 ) '
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_SelYpcourse	      =  	' SELECT  YPCOURSE.K_M,  OMADA			
		      		from YPCOURSE
                                   		where  ypcourse.ak = :2 		          		
                                          		and ypcourse.ej = :3  AND YPCOURSE.KAT = :4
		          		and ypcourse.k_m not in (select  k_m from oblistud where k_f = :1 ) '
.head 5 -  ! 8/3/2013
.head 5 -  ! Set sSqlCom_SelYpcourse	      =  	' SELECT  YPCOURSE.K_M,  OMADA
			
		      		from YPCOURSE, ST_M
                                   		where  ypcourse.ak = :2  and st_m.ak = ypcourse.ak and st_m.xu = :3
		          		and st_m.k_tm = ypcourse.k_tm and st_m.k_m = ypcourse.k_m
                                          		and ypcourse.ej = :5 and st_m.k_tm = :4 AND YPCOURSE.KAT = :6
		          		and st_m.k_m not in (select  k_m from oblistud where k_f = :1 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_InsObl	      =  	' INSERT INTO OBLISTUD
		  		( K_F, K_TM, EJ, K_M, AK, OMADA)
                                   		VALUES ( :1, :2, :3, :4, :5 , :6 ) '
.head 5 -  !
.head 5 -  ! Set sSqlCom_SelEpilo	      =  	' SELECT COUNT(*) 
				FROM OBLISTU
		   		WHERE  where  ej = :3 and k_f = :1  '
.head 5 -  !
.head 5 -  Set sSqlCom_InsEpilo	      =  	' INSERT INTO OBLISTU
		   		(K_F, K_TM, EJ, TOTEPIL)
                                   		VALUES ( :1, :2, :3, :4 ) '
.head 5 -  !
.head 5 +  If nCodeTmima != 3
.head 6 -  Set sSqlCom_InsRohfoit	      =  	' INSERT INTO ROHFOIT
				( K_F, KAT, ROHCODE, K_TM, AK )
                                  		VALUES ( :1, :2, :3, :4, :5 ) '                               		
                                  		
.head 6 -  !
.head 6 -  Set sSqlCom_ChkRoesFoit	      =  	' SELECT KAT, ROHCODE
                                  		FROM ROHFOIT                                  		
                                  		WHERE K_TM = :1 AND K_F = :2 ORDER BY ROHCODE '
.head 5 +  Else
.head 6 -  !
.head 6 -  ! Εισάγει τον συνδυασμό των ροών στον ROHFOIT
.head 6 -  Set sSqlComHlek_InsRohFoit	      =  	' INSERT INTO ROHFOIT
				( K_F, KAT, AA, Y, L, H, D, T, S, Z, E, O, I, M, F )
                                  		VALUES ( :1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15 ) '                               		
                                  		
.head 6 -  !
.head 6 -  ! Οι δηλωμένες ροές του φοιτητή
.head 6 -  ! Set sSqlCom_ChkRoesFoit3	      =  	' SELECT KAT, Y, L, H, D, T, S, Z, E, O, I, M, F
                                  		FROM ROHFOIT                                  		
                                  		WHERE K_F = :1 '
.head 6 -  Set sSqlCom_ChkRoesFoit3	      =  	' SELECT KAT, Y, L, H, D, T, S, Z, E, O, I, F, M
                                  		FROM ROHFOIT                                  		
                                  		WHERE K_F = :1 '
.head 6 -  !
.head 6 -  ! Βρίσκει τους κωδικούς των ομάδων από τον Omadalekt
.head 6 -  Set sSqlCom_Omadalekt3	      =  	' SELECT OMADA
				FROM OMADALEKT 
				WHERE K_TM = :1 AND AK = :2 AND OMADA between 8000 and 8999 '
.head 6 -  !
.head 6 -  !
.head 6 -  ! Ελέγχει αν έχει χρεωθεί υποχρεώσεις
.head 6 -  ! Set sSqlCom_ChkExistObli3	      =  	' SELECT k_m
                                          		INTO :nK_mCour
                                          		FROM OBLISTUD
                                          		WHERE k_f = :1  AND ej = :3 AND k_tm = :2 '
                                                         		
.head 6 -  !
.head 6 -  !
.head 5 -  ! IN USE !!!!!!!
.head 5 +  If nCodeTmima != 9
.head 6 -  Set sSqlCom_GetEjDilKat	      =  	' SELECT EJKAT
                                  		FROM PROYPROG                                  		
                                  		WHERE K_TM = :1 AND AK = :2 '
.head 5 +  Else
.head 6 -  Set sSqlCom_GetEjDilKat	      =  	' SELECT EJKAT
                                  		FROM PROYPROG                                  		
                                  		WHERE K_TM = :1 AND AK = :2 AND KAT = :3 '
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set sSqlCom_EgrPros 	      =  	' INSERT INTO WEB_EGR_PROS 
				(K_F, AK, XU ,EJ, EGRDATE, KAT, ROH, ST_F_CHANGE, PERIOXI ,ODOS, TT, TEL1, TEL2, EMAIL, K_PROG, EGRREPLY )
				SELECT K_F, AK, XU ,EJ, EGRDATE, KAT, ROH, ST_F_CHANGE, PERIOXI ,ODOS, TT, TEL1, TEL2, EMAIL, K_PROG, EGRREPLY
				FROM  WEBAIT_EGR
				WHERE K_F = :1 AND AK = :2 AND XU = :3 ' 
.head 5 -  !
.head 5 -  Set sSqlCom_OblDPros	      =  	' INSERT INTO WEB_OBLD_PROS
		  		( K_F, K_TM, EJ, K_M, AK, OMADA)
                                   		VALUES ( :1, :2, :3, :4, :5 , :6 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_OblUPros	      =  	' INSERT INTO WEB_OBLU_PROS
		   		(K_F, K_TM, EJ, TOTEPIL)
                                   		VALUES ( :1, :2, :3, :4 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrPrPros 	      =  	' INSERT INTO WEB_EGRPR_PROS 
				(K_F, AK, XU ,EJ, EGRDATE, KAT, ROH, ST_F_CHANGE, PERIOXI ,ODOS, TT, TEL1, TEL2, K_PROG, EMAIL, EGRREPLY )
				SELECT K_F, AK, XU ,EJ, EGRDATE, KAT, ROH, ST_F_CHANGE, PERIOXI ,ODOS, TT, TEL1, TEL2 , K_PROG, EMAIL, EGRREPLY
				FROM  WEBAIT_EGR
				WHERE K_F = :1 AND AK = :2 AND XU = :3 ' 
.head 5 -  !
.head 5 -  Set sSqlCom_OblDPrPros	      =  	' INSERT INTO WEB_OBLDPR_PROS
		  		( K_F, K_TM, EJ, K_M, AK, OMADA)
                                   		VALUES ( :1, :2, :3, :4, :5 , :6 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_OblUPrPros	      =  	' INSERT INTO WEB_OBLUPR_PROS
		   		(K_F, K_TM, EJ, TOTEPIL)
                                   		VALUES ( :1, :2, :3, :4 ) '
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sSqlCom_CountBegEgr	      =  	'SELECT COUNT(*) 
				FROM WEBAIT_EGR 				
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  !
.head 5 -  Set sSqlCom_CountFinEgr	      =  	'SELECT COUNT(*) 
				FROM WEBAIT_EGR 				
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  !
.head 5 -  Set sSqlCom_GetSxoliCode	      =  	' SELECT DISTINCT(K_TM) 
				FROM ST_F 
				ORDER BY K_TM DESC '
.head 5 -  !
.head 5 -  Set sSqlCom_UpdtKat	      =  	' UPDATE ST_F 
				SET KAT = :1 
				WHERE K_F = :2 ' 
.head 5 -  !
.head 5 -  ! Call SqlImmediate (' UPDATE ST_F SET KAT = :sKatEgr WHERE K_F = :sK_F ' )
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_CountEjEgr	      =  	 ' Select count(k_f) 				
				FROM EGRAFI
				where ak < :1 and ej = :2 and k_f = :3   '
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' Select count(k_f) INTO :nCountEgr
		FROM EGRAFI
		where ak < :nAkEgr and ej = :sEjEgr and k_f = :sK_F
   ' )
.head 5 -  !
.head 5 -  Set sSqlCom_CountOblistu	      =  	 ' Select count(*) 				
				FROM OBLISTU
				where ej = :1 and k_f = :2 '
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' Select count(*) INTO :nCountOblistu
		FROM OBLISTU
		where ej = :sEjEgr and k_f = :sK_F
   ' )
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_MaxChoice	      =  	 " SELECT SUM( omadepim.maxchoice )                                          		
                                         		 FROM omadepim
                                          		WHERE  omadepim.ej = :1 AND
                                                         		 omadepim.k_tm = :2  AND
                                                         		 omadepim.kat = :3  AND
                                                        		  ak = :4 "
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( " SELECT SUM( omadepim.maxchoice )
                                          INTO :nOmMaxChoice
                                          FROM omadepim
                                          WHERE  omadepim.ej = :sEjEgr AND
                                                          omadepim.k_tm = :nCodeTmima  AND
                                                          omadepim.kat = :sKatEgr  AND
                                                          ak = :nAkEgr " )
.head 5 -  !
.head 5 -  Set sSqlCom_YpMaxChoice	      =  	 " SELECT SUM( ypmadepm.maxchoice )                                         		
                                         		FROM YPMADEPM
                                        		 WHERE  ypmadepm.ej = :1  AND
                                                        		ypmadepm.k_tm = :2  AND
                                                       		 ypmadepm.kat = :3  AND
                                                        		ak = :4 "
.head 5 -  !
.head 5 -  ! Call SqlImmediate (" SELECT SUM( ypmadepm.maxchoice )
                                         INTO  :nYpMaxChoice
                                         FROM YPMADEPM
                                         WHERE  ypmadepm.ej = :sEjEgr  AND
                                                        ypmadepm.k_tm = :nCodeTmima  AND
                                                        ypmadepm.kat = :sKatEgr  AND
                                                        ak = :nAkEgr " )
.head 5 -  !
.head 5 -  ! 08 Oct 2009
.head 5 -  Set sSqlCom_GetKatStf	      =  	' SELECT KAT , TROPOS
				FROM ST_F 				
				WHERE K_F = :1 '
.head 5 -  ! Set sSqlCom_GetKatStf	      =  	' SELECT KAT 
				FROM ST_F 				
				WHERE K_F = :1 '
.head 5 -  ! 08 Oct 2009
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_DelEgrPros	      =  	' DELETE FROM WEB_EGR_PROS '
.head 5 -  Set sSqlCom_DelOblDPros	      =  	' DELETE FROM WEB_OBLD_PROS '
.head 5 -  Set sSqlCom_DelOblUPros	      =  	' DELETE FROM WEB_OBLU_PROS '
.head 5 -  !
.head 5 -  Set sSqlCom_DelEgrPrPros	      =  	' DELETE FROM WEB_EGRPR_PROS '
.head 5 -  Set sSqlCom_DelOblDPrPros	      =  	' DELETE FROM WEB_OBLDPR_PROS '
.head 5 -  Set sSqlCom_DelOblUPrPros	      =  	' DELETE FROM WEB_OBLUPR_PROS '
.head 5 -  !
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' SELECT KAT FROM ST_F INTO :sKatStf WHERE K_F = :sK_F ' )
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 3 +  Function: StoreCommand
.head 4 -  Description: Αποθηκεύει κάθε SqlCommand στη βάση
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! Sql Handle: hSqlStatement
.head 5 -  ! String: sStatementName
.head 5 -  ! String: strSqlCommand
.head 5 -  ! String: sBindVariables
.head 5 -  ! String: sIntoList
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! When SqlError
.head 6 -  Set nRcd = SqlError(hSqlStatement)
.head 6 +  If nRcd = 207
.head 7 -  !
.head 6 -  !
.head 5 +  If NOT SqlStore(hEgrSel, 'WEB_WEBAIT_EGR_SEL', sSqlCom_EgrSel ) 
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrSel)
.head 5 +  If NOT SqlStore(hSt_fUpdt, 'WEB_ST_F_UPDT', sSqlCom_St_fUpdt ) 
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hSt_fUpdt)
.head 5 +  If NOT SqlStore(hSt_fProg9, 'WEB_ST_F_PROG9', sSqlCom_St_fProg9 ) 
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hSt_fProg9)
.head 5 +  If NOT SqlStore(hEgrIns, 'WEB_EGRAFI_INS', sSqlCom_EgrIns )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrIns)
.head 5 +  If NOT SqlStore(hEgrUpdt, 'WEB_WEBAIT_EGR_UPD', sSqlCom_EgrUpdt )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrUpdt)
.head 5 +  If NOT SqlStore(hEgrReply, 'WEB_WEBAIT_EGR_RPL', sSqlCom_EgrReply )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrReply)
.head 5 +  If NOT SqlStore(hEgrChkExist, 'WEB_EGRAFI_EXIST', sSqlCom_EgrChkExist )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrChkExist)
.head 5 -  !
.head 5 -  !
.head 5 +  ! If nCodeTmima = 2 OR nCodeTmima = 6
.head 6 +  If NOT SqlStore(hKmExistObli, 'WEB_KMEXISTOBLI', sSqlCom_KmExistObli )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hKmExistObli)
.head 5 +  ! Else
.head 6 +  If NOT SqlStore(hSelYpcourse, 'WEB_YPCOURSE_SEL', sSqlCom_SelYpcourse )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hSelYpcourse)
.head 5 -  !
.head 5 +  If NOT SqlStore(hSelYpcourse, 'WEB_YPCOURSE_SEL', sSqlCom_SelYpcourse )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hSelYpcourse)
.head 5 -  !
.head 5 +  If NOT SqlStore(hInsObl, 'WEB_OBLISTUD_INS', sSqlCom_InsObl )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hInsObl)
.head 5 +  If NOT SqlStore(hInsEpilo, 'WEB_OBLISTU_INS', sSqlCom_InsEpilo )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hInsEpilo)
.head 5 +  If NOT SqlStore(hGetEjDilKat, 'WEB_GETEJ_DILKAT', sSqlCom_GetEjDilKat )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hGetEjDilKat)
.head 5 -  ! If nCodeTmima = 3 OR nCodeTmima = 6 OR nCodeTmima = 9
.head 5 -  !
.head 5 -  ! ΣΧΟΛΕΣ ΡΟΩΝ
.head 5 +  If nCodeTmima = 6 or nCodeTmima = 9
.head 6 +  If NOT SqlStore(hInsRohfoit, 'WEB_INSROHFOIT', sSqlCom_InsRohfoit )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hInsRohfoit)
.head 6 -  !
.head 6 +  If NOT SqlStore(hChkRoesFoit, 'WEB_CHKROES_FOIT', sSqlCom_ChkRoesFoit )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hChkRoesFoit)
.head 5 -  !
.head 5 +  Else If nCodeTmima = 3
.head 6 +  If NOT SqlStore(hHlek_InsRohFoit, 'WEBHlek_InsRohFoit', sSqlComHlek_InsRohFoit )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hHlek_InsRohFoit)
.head 6 -  !
.head 6 +  If NOT SqlStore(hChkRoesFoit3, 'WEB_CHKROES_FOIT3', sSqlCom_ChkRoesFoit3 )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hChkRoesFoit3)
.head 6 -  !
.head 6 +  If NOT SqlStore(hOmadalekt3, 'WEB_OMADALEKT3', sSqlCom_Omadalekt3 )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommit(hOmadalekt3)
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 +  If NOT SqlStore(hCountBegEgr, 'WEB_COUNT_BEGEGR', sSqlCom_CountBegEgr )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hCountBegEgr)
.head 5 +  If NOT SqlStore(hCountFinEgr, 'WEB_COUNT_FINEGR', sSqlCom_CountFinEgr )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hCountFinEgr)
.head 5 +  If NOT SqlStore(hGetSxoliCode, 'WEB_GET_SXCODE', sSqlCom_GetSxoliCode )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hGetSxoliCode)
.head 5 +  If NOT SqlStore(hUpdtKat, 'WEB_UPDTKAT', sSqlCom_UpdtKat )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hUpdtKat)
.head 5 +  If NOT SqlStore(hCountEjEgr, 'WEB_COUNT_EJEGR', sSqlCom_CountEjEgr)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hCountEjEgr)
.head 5 +  If NOT SqlStore(hCountOblistu, 'WEB_COUNT_OBLISTU', sSqlCom_CountOblistu)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hCountOblistu)
.head 5 +  If NOT SqlStore(hMaxChoice, 'WEB_OM_MAXCHOICE', sSqlCom_MaxChoice)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hMaxChoice)
.head 5 +  If NOT SqlStore(hYpMaxChoice, 'WEB_YP_MAXCHOICE', sSqlCom_YpMaxChoice)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hYpMaxChoice)
.head 5 +  If NOT SqlStore(hGetKatStf, 'WEB_GET_KATST_F', sSqlCom_GetKatStf)
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hGetKatStf)
.head 5 -  !
.head 5 -  !
.head 5 +  ! If SqlGetCommandText (hGetKatStf, sStatementText)
.head 6 -  Set sStatementText = sStatementText
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 +  If NOT SqlStore(hEgrPros, 'WEB_EGR_PROS', sSqlCom_EgrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrPros)
.head 5 +  If NOT SqlStore(hOblDPros, 'WEB_OBLD_PROS', sSqlCom_OblDPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblDPros)
.head 5 +  If NOT SqlStore(hOblUPros, 'WEB_OBLU_PROS', sSqlCom_OblUPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblUPros)
.head 5 +  If NOT SqlStore(hEgrPrPros, 'WEB_EGRPR_PROS', sSqlCom_EgrPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrPrPros)
.head 5 +  If NOT SqlStore(hOblDPrPros, 'WEB_OBLDPR_PROS', sSqlCom_OblDPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblDPrPros)
.head 5 +  If NOT SqlStore(hOblUPrPros, 'WEB_OBLUPR_PROS', sSqlCom_OblUPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblUPrPros)
.head 5 -  !
.head 5 -  !
.head 5 +  If NOT SqlStore(hEgrPros, 'WEB_DEGR_PROS', sSqlCom_DelEgrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrPros)
.head 5 +  If NOT SqlStore(hOblDPros, 'WEB_DOBLD_PROS', sSqlCom_DelOblDPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblDPros)
.head 5 +  If NOT SqlStore(hOblUPros, 'WEB_DOBLU_PROS', sSqlCom_DelOblUPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblUPros)
.head 5 +  If NOT SqlStore(hEgrPrPros, 'WEB_DEGRPR_PROS', sSqlCom_DelEgrPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hEgrPrPros)
.head 5 +  If NOT SqlStore(hOblDPrPros, 'WEB_DOBLDPR_PROS', sSqlCom_DelOblDPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblDPrPros)
.head 5 +  If NOT SqlStore(hOblUPrPros, 'WEB_DOBLUPR_PROS', sSqlCom_DelOblUPrPros )
.head 6 -  Return FALSE
.head 5 -  Call SqlCommit(hOblUPrPros)
.head 5 -  !
.head 5 -  !
.head 5 -  Return TRUE
.head 3 -  ! ses
.head 3 +  ! Function: Del_Tbls_Pros
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_EgrPros, 'DELETE FROM WEB_EGR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblDPros, 'DELETE FROM WEB_OBLD_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblUPros, 'DELETE FROM WEB_OBLU_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_EgrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblDPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblUPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_EgrPrPros, 'DELETE FROM WEB_EGRPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblDPrPros, 'DELETE FROM WEB_OBLDPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblUPrPros, 'DELETE FROM WEB_OBLUPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_EgrPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblDPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblUPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If bReturnMsg
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Return TRUE
.head 3 +  Function: Del_Tbls_Pros
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_EgrPros, 'DELETE FROM WEB_EGR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_OblDPros, 'DELETE FROM WEB_OBLD_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_OblUPros, 'DELETE FROM WEB_OBLU_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_EgrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_OblDPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_OblUPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_EgrPrPros, 'DELETE FROM WEB_EGRPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_OblDPrPros, 'DELETE FROM WEB_OBLDPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlPrepareAndExecute ( hDel_OblUPrPros, 'DELETE FROM WEB_OBLUPR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_EgrPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_OblDPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  ! If NOT SqlCommit(hDel_OblUPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 -  !
.head 5 +  If NOT SqlRetrieve (hDel_EgrPros,  'WEB_DEGR_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_EgrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlRetrieve (hDel_OblDPros,  'WEB_DOBLD_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_OblDPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlRetrieve (hDel_OblUPros,  'WEB_DOBLU_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_OblUPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 -  !
.head 5 +  If NOT SqlRetrieve (hDel_EgrPrPros,  'WEB_DEGRPR_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_EgrPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlRetrieve (hDel_OblDPrPros,  'WEB_DOBLDPR_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_OblDPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlRetrieve (hDel_OblUPrPros,  'WEB_DOBLUPR_PROS',  '', '' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlExecute(hDel_OblUPrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 -  !
.head 5 +  If bReturnMsg
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: DisconnectH
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlDisconnect( hSel_EgrPros )
.head 5 -  Call SqlDisconnect( hSel_OblDPros )
.head 5 -  Call SqlDisconnect( hSel_OblUPros )
.head 5 -  Call SqlDisconnect( hDel_EgrPros )
.head 5 -  Call SqlDisconnect( hDel_OblDPros )
.head 5 -  Call SqlDisconnect( hDel_OblUPros )
.head 5 -  Call SqlDisconnect( hSel_EgrPrPros )
.head 5 -  Call SqlDisconnect( hSel_OblDPrPros )
.head 5 -  Call SqlDisconnect( hSel_OblUPrPros )
.head 5 -  Call SqlDisconnect( hDel_EgrPrPros )
.head 5 -  Call SqlDisconnect( hDel_OblDPrPros )
.head 5 -  Call SqlDisconnect( hDel_OblUPrPros )
.head 3 +  Function: ConnectH
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlConnect( hSel_EgrPros )
.head 5 -  Call SqlConnect( hSel_OblDPros )
.head 5 -  Call SqlConnect( hSel_OblUPros )
.head 5 -  Call SqlConnect( hDel_EgrPros )
.head 5 -  Call SqlConnect( hDel_OblDPros )
.head 5 -  Call SqlConnect( hDel_OblUPros )
.head 5 -  Call SqlConnect( hSel_EgrPrPros )
.head 5 -  Call SqlConnect( hSel_OblDPrPros )
.head 5 -  Call SqlConnect( hSel_OblUPrPros )
.head 5 -  Call SqlConnect( hDel_EgrPrPros )
.head 5 -  Call SqlConnect( hDel_OblDPrPros )
.head 5 -  Call SqlConnect( hDel_OblUPrPros )
.head 3 -  ! ses
.head 3 +  Function: ConnectToDB
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If frmLogin.dfBaseName = ''
.head 6 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 6 -  Call SalSetFocus(frmLogin.dfBaseName)
.head 6 -  Return FALSE
.head 5 +  If frmLogin.dfUsername = ''
.head 6 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 6 -  Call SalSetFocus(frmLogin.dfUsername)
.head 6 -  Return FALSE
.head 5 +  If frmLogin.dfPassword = ''
.head 6 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 6 -  Call SalSetFocus(frmLogin.dfPassword)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set SqlDatabase = sBaseName
.head 5 -  Set SqlUser = sUsername
.head 5 -  Set SqlPassword = sPassword
.head 5 -  Set SqlIsolationLevel = 'RL'
.head 5 -  !
.head 5 -  ! !
.head 5 -  ! ! Εάν είναι χρήστης με περιορισμένα δικαιώματα κάνε τον sysadm
.head 5 +  If SqlDatabase = 'BASE02' or SqlDatabase = 'BASE08'
.head 6 +  If SqlUser != 'SYSADM'
.head 7 +  If NOT Fn_Change_Internally_To_SYSADM()
.head 8 -  Return FALSE
.head 5 -  !
.head 5 -  ! Set SqlIsolationLevel = 'RL'
.head 5 -  Set sIsolationLevel = SqlIsolationLevel
.head 5 -  !
.head 5 -  ! Ανοίγει το session των εγγραφών σε εξάμηνο
.head 5 +  If NOT CreateSession()
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! Σύνδεση των Handles του session των εγγραφών σε εξάμηνο
.head 5 +  ! If NOT ConnectHandles()
.head 6 -  Call RollbackSession()
.head 5 -  !
.head 5 -  ! Δημιουργεί τα statements των εγγραφών σε εξάμηνο
.head 5 +  If NOT CreateStatements()
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! ! ! Βρίσκει τον κωδικό της σχολής
.head 5 +  If NOT GetSxoli()
.head 6 -  Return FALSE
.head 5 -  ! !
.head 5 -  ! Αρχικοποίηση μεταβλητών
.head 5 -  Call Initialize_INTO()
.head 5 -  Call Initialize_BINDS()
.head 5 -  Call Initialize_COMMANDS()
.head 5 -  !
.head 5 -  ! Αποθηκέυει τις απαιτούμενες εντολές στη βάση αν δεν έχει γίνει ήδη.
.head 5 +  If NOT StoreCommand ()
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT SetInitValues()
.head 6 -  ! Call RollbackSession()
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If bOkSession
.head 6 -  Call SalDisableWindow(frmLogin.pbConnect)
.head 6 -  Call SalEnableWindow(frmLogin.pbContinue)
.head 6 -  Call SalEnableWindow(frmLogin.pbPreview)
.head 6 -  Call SalEnableWindow(frmLogin.pbPreviewProblem)
.head 6 -  Call SalSetFocus(frmLogin.pbContinue)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 5 -  !
.head 3 -  ! !
.head 3 +  Function: GetSxoli
.head 4 -  Description: Κωδικός Σχολής
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! Call SqlConnect(hGetSxoli)
.head 5 -  !
.head 5 -  ! ! 	!INTO
.head 5 -  Set sInto_GetSxoli 		= 	' :nCodeTmima '
.head 5 -  !
.head 5 -  ! ! 	!COMMAND
.head 5 -  Set sSqlCom_GetSxoli	= 	' SELECT DISTINCT K_TM
				FROM  ST_F WHERE K_TM IS NOT NULL '
.head 5 -  !
.head 5 -  ! !	!STORE
.head 5 -  Call SqlStore(hGetSxoli, 'WEB_GETSXOLH', sSqlCom_GetSxoli )
.head 5 -  !
.head 5 -  ! !	!RETRIEVE
.head 5 -  Call SqlRetrieve (hGetSxoli, 'WEB_GETSXOLH',  '', sInto_GetSxoli )
.head 5 -  !
.head 5 -  ! !	! EXECUTE
.head 5 -  Call SqlExecute(hGetSxoli)
.head 5 -  !
.head 5 -  ! !	! FETCH
.head 5 +  If SqlFetchNext (hGetSxoli, nFetch)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 -  ! !
.head 3 -  ! ! 6/3/2013
.head 3 +  Function: Fn_Change_Internally_To_SYSADM
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  Set SqlUser = 'SYSADM'
.head 5 +  If SqlDatabase = 'BASE02'
.head 6 -  Set SqlPassword = sPassw02
.head 5 +  Else If SqlDatabase = 'BASE08'
.head 6 -  Set SqlPassword = sPassw08
.head 5 +  Else
.head 6 -  Set SqlPassword = 'sysadm'
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: Fn_Disconnect_SYSADM
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 +  If NOT SqlDisconnect(hConSysadm)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 5 -  !
.head 3 +  Function: Fn_Return_To_Stored_User
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set SqlUser = sStored_SqlUser
.head 5 -  Set SqlPassword = sStored_SqlPassword
.head 5 +  If NOT SqlConnect(hStoredUser)
.head 6 -  Return FALSE
.head 5 -  Return TRUE
.head 3 -  ! ! 6/3/2013
.head 2 -  Named Menus
.head 2 -  Class Definitions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 +  Application Actions
.head 3 +  On SAM_AppStartup
.head 4 -  ! Καθορισμός παραμέτρων σύνδεσης
.head 4 -  Set bOkSession = FALSE
.head 4 -  Call SalCreateWindow( frmLogin,  hWndForm )
.head 4 -  ! Call SetInitValues()
.head 4 -  !
.head 4 -  ! 6/3/2013
.head 4 -  ! password user sysadm for internal use
.head 4 -  Set sPassw02 = 'm16e@gle'
.head 4 -  Set sPassw08 = 'm16e@gle'
.head 4 -  ! 6/3/2013
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! Set SqlDatabase = 'BASE01'
.head 4 -  ! Set SqlUser = 'SYSADM'
.head 4 -  ! Set SqlPassword = 'sysadm'
.head 4 -  ! Set SqlIsolationLevel = 'RL'
.head 4 -  ! Set sIsolationLevel = SqlIsolationLevel
.head 4 -  ! Set sUseronoma = SqlUser
.head 4 -  !
.head 4 -  ! Set nCodeTmima = 1
.head 1 +  Form Window: frmWebOmadEgrYX
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File: C:\NTUARIS\IMAGES\ICO\ACADEMY.ico
.data RESOURCE 2 0 1 2143424337
0000: FE020000F2010000 0000000000000000 0200A20001000120 3010000000E80200
0020: 0000160000002800 0000002000000040 0008000001040000 00A380020000FFFF
0040: 8FC000000300C0C0 00C000680000C0C0 C00D00C000808080 80000000FF000003
0060: 00FFFF00FF006800 00FFFFFF4D00FF00 11D011111000007F 1940B9B9B1000000
0080: 876870FF00000120 119B9B10008777C0 0FF7700000000519 10087777FF800FF7
00A0: 80F00000000B0177 7FFFFF5007787000 00780078781917FF FFF7771080878000
00C0: 00077780F7FF1B91 7780003E000FFFD2 FF8000003F07FF80 FF80009000000007
00E0: 0399330077F28000 000739BB110000FE 00073B31000000FF 4739100000FF4733
0100: 100000FF773900FF 773900FF7739001F 7770007500390007 0778000770620003
0120: 3910003B07000780 00000091000000D3 800000B087000091 00F0080000000587
0140: 3900000008FB0087 33000000FFC10993 000000FFB0993000 0808BD00096B0080
0160: 001FF93000FC0000 F680006F8000ED80 00DB0800FFED0800 DB0800F68000F708
0180: FD008F0808003E00 C07F00C0FFC03F00 3FE00800001FFC00 000FC00010000780
01A0: 003F000000007F00 01FFFF001F00FFE0 81FFFFC0C7F0000F C3FFC003C7FF8000
01C0: 01C7FF0000C7FE00 300047FE00FF0019 C7FF87FF0031CFFF 00F8002200E00000
01E0: 00000C003F000F80 001107E00003F000 1107FC003FFF0045 FF8007FFE0003FFF
0200: FFF8FFFF
.enddata
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Minimized
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? No
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  16.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.595"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 -  Contents
.head 2 +  Functions
.head 3 +  Function: Procedure_InsUpdt
.head 4 -  Description: Φέρνει τις εγγραφές του WebAit_Egr καλείται η συνάρτηση ελέγχου της κατεύθυνσης και εκτελείται η διαδικασία εισαγωγής των εγγραφών
  στον πίνακα Egrafi.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 5 -  Number: nFetch1
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! Set sStatementDef = SqlGetLastStatement()
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  ! Μετρά τις εγγραφές που υπάρχουν στον WebAit_Egr
.head 5 -  Call CountBegEgr()
.head 5 -  Set frmSplash.dfSynoloEgr = nBeginEgr
.head 5 -  !
.head 5 -  ! Το select των εγγραφών ...
.head 5 +  If NOT SqlRetrieve (hEgrSel, 'WEB_WEBAIT_EGR_SEL',  '', sInto_EgrSel )
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT SqlExecute(hEgrSel)
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hEgrSel, nFetch)
.head 6 -  ! Return FALSE
.head 5 -  ! Αν βρει εγγραφές στον WebAit_Egr συνεχίζει ...
.head 5 +  While nFetch != FETCH_EOF
.head 6 -  !
.head 6 -  ! 071008
.head 6 -  Set bSqlError = FALSE
.head 6 -  ! 071008
.head 6 -  !
.head 6 -  ! 02NOV2012
.head 6 -  Set bEnableMsg = FALSE
.head 6 -  ! 02NOV2012
.head 6 -  !
.head 6 +  If sK_F = '06110049'
.head 7 -  Set sK_F = '06110049'
.head 6 -  ! ST_F
.head 6 -  ! Αν έχει στοιχεία για τον ST_F κάνε το update
.head 6 +  If nSt_fUpdt = 1
.head 7 +  If NOT SqlRetrieve (hSt_fUpdt, 'WEB_ST_F_UPDT',  sBind_StfUpdt, '' )
.head 8 -  Return FALSE
.head 7 +  If NOT SqlExecute(hSt_fUpdt)
.head 8 -  Return FALSE
.head 6 -  !
.head 6 -  ! Για φοιτητές ΣΕΜΦΕ που επιλέγουν Π.Σ. από το ακ. έτος 2010 και μετά ενημερώνεται ο ST_F με την επιλογή προγράμματος που θα ακολουθήσουν!
.head 6 +  If nCodeTmima = 9
.head 7 +  If sProgrSpoud != STRING_Null
.head 8 +  If NOT SqlRetrieve (hSt_fProg9, 'WEB_ST_F_PROG9',  sBind_StfProg9, '' )
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute(hSt_fProg9)
.head 9 -  Return FALSE
.head 6 -  ! ST_F
.head 6 -  ! Ψάξε αν έχει εγγραφή στο συγκεκριμένο ΑΚ και ΧΘ.
.head 6 +  If NOT SqlRetrieve (hEgrChkExist, 'WEB_EGRAFI_EXIST',  sBind_EgrChkExist, sInto_EgrChkExist )
.head 7 -  Set bSqlError = TRUE
.head 7 -  Return FALSE
.head 6 +  If NOT SqlExecute(hEgrChkExist)
.head 7 -  Set bSqlError = TRUE
.head 7 -  Return FALSE
.head 6 +  If NOT SqlFetchNext (hEgrChkExist, nFetch1)
.head 7 -  ! Return FALSE
.head 6 -  !
.head 6 -  ! Εάν η εγγραφή στο εξάμηνο του φοιτητή υπάρχει ήδη πάρε την επόμενη εγγραφή του πίνακα
και ταυτόχρονα ενημέρωσε τον χρήστη γιαυτό
.head 6 +  If nEgrExist > 0
.head 7 -  ! Steile mhnyma
.head 7 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 7 -  Set sMsg = sMsg || sMsgEgr
.head 7 +  If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  If NOT SqlExecute(hEgrReply)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  ! Κάνε update το egrstatus στον Webait_Egr
.head 7 +  If NOT SqlRetrieve (hEgrUpdt,  'WEB_WEBAIT_EGR_UPD',  sBind_EgrUpdt, '' )
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 -  !
.head 7 +  If NOT SqlExecute(hEgrUpdt)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 -  ! !
.head 7 -  ! Βάλε την εγγραφή με το πρόβλημα στον προσωρινό
.head 7 +  ! If NOT SqlRetrieve (hEgrPrPros, 'WEB_EGRPR_PROS',  sBind_EgrPrPros, '' )
.head 8 -  Return FALSE
.head 7 +  ! If NOT SqlExecute(hEgrPrPros)
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  ! !
.head 7 -  Set frmSplash.dfOkEgr = frmSplash.dfOkEgr + 1
.head 7 -  Set frmSplash.dfPendingEgr = frmSplash.dfSynoloEgr - frmSplash.dfOkEgr - frmSplash.dfProblemEgr
.head 7 -  !
.head 6 +  Else
.head 7 -  ! Για όλες τις Σχολές εκτός Αρχιτεκτόνων και Ναυπηγών μετά το 2009, κάνε έλεγχο κατεύθυνσης
.head 7 +  If nCodeTmima != 4 and ( nCodeTmima != 8 OR ( nCodeTmima = 8  and  sK_F > '08095000' and  sK_F < '08105000'  ) )
.head 8 -  !
.head 8 -  ! Αν ΔΕΝ περάσει τον έλεγχο κατεύθυνσης και ροών πήγαινε στην επόμενη εγγραφή αφού καταχωρήσεις μήνυμα για τον χρήστη.
.head 8 -  Set bExeiRoes = FALSE
.head 8 +  If NOT Procedure_ChkKatRoes()
.head 9 -  !
.head 9 -  Set bContinueProc = FALSE
.head 9 -  !
.head 8 -  ! Αν περάσει τον έλεγχο κατεύθυνσης και ροών
.head 8 +  Else
.head 9 -  !
.head 9 +  ! If bEnableMsg
.head 10 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 10 -  Set sMsg = sMsg || sMsgKatRoes
.head 10 -  Call SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 10 -  Call SqlExecute(hEgrReply)
.head 9 +  ! If bUpdateStf
.head 10 -  Call SqlImmediate (' UPDATE ST_F SET KAT = :sKatEgr WHERE K_F = :sK_F ' )
.head 10 -  Call SqlClearImmediate()
.head 9 -  ! If bInsertRoes
.head 9 -  Set bContinueProc = TRUE
.head 9 -  !
.head 7 -  ! Για τους Αρχιτέκτονες συνέχισε χωρίς έλεγχο!
.head 7 +  Else
.head 8 -  Set bContinueProc = TRUE
.head 7 -  !
.head 7 -  ! Αν πέρασε τον έλεγχο της κατεύθυνσης συνέχισε με την καταχώρηση στον egrafi, oblistud , oblistu.
.head 7 +  If bContinueProc
.head 8 -  ! Βάλε την εγγραφή στον πίνακα Egrafi
.head 8 +  If NOT SqlRetrieve (hEgrIns, 'WEB_EGRAFI_INS',  sBind_EgrIns, '' )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 -  !
.head 8 +  If SqlExecute(hEgrIns)
.head 9 -  !
.head 9 -  ! Call SqlGetCommandText (hEgrIns, sStatementText)
.head 9 -  !
.head 9 -  ! Κάνε update το egrstatus στον Webait_Egr
.head 9 +  If NOT SqlRetrieve (hEgrUpdt,  'WEB_WEBAIT_EGR_UPD',  sBind_EgrUpdt, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  !
.head 9 +  If NOT SqlExecute(hEgrUpdt)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  ! Υπολόγισε την εγγραφή που καταχωρήθηκε
.head 9 -  Set nCountFoitEgrafi = nCountFoitEgrafi + 1
.head 9 -  !
.head 9 -  ! Βάλε την εγγραφή στον προσωρινό
.head 9 +  ! If NOT SqlRetrieve (hEgrPros, 'WEB_EGR_PROS',  sBind_EgrPros, '' )
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlExecute(hEgrPros)
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  ! Εισαγωγή των υποχρεώσεων για τον συγκεκριμένο φοιτητή
.head 9 +  If NOT InsertYpoxrEgr()
.head 10 +  If bEnableMsg
.head 11 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 11 -  Set sMsgKatRoes = sMsgYpcourse
.head 11 +  ! If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 12 -  Return FALSE
.head 11 +  ! If NOT SqlExecute(hEgrReply)
.head 12 -  Return FALSE
.head 10 -  ! Return TRUE
.head 9 +  Else
.head 10 +  If bEnableMsg
.head 11 -  Set sMsgKatRoes = sMsgYpcourse
.head 9 -  ! !
.head 9 -  Set frmSplash.dfOkEgr = frmSplash.dfOkEgr + 1
.head 9 -  Set frmSplash.dfPendingEgr = frmSplash.dfSynoloEgr - frmSplash.dfOkEgr - frmSplash.dfProblemEgr
.head 9 -  !
.head 8 +  Else
.head 9 -  ! Set nError = SqlError ( hEgrIns )
.head 9 -  ! Call SqlGetErrorText ( nError, sError )
.head 9 -  ! Steile mhnyma
.head 9 -  Set sMsg = sMsg || 
sMsgEgr3
.head 9 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 9 +  If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hEgrReply)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  ! Βάλε την εγγραφή με το πρόβλημα στον προσωρινό
.head 9 +  If NOT SqlRetrieve (hEgrPrPros, 'WEB_EGRPR_PROS',  sBind_EgrPrPros, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hEgrPrPros)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  ! 08 Oct 2009
.head 9 +  ! If NOT SqlRetrieve (hOblDPrPros, 'WEB_OBLDPR_PROS',  sBind_OblDPrPros, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlExecute(hOblDPrPros)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlRetrieve (hOblUPrPros, 'WEB_OBLUPR_PROS',  sBind_OblUPrPros, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlExecute(hOblUPrPros)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  ! 08 Oct 2009
.head 9 -  ! Return FALSE
.head 9 -  ! !
.head 9 -  Set frmSplash.dfProblemEgr = frmSplash.dfProblemEgr  + 1
.head 9 -  Set frmSplash.dfPendingEgr = frmSplash.dfSynoloEgr - frmSplash.dfOkEgr - frmSplash.dfProblemEgr
.head 8 -  !
.head 8 +  If bEnableMsg
.head 9 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 9 -  Set sMsg = sMsg || 
sMsgKatRoes
.head 9 +  If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hEgrReply)
.head 10 -  Return FALSE
.head 8 +  If bUpdateStf
.head 9 -  ! Call SqlImmediate (' UPDATE ST_F SET KAT = :sKatEgr WHERE K_F = :sK_F ' )
.head 9 -  ! Call SqlClearImmediate()
.head 9 +  If NOT SqlRetrieve (hUpdtKat,  'WEB_UPDTKAT',  sBind_UpdtKat, '' )
.head 10 -  Return FALSE
.head 9 -  !
.head 9 +  If NOT SqlExecute(hUpdtKat)
.head 10 -  Return FALSE
.head 8 +  If bInsertRoes
.head 9 -  ! Εδώ πρέπει να μπεί ο κώδικας για την εισαγωγή των ροών στον ROHFOIT
.head 9 +  If 'INSROES' = 'INSROES'
.head 10 -  ! Βάλε την εγγραφή στον πίνακα Rohfoit
.head 10 -  ! Εκτός Ηλεκτρολόγων
.head 10 +  If nCodeTmima != 3
.head 11 -  Set nPlithos  = 0
.head 11 +  While nPlithos <= nRoesEgr - 1
.head 12 +  If NOT SqlRetrieve (hInsRohfoit, 'WEB_INSROHFOIT',  sBind_InsRohfoit, '' )
.head 13 -  Return FALSE
.head 12 -  !
.head 12 +  If NOT SqlExecute(hInsRohfoit)
.head 13 -  !
.head 13 -  Return FALSE
.head 12 -  Set nPlithos = nPlithos + 1
.head 12 -  !
.head 10 -  ! Ηλεκτρολόγοι
.head 10 +  Else
.head 11 +  If NOT Hlek_InsRohFoit(sAARoesStr, sRohColumn, sRohType)
.head 12 -  Return FALSE
.head 11 -  ! Κάνε update την Alteroh στον ST_F
.head 11 +  If NOT Hlek_UpdtAlterRoh()
.head 12 -  Return FALSE
.head 8 -  !
.head 8 -  ! Βάλε την εγγραφή στον προσωρινό
.head 8 +  If NOT SqlRetrieve (hEgrPros, 'WEB_EGR_PROS',  sBind_EgrPros, '' )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute(hEgrPros)
.head 9 -  Return FALSE
.head 8 -  !
.head 7 +  Else
.head 8 +  If NOT bSqlError
.head 9 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 9 -  Set sMsg = sMsg || 
sMsgKatRoes
.head 9 +  If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hEgrReply)
.head 10 -  Return FALSE
.head 9 -  ! !
.head 9 -  !
.head 9 -  ! Βάλε την εγγραφή με το πρόβλημα στον προσωρινό
.head 9 +  If NOT SqlRetrieve (hEgrPrPros, 'WEB_EGRPR_PROS',  sBind_EgrPrPros, '' )
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hEgrPrPros)
.head 10 -  Return FALSE
.head 9 -  ! 08 Oct 2009
.head 9 +  ! If NOT SqlRetrieve (hOblDPrPros, 'WEB_OBLDPR_PROS',  sBind_OblDPrPros, '' )
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlExecute(hOblDPrPros)
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlRetrieve (hOblUPrPros, 'WEB_OBLUPR_PROS',  sBind_OblUPrPros, '' )
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlExecute(hOblUPrPros)
.head 10 -  Return FALSE
.head 9 -  ! 08 Oct 2009
.head 9 -  !
.head 9 -  Set frmSplash.dfProblemEgr = frmSplash.dfProblemEgr  + 1
.head 9 -  Set frmSplash.dfPendingEgr = frmSplash.dfSynoloEgr - frmSplash.dfOkEgr - frmSplash.dfProblemEgr
.head 8 -  ! Αν βρει λάθος στο SqlStatement
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 -  !
.head 6 -  Set sMsg = STRING_Null
.head 6 -  Set sMsgKatRoes = STRING_Null
.head 6 -  Set sMsgYpcourse = STRING_Null
.head 6 -  !
.head 6 -  Set sProgrSpoud = STRING_Null
.head 6 -  Set sEjEgr = STRING_Null
.head 6 -  Set sOmadaEgr = STRING_Null
.head 6 -  Set sEjKatEgr = STRING_Null
.head 6 -  Set sXUEgr = STRING_Null
.head 6 -  Set sKatStf = STRING_Null
.head 6 -  Set sK_F = STRING_Null
.head 6 -  !
.head 6 -  Set sRoesStrEgr = STRING_Null
.head 6 -  Set sOnlyRoesStr = STRING_Null
.head 6 -  Set sAARoesStr = STRING_Null
.head 6 -  !
.head 6 -  Set nAkEgr = NUMBER_Null
.head 6 -  !
.head 6 -  Set nZero = 0
.head 6 +  While sRohCodeEgr[nZero] != STRING_Null
.head 7 -  Set sRohCodeEgr[nZero] = STRING_Null
.head 7 -  Set nZero = nZero + 1
.head 6 -  Set nZero = 0
.head 6 +  While sRohCodeFoit[nZero] != STRING_Null
.head 7 -  Set sRohCodeFoit[nZero] = STRING_Null
.head 7 -  Set nZero = nZero + 1
.head 6 -  !
.head 6 -  ! πάρε την επόμενη εγγραφή
.head 6 +  If NOT SqlFetchNext (hEgrSel, nFetch)
.head 7 -  ! Return FALSE
.head 6 -  !
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call SalSendMsg( frmWebOmadEgrYX ,  SAM_Destroy, 0 , 0 )
.head 6 -  Return TRUE
.head 5 -  !
.head 3 +  Function: InsertYpoxrEgr
.head 4 -  Description: Εισαγωγή των υποχρεώσεων για τον συγκεκριμένο φοιτητή
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! String: sCodeFoitF
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 5 -  Number: nFetch1
.head 5 -  Number: nFetch2
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! Set bOblKmExists = FALSE
.head 5 -  ! Call SqlImmediate ( ' Select count(k_f) INTO :nCountEgr
		FROM EGRAFI
		where ak < :nAkEgr and ej = :sEjEgr and k_f = :sK_F
   ' )
.head 5 -  ! Call SqlClearImmediate()
.head 5 -  Set sMsgYpcourse = STRING_Null
.head 5 +  If NOT SqlRetrieve (hCountEjEgr,  'WEB_COUNT_EJEGR',  sBind_CountEjEgr, sInto_CountEjEgr )
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT SqlExecute(hCountEjEgr)
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hCountEjEgr, nFetch1)
.head 6 -  ! Return FALSE
.head 5 -  !
.head 5 -  ! !
.head 5 +  ! If sEjEgr = '10'
.head 6 -  Set sEjEgr = '10'
.head 5 -  ! ! και αν εγγράφεται σε εξάμηνο < 10ου για πρώτη φορά χρέωσέ του τις υποχρεώσεις.
.head 5 +  If nCountEjEgr = 0 and sEjEgr != '10'
.head 6 -  !
.head 6 +  If sK_F = '06110049'
.head 7 -  Set sK_F = '06110049'
.head 6 -  ! Πάρε τα μαθήματα από τον YPCOURSE για το εξάμηνο ( ΕΚΤΟΣ Εξαμήνων ροών των ΗΛΕΚΤΡΟΛΟΓΩΝ που γίνεται στο Else) 
.head 6 -  !
.head 6 +  If nCodeTmima != 3 or ( nCodeTmima = 3 and sEjEgr < '06' )
.head 7 -  !
.head 7 -  !
.head 7 +  ! If nCodeTmima = 2 OR nCodeTmima = 6
.head 8 -  !
.head 8 -  Set sStrKmObli = STRING_Null
.head 8 -  Set sKmExistObli = STRING_Null
.head 8 -  !
.head 8 +  If NOT SqlRetrieve (hKmExistObli, 'WEB_KMEXISTOBLI',  sBind_KmExistObli, sInto_KmExistObli )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute(hKmExistObli)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlFetchNext (hKmExistObli, nFetch2 )
.head 9 -  ! Return FALSE
.head 8 +  Else 
.head 9 -  ! Set sSqlCom_SelYpcourse = sSqlCom_SelYpcourse || ' AND YPCOURSE.K_M NOT IN ( '
.head 9 -  Set sSqlCom_SelYpcourseExists = sSqlCom_SelYpcourse || ' AND YPCOURSE.K_M !='
.head 9 -  Set sStrKmObli = sKmExistObli
.head 8 +  While nFetch2 != FETCH_EOF
.head 9 +  If NOT  SqlFetchNext (hKmExistObli, nFetch2 )
.head 10 -  ! 08/03/2013
.head 10 -  ! Set bEnableMsg = TRUE
.head 10 -  If 1 = 1
.head 10 -  ! Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr7
.head 10 -  ! 08/03/2013
.head 9 -  Set sStrKmObli = sStrKmObli || ' AND K_M !=' ||  sKmExistObli
.head 9 -  Set bOblKmExists = TRUE
.head 8 +  If nFetch2 = FETCH_EOF
.head 9 -  ! Call SqlDropStoredCmd ( hSelYpcourseExists, 'WEB_YPCOURSE_SEL_EX' )
.head 9 -  Set sSqlCom_SelYpcourseExists = sSqlCom_SelYpcourseExists || sStrKmObli
.head 9 +  ! If NOT SqlCreateStatement(hSession, hSelYpcourseExists )
.head 10 -  Return FALSE
.head 9 +  ! If NOT SqlStore(hSelYpcourseExists, 'WEB_YPCOURSE_SEL_EX', sSqlCom_SelYpcourseExists )
.head 10 -  Return FALSE
.head 9 -  Set sStrKmObli = STRING_Null
.head 9 +  If NOT SqlPrepare(hSelYpcourseExists, ' SELECT  YPCOURSE.K_M,  OMADA
		      		from YPCOURSE INTO  :nK_mEgr, :sOmadaEgr
                                   		where  ypcourse.ak = :nAkEgr
                                          		and ypcourse.ej =  :sEjEgr  AND YPCOURSE.KAT =:sKatEgr 
		          		and ypcourse.k_m not in (select  k_m from oblistud where k_f = :sK_F )  '  )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 8 -  !
.head 7 -  !
.head 7 -  ! 7/3/2013
.head 7 -  ! Λόγω του ότι η SqlRetrieve  κράσαρε τον server για τους Ναυπηγούς χρησιμοποίησα το SqlPrepare!!
.head 7 -  ! Διαφορά SqlRetrieve με SqlPrepare ...
.head 7 -  ! SqlRetrieve για precompiled commands από SqlStore ενώ το SqlPrepare κάνει compilation κάθε φορά. Δεν συμφέρει αλλά δεν γίνεται αλλιώς!
.head 7 -  !
.head 7 -  ! Τροποποιήθηκε ώστε να τρέχει αυτό για όλες τις Σχολές
.head 7 +  If nCodeTmima != NUMBER_Null
.head 8 +  If NOT SqlPrepare(hSelYpcourse, ' SELECT  YPCOURSE.K_M,  OMADA
		      		from YPCOURSE INTO  :nK_mEgr, :sOmadaEgr
                                   		where  ypcourse.ak = :nAkEgr
                                          		and ypcourse.ej =  :sEjEgr  AND YPCOURSE.KAT =:sKatEgr 
		          		and ypcourse.k_m not in (select  k_m from oblistud where k_f = :sK_F )  '  )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If NOT SqlRetrieve (hSelYpcourse, 'WEB_YPCOURSE_SEL',  sBind_SelYpcourse, sInto_SelYpcourse )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 7 -  !
.head 7 -  ! 7/3/2013
.head 7 -  !
.head 7 +  ! If NOT bOblKmExists
.head 8 +  If NOT SqlExecute(hSelYpcourse)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlFetchNext (hSelYpcourse, nFetch)
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  ! 11/10/2010 Εάν δεν βρεί υποχρεωτικά μαθήματα για το εξάμηνο εμφάνισε πιο συγκεκριμένο μνμ ...
.head 9 +  If nK_mEgr = 0 and sOmadaEgr = ''
.head 10 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr8
.head 9 +  Else 
.head 10 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr8
.head 9 -  ! Return FALSE
.head 7 +  ! Else
.head 8 +  If NOT SqlExecute(hSelYpcourseExists)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlFetchNext (hSelYpcourseExists, nFetch)
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  ! 11/10/2010 Εάν δεν βρεί υποχρεωτικά μαθήματα για το εξάμηνο εμφάνισε πιο συγκεκριμένο μνμ ...
.head 9 +  If nK_mEgr = 0 and sOmadaEgr = ''
.head 10 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr8
.head 9 +  Else 
.head 10 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr8
.head 9 -  ! Return FALSE
.head 7 -  !
.head 7 +  If NOT SqlExecute(hSelYpcourse)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  If NOT SqlFetchNext (hSelYpcourse, nFetch)
.head 8 -  Set bEnableMsg = TRUE
.head 8 -  ! 11/10/2010 Εάν δεν βρεί υποχρεωτικά μαθήματα για το εξάμηνο εμφάνισε πιο συγκεκριμένο μνμ ...
.head 8 +  If nK_mEgr = 0 and sOmadaEgr = ''
.head 9 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr7
.head 8 +  Else
.head 9 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgEgr7
.head 8 -  ! Return FALSE
.head 7 -  !
.head 7 -  Set bOblistud_Insert = FALSE
.head 6 -  !
.head 6 -  ! Χρέωση υποχρεώσεων για εξάμηνα ΡΟΩΝ Ηλεκτρολόγων
.head 6 -  !
.head 6 +  Else
.head 7 -  !
.head 7 +  If sEjEgr > sEjKatEgr
.head 8 -  ! Βρίσκει τον δηλωμένο συνδυασμό ροών από τον ROHFOIT
.head 8 -  Call Hlektr_FindCourRoh( 2 )
.head 8 -  !
.head 8 +  If NOT Hlek_GetYpcourse(sRohFoitEpilog, nFetch)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  ! If NOT SqlFetchNext (hGetYpcourse3, nFetch)
.head 9 -  Return FALSE
.head 7 +  Else If sEjEgr = sEjKatEgr
.head 8 -  !
.head 8 +  If NOT Hlek_GetYpcourse(sRohCodeEgr, nFetch)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  ! If NOT SqlFetchNext (hGetYpcourse3, nFetch)
.head 9 -  Return FALSE
.head 6 -  !
.head 6 +  While nFetch != FETCH_EOF
.head 7 -  ! tbl_yp
.head 7 -  ! Εισαγωγή Υποχρεώσεων στον OBLISTUD
.head 7 -  !
.head 7 +  If NOT SqlRetrieve (hInsObl, 'WEB_OBLISTUD_INS',  sBind_InsObl, '' )
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  ! When SqlError
.head 8 -  !
.head 8 -  Call SqlGetError(  oInsert.sqlHandle, nError, sError )
.head 8 -  Call SalMessageBeep( -1 )
.head 8 -  Call SalMessageBox( 'Η εγγραφή υπάρχει !', 'System', MB_Ok|MB_IconStop )
.head 8 -  ! Return MimerErrorMessage( nError )
.head 7 +  When SqlError
.head 8 -  Call SqlExtractArgs( wParam, lParam, hSqlError, nErr, nPos )
.head 8 -  Call SqlGetErrorText( nErr, strErrmsg )
.head 8 -  Call SalNumberToStr( nErr, 0, strNum )
.head 8 -  ! Set sK_mEgrMsg = ' Το μάθημα με κωδικό ' || SalNumberToStrX(nK_mEgr, 0) || ' δεν θα καταχωρηθεί στις υποχρεώσεις του φοιτητή με κωδικό ' || sK_F || ' ! '
.head 8 -  ! Set sMsgInsError = sMsgInsError || sK_mEgrMsg
.head 8 -  Call SalMessageBox( strNum || ' - ' || strErrmsg || '.' || 

sMsgInsError , 'Transfer Data Database Error', MB_Ok | MB_IconStop )
.head 8 -  Return FALSE
.head 7 +  If SqlExecute(hInsObl)
.head 8 -  !
.head 8 -  ! Βάλε την εγγραφή στον προσωρινό
.head 8 +  If NOT SqlRetrieve (hOblDPros, 'WEB_OBLD_PROS',  sBind_OblDPros, '' )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute(hOblDPros)
.head 9 -  If '1' = '1'
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 -  !
.head 8 -  Set bOblistud_Insert = TRUE
.head 8 -  !
.head 8 -  ! Πάρε την επόμενη εγγραφή από τον ypcourse
.head 8 -  !
.head 8 -  ! Πάρε τα μαθήματα από τον YPCOURSE για το εξάμηνο ΕΚΤΟΣ Εξαμήνων ροών των ΗΛΕΚΤΡΟΛΟΓΩΝ
.head 8 +  ! If nCodeTmima != 3 or ( nCodeTmima = 3 and sEjEgr < '06' )
.head 9 +  If NOT SqlFetchNext (hSelYpcourse, nFetch)
.head 10 -  ! Return FALSE
.head 8 -  !
.head 8 -  ! Πάρε το επόμενο μάθημα για εξάμηνα ΡΟΩΝ Ηλεκτρολόγων
.head 8 +  ! Else
.head 9 +  If NOT SqlFetchNext (hHlek_GetYpcourse, nFetch)
.head 10 -  ! Return FALSE
.head 8 -  !
.head 7 +  Else
.head 8 -  !
.head 8 -  ! Βάλε την εγγραφή  με το πρόβλημα στον προσωρινό
.head 8 +  If NOT SqlRetrieve (hOblDPrPros, 'WEB_OBLDPR_PROS',  sBind_OblDPrPros, '' )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  When SqlError
.head 9 -  Call SqlExtractArgs( wParam, lParam, hSqlError, nErr, nPos )
.head 9 -  Call SqlGetErrorText( nErr, strErrmsg )
.head 9 -  Call SalNumberToStr( nErr, 0, strNum )
.head 9 -  Call SalMessageBox( strNum || ' - ' || strErrmsg || '.' || sMsgInsOblDError , 'Transfer Data Database Error', MB_Ok | MB_IconStop )
.head 9 -  ! Return FALSE
.head 8 +  If NOT SqlExecute(hOblDPrPros)
.head 9 -  If '1' = '1'
.head 9 -  Set bSqlError = TRUE
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgInsOblDError
.head 9 -  ! Return FALSE
.head 8 -  !
.head 8 -  Set bEnableMsg = TRUE
.head 8 -  Set sK_mEgrMsg = sK_mEgrMsg || ' ' || SalNumberToStrX(nK_mEgr, 0)
.head 8 -  ! Set sMsgInsError = sMsgInsError || sK_mEgrMsg
.head 8 -  ! Set sMsgYpcourse  = sMsgYpcourse || sMsgInsError
.head 8 -  ! Return FALSE
.head 8 -  !
.head 8 -  !
.head 7 -  !
.head 7 -  ! Πάρε την επόμενη εγγραφή από τον ypcourse
.head 7 -  !
.head 7 -  ! Πάρε τα μαθήματα από τον YPCOURSE για το εξάμηνο ΕΚΤΟΣ Εξαμήνων ροών των ΗΛΕΚΤΡΟΛΟΓΩΝ
.head 7 +  If nCodeTmima != 3 or ( nCodeTmima = 3 and sEjEgr < '06' )
.head 8 +  If NOT SqlFetchNext (hSelYpcourse, nFetch)
.head 9 -  ! Return FALSE
.head 7 -  !
.head 7 -  ! Πάρε το επόμενο μάθημα για εξάμηνα ΡΟΩΝ Ηλεκτρολόγων
.head 7 +  Else
.head 8 +  If NOT SqlFetchNext (hHlek_GetYpcourse, nFetch)
.head 9 -  ! Return FALSE
.head 7 -  !
.head 7 +  If nFetch = FETCH_EOF
.head 8 +  If bEnableMsg
.head 9 -  Set sMsgInsError1 = sMsgInsError_init || sK_mEgrMsg || ' για τον φοιτητή ' || sK_F || ' '
.head 9 -  Set sMsgYpcourse  = sMsgYpcourse || sMsgInsError1 ||  sMsgInsError2
.head 6 +  If bOblistud_Insert
.head 7 -  Set nCountFoitOblistud = nCountFoitOblistud + 1
.head 6 -  ! **************** Συνεχίζουμε με τις επιλογές OBLISTU ***********************************
.head 6 -  !
.head 6 +  If 'OBLISTU' = 'OBLISTU'
.head 7 -  ! Call SqlImmediate ( ' Select count(*) INTO :nCountOblistu
		FROM OBLISTU
		where ej = :sEjEgr and k_f = :sK_F
   ' )
.head 7 +  If NOT SqlRetrieve (hCountOblistu,  'WEB_COUNT_OBLISTU',  sBind_CountOblistu, sInto_CountOblistu )
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 -  !
.head 7 +  If NOT SqlExecute(hCountOblistu)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  If NOT SqlFetchNext (hCountOblistu, nFetch1)
.head 8 -  ! Return FALSE
.head 7 -  !
.head 7 -  ! Αν δεν υπάρχει εγγραφή στο συγκεκριμένο εξάμηνο συνέχισε την διαδικασία
.head 7 +  If nCountOblistu = 0
.head 8 -  Set nOmMaxChoice = 0
.head 8 -  Set nYpMaxChoice = 0
.head 8 -  Set nTotMaxChoice = 0
.head 8 -  ! αριθμός επιλογών από ομάδες
.head 8 -  ! Call SqlImmediate ( " SELECT SUM( omadepim.maxchoice )
                                          INTO :nOmMaxChoice
                                          FROM omadepim
                                          WHERE  omadepim.ej = :sEjEgr AND
                                                          omadepim.k_tm = :nCodeTmima  AND
                                                          omadepim.kat = :sKatEgr  AND
                                                          ak = :nAkEgr " )
.head 8 +  If NOT SqlRetrieve (hMaxChoice,  'WEB_OM_MAXCHOICE',  sBind_MaxChoice, sInto_MaxChoice )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 -  !
.head 8 +  If NOT SqlExecute(hMaxChoice)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlFetchNext (hMaxChoice, nFetch1)
.head 9 -  ! Return FALSE
.head 8 -  !
.head 8 -  ! αριθμός επιλογών από υπερομάδες
.head 8 -  ! Call SqlImmediate (" SELECT SUM( ypmadepm.maxchoice )
                                         INTO  :nYpMaxChoice
                                         FROM YPMADEPM
                                         WHERE  ypmadepm.ej = :sEjEgr  AND
                                                        ypmadepm.k_tm = :nCodeTmima  AND
                                                        ypmadepm.kat = :sKatEgr  AND
                                                        ak = :nAkEgr " )
.head 8 -  ! Call SqlClearImmediate()
.head 8 -  !
.head 8 +  If NOT SqlRetrieve (hYpMaxChoice,  'WEB_YP_MAXCHOICE',  sBind_YpMaxChoice, sInto_YpMaxChoice )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 -  !
.head 8 +  If NOT SqlExecute(hYpMaxChoice)
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If NOT SqlFetchNext (hYpMaxChoice, nFetch1)
.head 9 -  ! Return FALSE
.head 8 -  !
.head 8 -  ! ! 31/10/2016  Για το 8ο και 9ο εξάμηνο των Πολιτικών από το 2016 και μετά υπολογίζει στον συνολ. αριθμό υποχρ. μόνο τις υπερομάδες
.head 8 +  If nCodeTmima = 1 and nAkEgr >= 2016 and ( sEjEgr = '08' or sEjEgr = '09' )
.head 9 -  Set nTotMaxChoice =  nYpMaxChoice
.head 8 +  Else
.head 9 -  Set nTotMaxChoice = nOmMaxChoice + nYpMaxChoice
.head 8 -  !
.head 8 -  ! Set nTotMaxChoice = nOmMaxChoice + nYpMaxChoice
.head 8 -  !
.head 8 +  If NOT SqlRetrieve (hInsEpilo,  'WEB_OBLISTU_INS',  sBind_InsEpilo, '' )
.head 9 -  Set bSqlError = TRUE
.head 9 -  Return FALSE
.head 8 +  If SqlExecute(hInsEpilo)
.head 9 -  !
.head 9 -  ! Βάλε την εγγραφή στον προσωρινό
.head 9 +  If NOT SqlRetrieve (hOblUPros, 'WEB_OBLU_PROS',  sBind_OblUPros, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hOblUPros)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  Set nCountFoitOblistu = nCountFoitOblistu + 1
.head 9 -  !
.head 8 +  Else
.head 9 -  !
.head 9 -  ! Βάλε την εγγραφή με το πρόβλημα στον προσωρινό
.head 9 +  If NOT SqlRetrieve (hOblUPrPros, 'WEB_OBLUPR_PROS',  sBind_OblUPrPros, '' )
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 +  If NOT SqlExecute(hOblUPrPros)
.head 10 -  Set bSqlError = TRUE
.head 10 -  Return FALSE
.head 9 -  !
.head 9 -  Return FALSE
.head 7 -  ! Αν υπάρχει εγγραφή στο συγκεκριμένο εξάμηνο στείλε μήνυμα και συνέχισε την διαδικασία
.head 7 +  Else
.head 8 -  ! Κάνε update το EGRREPLY στον Webait_Egr
.head 8 -  !
.head 8 -  ! Set sMsg = sMsg || sMsgEgr2
.head 8 +  ! If NOT SqlRetrieve (hEgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 9 -  Return FALSE
.head 8 +  ! If NOT SqlExecute(hEgrReply)
.head 9 -  Return FALSE
.head 8 -  Set sMsgYpcourse  = sMsgYpcourse || ' 
 ' ||
sMsgEgr2
.head 8 -  Set bEnableMsg = TRUE
.head 8 -  !
.head 8 -  ! Return FALSE
.head 6 -  !
.head 6 -  ! Call SqlClearImmediate()
.head 6 -  Return TRUE
.head 5 -  !
.head 3 +  Function: InitMessages
.head 4 -  Description: Μηνύματα
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sMsg = ''
.head 5 -  Set sMsgExistStf = ' Μήνυμα 1. Δεν έχουν καταχωρηθεί τα σταθερά στοιχεία του φοιτητή.'
.head 5 -  Set sMsgEgr = ' Μήνυμα 2. Ο φοιτητής έχει εγγραφή στο συγκεκριμένο εξάμηνο.'
.head 5 -  Set sMsgEgr1 = ' Μήνυμα 3. Ο φοιτητής έχει χρεωθεί μαθήματα στο συγκεκριμένο εξάμηνο.'
.head 5 -  Set sMsgEgr2 = ' Μήνυμα 4. Ο φοιτητής έχει χρεωθεί αριθμητική υποχρέωση για τις επιλογές στο συγκεκριμένο εξάμηνο.'
.head 5 -  Set sMsgEgr3 = ' Μήνυμα 5. Αποτυχία εισαγωγής της εγγραφής του φοιτητή στο εξάμηνο.'
.head 5 -  Set sMsgEgr4 = ' Μήνυμα 6. Αποτυχία εισαγωγής της εγγραφής του φοιτητή στο εξάμηνο. Ενημερώστε το εξάμηνο δηλούμενης κατεύθυνσης από τη φόρμα του Τμήματος !'
.head 5 -  Set sMsgEgr5 = ' Μήνυμα 7. Αποτυχία εισαγωγής της εγγραφής του φοιτητή στο εξάμηνο. Ο φοιτητής έχει ήδη καταχωρημένη κατεύθυνση διαφορετική από αυτή που δηλώνει !'
.head 5 -  Set sMsgEgr6 = ' Μήνυμα 8. Αποτυχία εισαγωγής της εγγραφής του φοιτητή στο εξάμηνο. Ο φοιτητής έχει ήδη καταχωρημένη κατεύθυνση διαφορετική από αυτή που δηλώνει!'
.head 5 -  Set sMsgEgr7 = ' Μήνυμα 9. Δεν καταχωρήθηκαν υποχρεωτικά μαθήματα. Πιθανόν οι υποχρεώσεις να έχουν ήδη καταχωρηθεί ή το εξάμηνο να  μην έχει υποχρεωτικά μαθήματα ή δεν έχει ενημερωθεί το Π.Σ. για το τρέχον έτος !'
.head 5 -  Set sMsgEgr8 = ' Μήνυμα 26. Δεν καταχωρήθηκαν υποχρεωτικά μαθήματα. Το εξάμηνο δεν έχει υποχρεωτικά μαθήματα ή δεν έχει ενημερωθεί το Π.Σ. για το τρέχον έτος ! '
.head 5 -  Set sMsgEgr9 = ' Μήνυμα 27. Δεν καταχωρήθηκαν υποχρεωτικά μαθήματα. Αποτυχία αναζήτησης υποχρεωτικών μαθημάτων του εξαμήνου ! '
.head 5 -  !
.head 5 -  Set sMsgKatRoes1 = ' Μήνυμα 10. Υπάρχουν καταχωρημένες ροές για τον/την φ. ενώ βρίσκεται ακόμη σε εξάμηνο που δεν μπορεί να επιλέξει κατεύθυνση!'
.head 5 -  Set sMsgKatRoes2 = ' Μήνυμα 11. Δεν επιτρέπεται η δήλωση κατεύθυνσης σε εξάμηνο μικρότερο του εξαμήνου κατεύθυνσης! '
.head 5 -  Set sMsgKatRoes3a = ' Μήνυμα 12. Ο/Η φ. έχει καταχωρημένη κατεύθυνση σε εξάμηνο που δεν δικαιούται επιλογή κατεύθυνσης!'
.head 5 -  Set sMsgKatRoes3b = ' Μήνυμα 13. Ο/Η φ. έχει καταχωρημένη κατεύθυνση σε εξάμηνο που δεν δικαιούται επιλογή κατεύθυνσης!'
.head 5 -  Set sMsgKatRoes4 = ' Μήνυμα 14. Υπάρχει καταχωρημένος συνδυασμός ροών ενώ ο/η φ. βρίσκεται σε εξάμηνο που δεν δικαιούται επιλογή κατεύθυνσης!'
.head 5 -  Set sMsgKatRoes5 = ' Μήνυμα 15. Ο/Η φ. δηλώνει συνδ. ροών διαφορετικό από αυτόν που είναι καταχωρημένος!'
.head 5 -  Set sMsgKatRoes6 = ' Μήνυμα 16. Ο/Η φ. δηλώνει συνδ. ροών διαφορετικό από αυτόν που είναι καταχωρημένος!'
.head 5 -  Set sMsgKatRoes7 = '  Μήνυμα 17. Η δήλωση της κατεύθυνσης διαφέρει από την καταχωρημένη! '
.head 5 -  Set sMsgKatRoes8 = ' Μήνυμα 18. Πρέπει να δηλωθεί κατεύθυνση!'
.head 5 -  Set sMsgKatRoes9 = '  Μήνυμα 19. Να ενημερωθεί το εξάμηνο κατεύθυνσης από την Φόρμα του Τμήματος!'
.head 5 -  Set sMsgKatRoes10 = ' Μήνυμα 20. Να ενημερωθεί το εξάμηνο κατεύθυνσης από την Φόρμα του Τμήματος!'
.head 5 -  Set sMsgKatRoes11 = ' Μήνυμα 21. Υπάρχει δήλωση κατεύθυνσης σε εξάμηνο που δεν δικαιούται να επιλέξει κατεύθυνση, καθώς και λανθασμένη καταχωρημένη κατεύθυνση στα σταθερά του στοιχεία!'
.head 5 -  Set sMsgKatRoes12 = ' Μήνυμα 24. Δεν έχει δηλωθεί συνδυασμός ροών ενώ υπάρχει καταχωρημένος στον πίνακα του/της φ. '
.head 5 -  Set sMsgKatRoes14 = ' Μήνυμα 28. Το string του συνδυασμού ροών δεν είναι σωστό! '
.head 5 -  !
.head 5 -  ! Πιθανότατα μετά την αλλαγή του select των υποχρεώσεων (sSqlCom_SelYpcourse) το μήνυμα 22 δεν πρόκειται να εμφανίζεται !
.head 5 -  Set sMsgInsError = ' Μήνυμα 22. Πρόβλημα με την εισαγωγή της υποχρέωσης στον πίνακα OBLISTUD. Κάνετε έλεγχο για διπλοεγγραφή στον πίνακα YPCOURSE του Π.Σ. '
.head 5 -  Set sMsgInsError_init = ' Μήνυμα 22. Πρόβλημα με την εισαγωγή της υποχρέωσης '
.head 5 -  Set sMsgInsError2 = 'στον πίνακα OBLISTUD. Το μάθημα έχει ήδη καταχωρηθεί! Κάνετε συγκριτικό έλεγχο των υποχρεώσεων από το Π.Σ.(ypcourse), με τις υποχρεώσεις που καταχωρήθηκαν στον φοιτητή (oblistud). '
.head 5 -  !
.head 5 -  Set sMsgInsOblDError = ' Μήνυμα 23. Δεν μπόρεσε να εισαχθεί η προβληματική εγγραφή στον βοηθητικό πίνακα! '
.head 5 -  Set sMsgKatRoes13 = ' Μήνυμα 25. Ο/Η φ. δηλώνει συνδ. ροών χωρίς να έχει δηλώσει κατεύθυνση και σε εξάμηνο μικρότερο του εξαμήνου δηλ. κατεύθυνσης! '
.head 5 -  Set nCountFoitEgrafi = 0
.head 5 -  Set nCountFoitOblistud = 0
.head 5 -  Set nCountFoitOblistu = 0
.head 3 +  Function: CountBegEgr
.head 4 -  Description: Μετράει τις εγγραφές του WebAit_Egr πριν την εκκίνηση της διαδικασίας που είναι έτοιμες προς καταχώρηση
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 4 +  Actions
.head 5 -  ! Call SqlImmediate ( 'SELECT COUNT(*) 
		FROM WEBAIT_EGR 
		INTO :nBeginEgr  
WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) ')
.head 5 -  !
.head 5 -  Call SqlRetrieve (hCountBegEgr,  'WEB_COUNT_BEGEGR',  '', sInto_CountBegEgr )
.head 5 -  !
.head 5 -  Call SqlExecute(hCountBegEgr)
.head 5 -  Call SqlFetchNext (hCountBegEgr, nFetch)
.head 3 +  Function: CountFinEgr
.head 4 -  Description: Μετράει τις εγγραφές του WebAit_Egr μετά το πέρας της διαδικασίας που δεν καταχωρήθηκαν
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 4 +  Actions
.head 5 -  ! Call SqlImmediate ( 'SELECT COUNT(*) 
		FROM WEBAIT_EGR 
		INTO :nFinalEgr  
WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) ')
.head 5 -  !
.head 5 -  Call SqlRetrieve (hCountFinEgr,  'WEB_COUNT_FINEGR',  '', sInto_CountFinEgr )
.head 5 -  !
.head 5 -  Call SqlExecute(hCountFinEgr)
.head 5 -  Call SqlFetchNext (hCountBegEgr, nFetch)
.head 3 -  !
.head 3 +  ! Function: ConnectHandles
.head 4 -  Description: Εκκίνηση των Handles
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 -  !
.head 5 -  Call SqlConnect(hEgrSel)
.head 5 -  Call SqlConnect(hEgrIns)
.head 5 -  Call SqlConnect(hEgrUpdt)
.head 5 -  Call SqlConnect(hEgrChkExist)
.head 5 -  Call SqlConnect(hEgrReply)
.head 5 -  Call SqlConnect(hInsObl)
.head 5 -  Call SqlConnect(hInsEpilo)
.head 5 -  Call SqlConnect(hSelYpcourse)
.head 5 -  Call SqlConnect(hChkRoesFoit)
.head 5 -  Call SqlConnect(hGetEjDilKat)
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Call SqlConnect(hEgrPros)
.head 5 -  Call SqlConnect(hOblDPros)
.head 5 -  Call SqlConnect(hOblUPros)
.head 5 -  !
.head 3 +  Function: DisconnectHandles
.head 4 -  Description: Τερματισμός των Handles
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  !
.head 5 -  !
.head 5 -  Call SqlDisconnect(hEgrSel)
.head 5 -  Call SqlDisconnect(hSt_fUpdt)
.head 5 -  Call SqlDisconnect(hEgrIns)
.head 5 -  Call SqlDisconnect(hEgrUpdt)
.head 5 -  Call SqlDisconnect(hEgrChkExist)
.head 5 -  Call SqlDisconnect(hEgrReply)
.head 5 -  Call SqlDisconnect(hInsObl)
.head 5 -  Call SqlDisconnect(hInsEpilo)
.head 5 -  Call SqlDisconnect(hSelYpcourse)
.head 5 -  Call SqlDisconnect(hChkRoesFoit)
.head 5 -  Call SqlDisconnect(hChkRoesFoit3)
.head 5 -  Call SqlDisconnect(hOmadalekt3)
.head 5 -  Call SqlDisconnect(hGetEjDilKat)  
.head 5 -  Call SqlDisconnect(hHlek_InsRohFoit)  
.head 5 -  Call SqlDisconnect(hHlek_GetYpcourse)  
.head 5 -  Call SqlDisconnect(hHlek_GetSymbolRoh)  
.head 5 -  Call SqlDisconnect(hHlek_UpdtAlterRoh)  
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Call SqlDisconnect(hEgrPros)
.head 5 -  Call SqlDisconnect(hOblDPros)
.head 5 -  Call SqlDisconnect(hOblUPros)
.head 5 -  Call SqlDisconnect(hEgrPrPros)
.head 5 -  Call SqlDisconnect(hOblDPrPros)
.head 5 -  Call SqlDisconnect(hOblUPrPros)
.head 5 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 +  ! Function: Initialize_BINDS
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα BIND Strings
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 -  !
.head 5 -  ! 2. BIND VARIABLES LISTS
.head 5 -  !
.head 5 -  ! Set sBind_EgrSel 		= ' :sK_F, :nAKEgr, :sXUEgr, :sEJ, :dDateEgr, :sKAT '
.head 5 -  Set sBind_EgrIns 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_EgrUpdt 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_EgrReply		= ' :sK_F, :nAkEgr, :sXUEgr, :sMsg '
.head 5 -  Set sBind_EgrChkExist 	= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_SelYpcourse 	= ' :sK_F, :nAkEgr, :sXUEgr, :nCodeTmima, :sEjEgr '
.head 5 -  Set sBind_InsObl		= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  Set sBind_InsEpilo		= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 5 -  Set sBind_GetEjDilKat	= ' :nCodeTmima, :nAkEgr '
.head 5 -  Set sBind_ChkRoesFoit	= ' :nCodeTmima, :sK_F '
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sBind_UpdtKat		= ' :sKatEgr, :sK_F '
.head 5 -  Set sBind_CountEjEgr	= ' :nAkEgr, :sEjEgr, :sK_F '
.head 5 -  Set sBind_CountOblistu	= ' :sEjEgr, :sK_F '
.head 5 -  Set sBind_MaxChoice	= ' :sEjEgr, :nCodeTmima, :sKatEgr, :nAkEgr '
.head 5 -  Set sBind_YpMaxChoice	= ' :sEjEgr, :nCodeTmima, :sKatEgr, :nAkEgr '
.head 5 -  Set sBind_GetKatStf	= ' :sK_F '
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set sBind_EgrPros 		= ' :sK_F, :nAkEgr, :sXUEgr '
.head 5 -  Set sBind_OblDPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  Set sBind_OblUPros	= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 3 +  ! Function: Initialize_INTO
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα INTO Strings
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! 1. INTO VARIABLES LISTS
.head 5 -  !
.head 5 -  Set sInto_EgrSel 		= ' :sK_F, :nAkEgr, :sXUEgr, :sEjEgr, :sKatEgr '
.head 5 -  Set sInto_EgrChkExist	= ' :nEgrExist '
.head 5 -  Set sInto_SelYpcourse	= ' :nK_mEgr, :sOmadaEgr '
.head 5 -  Set sInto_GetEjDilKat	= ' :sEjKatEgr '
.head 5 -  Set sInto_ChkRoesFoit	= ' :sKatRoes, :sRohCode '
.head 5 -  ! Set sInto_InsObl		= ' :sK_F, :nCodeTmima, :sEjEgr, :nK_mEgr, :nAkEgr , :sOmadaEgr '
.head 5 -  ! Set sInto_InsEpilo		= ' :sK_F, :nCodeTmima, :sEjEgr, :nTotMaxChoice '
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sInto_CountBegEgr	= ' :nBeginEgr '
.head 5 -  Set sInto_CountFinEgr	= ' :nFinalEgr '
.head 5 -  Set sInto_GetSxoliCode	= ' :nCodeTmima '
.head 5 -  Set sInto_CountEjEgr	= ' :nCountEgr '
.head 5 -  Set sInto_CountOblistu	= ' :nCountOblistu '
.head 5 -  Set sInto_MaxChoice	= ' :nOmMaxChoice '
.head 5 -  Set sInto_YpMaxChoice	= ' :nYpMaxChoice '
.head 5 -  Set sInto_GetKatStf		= ' :sKatStf '
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 3 +  ! Function: Initialize_COMMANDS
.head 4 -  Description: Καλείται από την Initialize_Variables. Δίνει τιμές στα SqlCommands Strings.
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! 3. SQL COMMANDS STRINGS
.head 5 -  !
.head 5 -  !
.head 5 -  ! ! 	!EGRAFI
.head 5 -  Set sSqlCom_EgrSel 	      =  	' SELECT K_F, AK, XU ,EJ, KAT
				FROM  WEBAIT_EGR
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrChkExist 	      =  	' SELECT COUNT(*)			
				FROM  EGRAFI
				WHERE K_F = :1 AND AK = :2 AND XU = :3  '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrReply	      =  	' UPDATE  WEBAIT_EGR
				SET EGRREPLY = :4
				WHERE K_F = :1 AND AK = :2 AND XU = :3 '
.head 5 -  !
.head 5 -  Set sSqlCom_EgrIns 	      =  	' INSERT INTO EGRAFI 
				(K_F, AK, XU ,EJ, EGRDATE, KAT)
				SELECT K_F, AK, XU ,EJ, EGRDATE, KAT
				FROM  WEBAIT_EGR
				WHERE K_F = :1 AND AK = :2 AND XU = :3 ' 
.head 5 -  !
.head 5 -  Set sSqlCom_EgrUpdt	      =  	' UPDATE  WEBAIT_EGR
				SET EGRSTATUS = 1
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) 
				AND K_F = :1 AND AK = :2 AND XU = :3 '
.head 5 -  !
.head 5 -  Set sSqlCom_SelYpcourse	      =  	' SELECT  YPCOURSE.K_M,  OMADA
			
		      		from YPCOURSE, ST_M
                                   		where  ypcourse.ak = :2  and st_m.ak = ypcourse.ak and st_m.xu = :3
		          		and st_m.k_tm = ypcourse.k_tm and st_m.k_m = ypcourse.k_m
                                          		and ypcourse.ej = :5 and st_m.k_tm = :4
		          		and st_m.k_m not in (select  k_m from oblistud where k_f = :1 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_InsObl	      =  	' INSERT INTO OBLISTUD
		  		( K_F, K_TM, EJ, K_M, AK, OMADA)
                                   		VALUES ( :1, :2, :3, :4, :5 , :6 ) '
.head 5 -  !
.head 5 -  ! Set sSqlCom_SelEpilo	      =  	' SELECT COUNT(*) 
				FROM OBLISTU
		   		WHERE  where  ej = :3 and k_f = :1  '
.head 5 -  !
.head 5 -  Set sSqlCom_InsEpilo	      =  	' INSERT INTO OBLISTU
		   		(K_F, K_TM, EJ, TOTEPIL)
                                   		VALUES ( :1, :2, :3, :4 ) '
.head 5 -  ! IN USE !!!!!!!
.head 5 -  Set sSqlCom_GetEjDilKat	      =  	' SELECT EJKAT
                                  		FROM PROYPROG                                  		
                                  		WHERE K_TM = :1 AND AK = :2 '
.head 5 -  !
.head 5 -  Set sSqlCom_ChkRoesFoit	      =  	' SELECT KAT, ROHCODE
                                  		FROM ROHFOIT                                  		
                                  		WHERE K_TM = :1 AND K_F = :2 '
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set sSqlCom_EgrPros 	      =  	' INSERT INTO WEB_EGR_PROS 
				(K_F, AK, XU ,EJ, EGRDATE, KAT)
				SELECT K_F, AK, XU ,EJ, EGRDATE, KAT
				FROM  WEBAIT_EGR
				WHERE K_F = :1 AND AK = :2 AND XU = :3 ' 
.head 5 -  !
.head 5 -  Set sSqlCom_OblDPros	      =  	' INSERT INTO WEB_OBLD_PROS
		  		( K_F, K_TM, EJ, K_M, AK, OMADA)
                                   		VALUES ( :1, :2, :3, :4, :5 , :6 ) '
.head 5 -  !
.head 5 -  Set sSqlCom_OblUPros	      =  	' INSERT INTO WEB_OBLU_PROS
		   		(K_F, K_TM, EJ, TOTEPIL)
                                   		VALUES ( :1, :2, :3, :4 ) '
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  Set sSqlCom_CountBegEgr	      =  	'SELECT COUNT(*) 
				FROM WEBAIT_EGR 				
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  !
.head 5 -  Set sSqlCom_CountFinEgr	      =  	'SELECT COUNT(*) 
				FROM WEBAIT_EGR 				
				WHERE ( EGRSTATUS = 0 OR EGRSTATUS IS NULL ) '
.head 5 -  !
.head 5 -  Set sSqlCom_GetSxoliCode	      =  	' SELECT DISTINCT(K_TM) 
				FROM ST_F 
				ORDER BY K_TM DESC '
.head 5 -  !
.head 5 -  Set sSqlCom_UpdtKat	      =  	' UPDATE ST_F 
				SET KAT = :1 
				WHERE K_F = :2 ' 
.head 5 -  !
.head 5 -  ! Call SqlImmediate (' UPDATE ST_F SET KAT = :sKatEgr WHERE K_F = :sK_F ' )
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_CountEjEgr	      =  	 ' Select count(k_f) 				
				FROM EGRAFI
				where ak < :1 and ej = :2 and k_f = :3   '
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' Select count(k_f) INTO :nCountEgr
		FROM EGRAFI
		where ak < :nAkEgr and ej = :sEjEgr and k_f = :sK_F
   ' )
.head 5 -  !
.head 5 -  Set sSqlCom_CountOblistu	      =  	 ' Select count(*) 
				INTO :nCountOblistu
				FROM OBLISTU
				where ej = :sEjEgr and k_f = :sK_F '
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' Select count(*) INTO :nCountOblistu
		FROM OBLISTU
		where ej = :sEjEgr and k_f = :sK_F
   ' )
.head 5 -  !
.head 5 -  !
.head 5 -  Set sSqlCom_MaxChoice	      =  	 " SELECT SUM( omadepim.maxchoice )                                          		
                                         		 FROM omadepim
                                          		WHERE  omadepim.ej = :1 AND
                                                         		 omadepim.k_tm = :2  AND
                                                         		 omadepim.kat = :3  AND
                                                        		  ak = :4 "
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( " SELECT SUM( omadepim.maxchoice )
                                          INTO :nOmMaxChoice
                                          FROM omadepim
                                          WHERE  omadepim.ej = :sEjEgr AND
                                                          omadepim.k_tm = :nCodeTmima  AND
                                                          omadepim.kat = :sKatEgr  AND
                                                          ak = :nAkEgr " )
.head 5 -  !
.head 5 -  Set sSqlCom_YpMaxChoice	      =  	 " SELECT SUM( ypmadepm.maxchoice )                                         		
                                         		FROM YPMADEPM
                                        		 WHERE  ypmadepm.ej = :1  AND
                                                        		ypmadepm.k_tm = :2  AND
                                                       		 ypmadepm.kat = :3  AND
                                                        		ak = :4 "
.head 5 -  !
.head 5 -  ! Call SqlImmediate (" SELECT SUM( ypmadepm.maxchoice )
                                         INTO  :nYpMaxChoice
                                         FROM YPMADEPM
                                         WHERE  ypmadepm.ej = :sEjEgr  AND
                                                        ypmadepm.k_tm = :nCodeTmima  AND
                                                        ypmadepm.kat = :sKatEgr  AND
                                                        ak = :nAkEgr " )
.head 5 -  !
.head 5 -  Set sSqlCom_GetKatStf	      =  	' SELECT KAT 
				FROM ST_F 
				INTO :sKatStf 
				WHERE K_F = :sK_F '
.head 5 -  !
.head 5 -  ! Call SqlImmediate ( ' SELECT KAT FROM ST_F INTO :sKatStf WHERE K_F = :sK_F ' )
.head 5 -  !
.head 5 -  ! SQLIMMEDIATE
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 3 +  ! Function: StoreCommand
.head 4 -  Description: Αποθηκεύει κάθε SqlCommand στη βάση
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  ! Sql Handle: hSqlStatement
.head 5 -  ! String: sStatementName
.head 5 -  ! String: strSqlCommand
.head 5 -  ! String: sBindVariables
.head 5 -  ! String: sIntoList
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  ! When SqlError
.head 6 -  Set nRcd = SqlError(hSqlStatement)
.head 6 +  If nRcd = 207
.head 7 -  !
.head 6 -  !
.head 5 -  Call SqlStore(hEgrSel, 'WEB_WEBAIT_EGR_SEL', sSqlCom_EgrSel )
.head 5 -  Call SqlCommit(hEgrSel)
.head 5 -  Call SqlStore(hEgrIns, 'WEB_EGRAFI_INS', sSqlCom_EgrIns )
.head 5 -  Call SqlCommit(hEgrIns)
.head 5 -  Call SqlStore(hEgrUpdt, 'WEB_WEBAIT_EGR_UPD', sSqlCom_EgrUpdt )
.head 5 -  Call SqlCommit(hEgrUpdt)
.head 5 -  Call SqlStore(hEgrReply, 'WEB_WEBAIT_EGR_RPL', sSqlCom_EgrReply )
.head 5 -  Call SqlCommit(hEgrReply)
.head 5 -  Call SqlStore(hEgrChkExist, 'WEB_EGRAFI_EXIST', sSqlCom_EgrChkExist )
.head 5 -  Call SqlCommit(hEgrChkExist)
.head 5 -  Call SqlStore(hSelYpcourse, 'WEB_YPCOURSE_SEL', sSqlCom_SelYpcourse )
.head 5 -  Call SqlCommit(hSelYpcourse)
.head 5 -  Call SqlStore(hInsObl, 'WEB_OBLISTUD_INS', sSqlCom_InsObl )
.head 5 -  Call SqlCommit(hInsObl)
.head 5 -  Call SqlStore(hInsEpilo, 'WEB_OBLISTU_INS', sSqlCom_InsEpilo )
.head 5 -  Call SqlCommit(hInsEpilo)
.head 5 -  Call SqlStore(hGetEjDilKat, 'WEB_GETEJ_DILKAT', sSqlCom_GetEjDilKat )
.head 5 -  Call SqlCommit(hGetEjDilKat)
.head 5 +  If nCodeTmima = 3 OR nCodeTmima = 6 OR nCodeTmima = 9
.head 6 -  Call SqlStore(hChkRoesFoit, 'WEB_CHKROES_FOIT', sSqlCom_ChkRoesFoit )
.head 6 -  Call SqlCommit(hChkRoesFoit)
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Call SqlStore(hCountBegEgr, 'WEB_COUNT_BEGEGR', sSqlCom_CountBegEgr )
.head 5 -  Call SqlCommit(hCountBegEgr)
.head 5 -  Call SqlStore(hCountFinEgr, 'WEB_COUNT_FINEGR', sSqlCom_CountFinEgr )
.head 5 -  Call SqlCommit(hCountFinEgr)
.head 5 -  Call SqlStore(hGetSxoliCode, 'WEB_GET_SXCODE', sSqlCom_GetSxoliCode )
.head 5 -  Call SqlCommit(hGetSxoliCode)
.head 5 -  Call SqlStore(hUpdtKat, 'WEB_UPDTKAT', sSqlCom_UpdtKat )
.head 5 -  Call SqlCommit(hUpdtKat)
.head 5 -  Call SqlStore(hCountEjEgr, 'WEB_COUNT_EJEGR', sSqlCom_CountEjEgr)
.head 5 -  Call SqlCommit(hCountEjEgr)
.head 5 -  Call SqlStore(hCountOblistu, 'WEB_COUNT_OBLISTU', sSqlCom_CountOblistu)
.head 5 -  Call SqlCommit(hCountOblistu)
.head 5 -  Call SqlStore(hMaxChoice, 'WEB_OM_MAXCHOICE', sSqlCom_MaxChoice)
.head 5 -  Call SqlCommit(hMaxChoice)
.head 5 -  Call SqlStore(hYpMaxChoice, 'WEB_YP_MAXCHOICE', sSqlCom_YpMaxChoice)
.head 5 -  Call SqlCommit(hYpMaxChoice)
.head 5 -  Call SqlStore(hGetKatStf, 'WEB_GET_KATST_F', sSqlCom_GetKatStf)
.head 5 -  Call SqlCommit(hGetKatStf)
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Call SqlStore(hEgrPros, 'WEB_EGR_PROS', sSqlCom_EgrPros )
.head 5 -  Call SqlCommit(hEgrPros)
.head 5 -  Call SqlStore(hOblDPros, 'WEB_OBLD_PROS', sSqlCom_OblDPros )
.head 5 -  Call SqlCommit(hOblDPros)
.head 5 -  Call SqlStore(hOblUPros, 'WEB_OBLU_PROS', sSqlCom_OblUPros )
.head 5 -  Call SqlCommit(hOblUPros)
.head 5 -  !
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  ! SQLIMMEDIATE
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  ! Function: RetrieveStatement
.head 4 -  Description: Αναζήτηση της SqlCommand αποθηκευμένης από τη βάση
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Sql Handle: hSqlStatement
.head 5 -  String: sStatementName
.head 5 -  String: strSqlCommand
.head 5 -  String: sBindVariables
.head 5 -  String: sIntoList
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  !
.head 5 +  ! When SqlError
.head 6 -  Set nRcd = SqlError(hSqlStatement)
.head 6 +  If nRcd = 207
.head 7 -  !
.head 7 -  Set sInsStatementName = 'INSERT_EGRAFI'
.head 7 -  Set sUpdtStatementName = 'UPDATE_WEBAIT_EGR'
.head 7 -  Set sChkVaStatementName = 'CHECK_BAUMOI'
.head 7 -  !
.head 7 -  Call SqlStore(hSqlStatement, sStatementName, strSqlCommand_EgrSel )
.head 7 -  Call SqlStore(hSql_InsStatement, sInsStatementName, strSqlCommand_EgrIns )
.head 7 -  Call SqlStore(hSql_UpdtStatement, sUpdtStatementName, strSqlCommand_EgrUpdt )
.head 7 -  Call SqlStore(hCheckCourse, sChkVaStatementName, sChkVa )
.head 7 -  !
.head 7 -  Call SqlCommit(hSqlStatement)
.head 7 -  Call SqlRetrieve(hSqlStatement, sStatementName, sBindVariables, sIntoList )
.head 7 -  Call SqlRetrieve (hSql_InsStatement, sInsStatementName,  '', '' )
.head 7 -  Call SqlRetrieve (hSql_UpdtStatement, sUpdtStatementName,  '', '' )
.head 7 -  Return TRUE
.head 6 -  !
.head 5 -  ! Call SqlRetrieve (hSqlStatement, sStatementName,  sBindVariables, sIntoList )
.head 5 -  !
.head 5 -  Call SqlRetrieve (hState_EgrSel, 'WEB_WEBAIT_EGR_SEL',  '', sInto_EgrSel )
.head 5 -  Call SqlRetrieve (hState_EgrIns, 'WEB_EGRAFI_INS',  sBind_EgrIns, '' )
.head 5 -  Call SqlRetrieve (hState_EgrUpdt,  'WEB_WEBAIT_EGR_UPD',  sBind_EgrUpdt, '' )
.head 5 -  Call SqlRetrieve (hState_EgrReply,  'WEB_WEBAIT_EGR_RPL',  sBind_EgrReply, '' )
.head 5 -  Call SqlRetrieve (hState_EgrChkExist, 'WEB_EGRAFI_EXIST',  sBind_EgrChkExist, sInto_EgrChkExist )
.head 5 -  Call SqlRetrieve (hState_SelYpcourse, 'WEB_YPCOURSE_SEL',  sBind_SelYpcourse, sInto_SelYpcourse )
.head 5 -  Call SqlRetrieve (hState_InsObl, 'WEB_OBLISTUD_INS',  sBind_InsObl, '' )
.head 5 -  Call SqlRetrieve (hState_InsEpilo,  'WEB_OBLISTU_INS',  sBind_InsEpilo, '' )
.head 5 -  !
.head 3 +  ! Function: CreateStatements
.head 4 -  Description: Δημιουργία των Statements για το δοσμένο session
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrSel )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrIns )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrUpdt )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrReply )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrChkExist )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hSelYpcourse )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hInsObl )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hInsEpilo )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetEjDilKat )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hChkRoesFoit)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountBegEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountFinEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetSxoliCode)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hUpdtKat)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountEjEgr)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hCountOblistu)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hMaxChoice)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hYpMaxChoice)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hGetKatStf)
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! ΠΡΟΣΩΡΙΝΟΙ ΠΙΝΑΚΕΣ
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hEgrPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblDPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  Set bOkStatement = SqlCreateStatement(hSession, hOblUPros )
.head 5 +  If bOkStatement
.head 6 -  ! Call SalMessageBox( 'Create statement done', 'Good!', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalMessageBox( 'Create statement failed', 'error!', MB_Ok )
.head 5 -  !
.head 3 +  Function: Procedure_GeneralCall
.head 4 -  Description: Εκκίνηση της διαδικασίας. Εδώ καλούνται και εκτελούνται όλες οι συναρτήσεις.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Ανοίγει το session των εγγραφών σε εξάμηνο
.head 5 -  ! Call CreateSession()
.head 5 -  !
.head 5 -  ! Call SetInitValues()
.head 5 -  !
.head 5 -  ! Δημιουργεί τα statements των εγγραφών σε εξάμηνο
.head 5 -  ! Call CreateStatements()
.head 5 -  !
.head 5 -  ! Σύνδεση των Handles
.head 5 -  ! Call ConnectHandles()
.head 5 -  !
.head 5 -  ! Δίνει τα ονόματα στα statements
.head 5 -  ! Call SetCommandName()
.head 5 -  !
.head 5 -  ! Αρχικοποίηση μεταβλητών
.head 5 -  ! Call Initialize_INTO()
.head 5 -  ! Call Initialize_BINDS()
.head 5 -  ! Call Initialize_COMMANDS()
.head 5 -  Call InitMessages()
.head 5 -  ! !
.head 5 -  !
.head 5 -  ! Αποθηκέυει τις απαιτούμενες εντολές στη βάση αν δεν έχει γίνει ήδη.
.head 5 -  ! Call StoreCommand ()
.head 5 -  !
.head 5 -  ! Φέρνει τις εγγραφές του WebAit_Egr και εκτελείται η διαδικασία εισαγωγής των εγγραφών
  στον πίνακα Egrafi.
.head 5 +  If NOT Procedure_InsUpdt()
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalEnableWindow(frmSplash.pbΕxit)
.head 5 -  Call SalEnableWindow(frmSplash.pbDetail)
.head 5 -  Call SalEnableWindow(frmSplash.pbPreviewProblem)
.head 5 -  !
.head 5 -  Return TRUE
.head 5 -  !
.head 3 +  ! Function: GetEjDilKat
.head 4 -  Description: Ελεγχος αν έχει επιλεγεί κατεύθυνση ανάλογα με το εξάμηνο.
Επίσης 'διαβάζονται' το Εξάμηνο κατεύθυνσης από τη φόρμα του τμήματος.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nFetch
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! ΟΧΙ ΓΙΑ ΤΟΥΣ ΑΡΧΙΤΕΚΤΟΝΕΣ (ΔΕΝ ΕΧΟΥΝ ΚΑΤΕΥΘΥΝΣΕΙΣ)
.head 5 +  If nCodeTmima != 4
.head 6 -  Call SqlRetrieve (hGetEjDilKat, 'WEB_GETEJ_DILKAT',  '', sInto_GetEjDilKat )
.head 6 -  !
.head 6 -  Call SqlExecute(hGetEjDilKat)
.head 6 -  Call SqlFetchNext (hGetEjDilKat, nFetch)
.head 6 -  !
.head 6 +  If nFetch != FETCH_EOF
.head 7 -  !
.head 7 -  ! Εάν το εξάμηνο δηλούμενης κατεύθυνσης > του εξαμήνου εγγραφής του φ. επέστρεψε TRUE
.head 7 +  If sEjKatEgr > sEjEgr
.head 8 -  !
.head 8 -  Set bGetEjDilKat = TRUE
.head 7 +  Else 
.head 8 -  !
.head 8 -  Set bGetEjDilKat = FALSE
.head 8 -  !
.head 6 -  ! Αν δεν υπάρχει καταχώρηση στον PROYPROG για το έτος εγγραφής του φοιτητή ενημέρωση το πεδίο EgrReply
.head 6 +  Else 
.head 7 -  !
.head 7 -  Set bGetEjDilKat = FALSE
.head 5 -  ! Για τους Αρχιτέκτονες επέστεψε πάντα TRUE
.head 5 +  Else 
.head 6 -  Set bGetEjDilKat = TRUE
.head 5 -  Return bGetEjDilKat
.head 3 +  ! Function: chkkat
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If sKATDilonei = '00'
.head 6 -  !
.head 6 -  ! Αν είναι σε εξάμηνο κατεύθυνσης ή δεν έχει ενημερωθεί το εξάμηνο δήλωσης στη φόρμα τμήμα
.head 6 +  If NOT ChkKatEgr()
.head 7 -  !
.head 7 +  If sKatYparxei = '00'
.head 8 +  If ErrorMessageOk(' Πρέπει να επιλεγεί κατεύθυνση και να ενημερωθεί από τη φόρμα της Δήλωσης ! Ο φοιτητής υπόκειται σε ειδική περίπτωση; ','', 2)
.head 9 -  !
.head 9 -  ! Call SalEnableWindow(cmbKatFoitEg)
.head 8 +  Else 
.head 9 -  ! Call SalDisableWindow(cmbKatFoitEg)
.head 9 -  Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 9 -  Return FALSE
.head 7 +  Else If sKatYparxei != '00' 
.head 8 +  If ErrorMessageOk(' Πρέπει να επιλεγεί κατεύθυνση ! Ο φοιτητής υπόκειται σε ειδική περίπτωση; ','', 2)
.head 9 -  !
.head 8 +  Else 
.head 9 -  Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 9 -  Return FALSE
.head 6 +  Else If sKatYparxei = STRING_Null 
.head 7 -  Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 7 -  Return FALSE
.head 5 +  If sKATDilonei != '00'
.head 6 -  !
.head 6 +  If ChkKatEgr()
.head 7 -  !
.head 7 +  If ErrorMessageOk(" Πρέπει να επιλεγεί κατεύθυνση 'ΜΗ ΟΡΙΣΜΕΝΗ' ! Αν ο/η φοιτητής/τρια υπόκειται σε ειδική περίπτωση επιλέξτε 'Yes' ",'', 2)
.head 8 -  !
.head 7 +  Else 
.head 8 -  !
.head 8 -  Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 8 -  Return FALSE
.head 7 +  ! Else
.head 8 -  ! Call SalDisableWindow(cmbKatFoitEg)
.head 8 -                                               Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 8 -  ! !!!!
.head 8 -  ! Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 8 -  ! Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 8 -  ! Call SalSendMsg(  pbAddtbl , SAM_Click , 0 , 0 )
.head 8 -  ! !!!!
.head 8 -  ! Set colEgrafiEj = STRING_Null
.head 8 -  ! Set colEgrafiEjCode = STRING_Null
.head 8 -  ! Call SalSetFocus(colEgrafiEj)
.head 8 -  ! Return TRUE
.head 6 +  Else If sKatYparxei = STRING_Null
.head 7 -  Call SalSendMsg(  pbCancel , SAM_Click , 0 , 0 )
.head 7 -  Return FALSE
.head 3 +  Function: Procedure_ChkKatRoes
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetch
.head 5 -  Number: nFetch1
.head 5 -  Number: nFetch2
.head 5 -  Number: nFetch3
.head 4 +  Actions
.head 5 -  ! Βρες την κατεύθυνση που έχει ήδη καταχωρημένη στον ST_F
.head 5 -  ! Call SqlImmediate ( ' SELECT KAT FROM ST_F INTO :sKatStf WHERE K_F = :sK_F ' )
.head 5 -  ! Call SqlClearImmediate()
.head 5 -  !
.head 5 +  ! When SqlError
.head 6 -  Call SqlErrorMsg(hSqlHandler,'Retreive Error' )
.head 6 -  Set bSqlError = TRUE
.head 5 -  !
.head 5 -  ! Set hSqlHandler = hGetKatStf
.head 5 -  ! Βρες την κατεύθυνση που έχει ήδη καταχωρημένη στον ST_F
.head 5 +  If NOT SqlRetrieve (hGetKatStf,  'WEB_GET_KATST_F',  sBind_GetKatStf, sInto_GetKatStf )
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT SqlExecute(hGetKatStf)
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hGetKatStf, nFetch3)
.head 6 -  Set bEnableMsg = TRUE
.head 6 -  Set bUpdateStf = FALSE
.head 6 -  Set bInsertRoes = FALSE
.head 6 -  Set sMsgKatRoes =  sMsgExistStf
.head 6 -  Return FALSE
.head 6 -  ! Return FALSE
.head 5 -  !
.head 5 -  ! PROSORINO 071008 !!!!!!
.head 5 -  ! Δεν υπήρχαν κατευθύνσεις για τους Ναυπηγούς πριν το 1995 ! 
Καταργήθηκαν οι Ροές από το θερινό του ακ. έτους 2009
.head 5 +  If nCodeTmima = 8
.head 6 +  If sKatStf = '00' and sKatEgr = '00'
.head 7 +  If sK_F < '08095000' or sK_F > '08105000'
.head 8 -  Set bEnableMsg = FALSE
.head 8 -  Set bUpdateStf = FALSE
.head 8 -  Set bInsertRoes = FALSE
.head 8 -  ! Set bInsertYpoxr = TRUE
.head 8 -  Return TRUE
.head 5 -  ! PROSORINO 071008 !!!!!!
.head 5 -  !
.head 5 -  ! Βρες το εξάμηνο της δηλούμενης κατεύθυνσης από τον PROYPROG
.head 5 -  ! Set hSqlHandler = hGetEjDilKat
.head 5 +  If NOT SqlRetrieve (hGetEjDilKat, 'WEB_GETEJ_DILKAT',  sBind_GetEjDilKat , sInto_GetEjDilKat )
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 +  If NOT SqlExecute(hGetEjDilKat)
.head 6 -  Set bSqlError = TRUE
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hGetEjDilKat, nFetch)
.head 6 -  ! Return FALSE
.head 5 -  !
.head 5 -  ! Βρες τις ροές του φοιτητή-τριας για τις σχολές που υπόκεινται σε καθεστώς ροών
.head 5 +  If nCodeTmima = 6 or nCodeTmima = 9
.head 6 -  ! Set hSqlHandler = hChkRoesFoit
.head 6 +  If NOT SqlRetrieve (hChkRoesFoit, 'WEB_CHKROES_FOIT',  sBind_ChkRoesFoit, sInto_ChkRoesFoit)
.head 7 -  Set bSqlError = TRUE
.head 7 -  Return FALSE
.head 6 +  If NOT SqlExecute(hChkRoesFoit)
.head 7 -  Set bSqlError = TRUE
.head 7 -  Return FALSE
.head 6 +  If NOT SqlFetchNext (hChkRoesFoit, nFetch1)
.head 7 -  ! Return FALSE
.head 7 -  Set bExeiRoes = FALSE
.head 6 +  Else
.head 7 -  Set bExeiRoes = TRUE
.head 6 -  Set nRoesFoit = 0
.head 6 +  While nFetch1 != FETCH_EOF
.head 7 -  Set sRohCodeFoit[nRoesFoit] = sRoesFoit
.head 7 -  Set nRoesFoit = nRoesFoit + 1
.head 7 +  If NOT SqlFetchNext (hChkRoesFoit, nFetch1)
.head 8 -  ! Return FALSE
.head 6 -  Set bSxoliRovn = TRUE
.head 6 -  !
.head 6 -  ! Για τις ροές που έχει δηλώσει βάλτες σε μεταβλητές
.head 6 +  If 1 = 1
.head 7 -  Set nRoesEgr = 0
.head 7 -  ! Μηδενισμός Array
.head 7 +  While sRohCodeEgr[nRoesEgr] != STRING_Null
.head 8 -  Set sRohCodeEgr[nRoesEgr] = STRING_Null
.head 8 -  Set nRoesEgr = nRoesEgr + 1
.head 7 -  Set nRoesEgr = 0
.head 7 -  Set sSplitter = ';'
.head 7 -  !
.head 7 +  If NOT SplitString (sSplitter, sRoesStrEgr, sRohCodeEgr, nRoesEgr  )
.head 8 -  Return FALSE
.head 7 -  ! Set sRohCodeEgr[nRoesEgr]  = SplitString (sSplitter, sRoesStrEgr )
.head 7 -  !
.head 7 -  ! Βάζει τις ροές του φοιτητή του WebAit_egr σε Array για να τις συγκρίνει με αυτές που τυχόν έχει καταχωρημένες στη βάση.
.head 7 -  ! Set sRemainStr = sRoesStrEgr
.head 7 -  ! Set nStrLen = SalStrLength ( sRoesStrEgr )
.head 7 +  ! While sRemainStr != ''
.head 8 -  Set nStrOffset = SalStrScan ( sRemainStr, sSplitter)
.head 8 +  If nStrOffset != -1
.head 9 -  Set sRohCodeEgr[nRoesEgr] = SalStrLeftX ( sRemainStr, nStrOffset )
.head 9 -  Set sRemainStr = SalStrMidX ( sRemainStr, nStrOffset + 1, nStrLen - nStrOffset )
.head 9 -  Set nRoesEgr = nRoesEgr + 1
.head 8 -  Else 
.head 7 -  !
.head 5 -  ! HLEKTROLOGOI
.head 5 +  Else If nCodeTmima = 3
.head 6 -  ! Set hSqlHandler = hChkRoesFoit
.head 6 +  If 1!=1
.head 7 +  If NOT SqlRetrieve (hChkRoesFoit3, 'WEB_CHKROES_FOIT3',  sBind_ChkRoesFoit3, sInto_ChkRoesFoit3)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  If NOT SqlExecute(hChkRoesFoit3)
.head 8 -  Set bSqlError = TRUE
.head 8 -  Return FALSE
.head 7 +  If NOT SqlFetchNext (hChkRoesFoit3, nFetch1)
.head 8 -  ! Return FALSE
.head 8 -  Set bExeiRoes = FALSE
.head 7 +  Else
.head 8 -  Set bExeiRoes = TRUE
.head 7 -  Set nRoesFoit = 0
.head 7 +  While nFetch1 != FETCH_EOF
.head 8 -  Set sRohCodeFoit[nRoesFoit] = sRoesFoit
.head 8 -  Set nRoesFoit = nRoesFoit + 1
.head 8 +  If NOT SqlFetchNext (hChkRoesFoit3, nFetch1)
.head 9 -  ! Return FALSE
.head 6 -  Set nRoesEgr = 0
.head 6 -  ! Μηδενισμός Array
.head 6 +  While sRohCodeEgr[nRoesEgr] != STRING_Null
.head 7 -  Set sRohCodeEgr[nRoesEgr] = STRING_Null
.head 7 -  Set nRoesEgr = nRoesEgr + 1
.head 6 -  ! Βάζει τους 4ψήφιους κωδικούς των Ροών από το ROHFOIT σε μεταβλητές για τον φοιτητή Ηλεκτρολόγων
.head 6 -  ! Εάν βρίσκεται σε εξάμηνο κατεύθυνσης
.head 6 +  If sEjEgr >= sEjKatEgr
.head 7 -  Call Hlektr_FindCourRoh(2)
.head 7 -  ! Αν ΔΕΝ ανήκει ακόμη σε ΡΟΕΣ
.head 7 +  If nRoesFoit = 0 or nRoesFoit = NUMBER_Null
.head 8 -  Set bExeiRoes = FALSE
.head 7 -  ! Αν ανήκει σε ΡΟΕΣ
.head 7 +  Else
.head 8 -  Set bExeiRoes = TRUE
.head 6 -  !
.head 6 -  Set bSxoliRovn = TRUE
.head 6 -  !
.head 6 -  ! 24/9/2010
.head 6 -  Set sAARoesStr = SalStrLeftX( sRoesStrEgr, 1)
.head 6 -  Set sOnlyRoesStr = SalStrRightX(sRoesStrEgr , SalStrLength(sRoesStrEgr)- 2 )
.head 6 -  !
.head 6 -  ! Αν είναι να γραφτει σε εξάμηνο >= του εξαμηνου κατεύθυνσης και έχει ροές ή δεν έχει ακόμη αλλά πρωτοδηλώνει
.head 6 -  ! Για τις ροές που έχει δηλώσει στον WEBAIT_EGR βάλτες και αυτές σε μεταβλητές ώστε να συγκριθούν με αυτές του ROHFOIT
.head 6 +  If sEjEgr >= sEjKatEgr and (  bExeiRoes  OR ( NOT bExeiRoes and sOnlyRoesStr != STRING_Null )  )
.head 7 +  If 1 = 1
.head 8 -  ! Set nRoesEgr = 0
.head 8 -  ! Μηδενισμός Array
.head 8 +  ! While sRohCodeEgr[nRoesEgr] != STRING_Null
.head 9 -  Set sRohCodeEgr[nRoesEgr] = STRING_Null
.head 9 -  Set nRoesEgr = nRoesEgr + 1
.head 8 -  Set nRoesEgr = 0
.head 8 -  Set sSplitter = ';'
.head 8 -  !
.head 8 -  ! 14/7/2016
.head 8 +  If NOT SplitString (sSplitter, sOnlyRoesStr, sRohCodeEgr, nRoesEgr  )
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgKatRoes = sMsgKatRoes14
.head 9 -  Return FALSE
.head 8 -  !
.head 8 -  ! If NOT Hlektr_FindAA_Roes()
.head 8 -  !
.head 8 -  ! Χρησιμοποιείται για να γίνει η εισαγωγή των ροών στον ROHFOIT
.head 8 +  If NOT Hlektr_GetSymbolRoh(sRohCodeEgr, sRohColumn, sRohType )
.head 9 +  If sRohCodeEgr[0] = STRING_Null
.head 10 -  Set bEnableMsg = TRUE
.head 10 -  Set sMsgKatRoes = sMsgKatRoes12
.head 9 -  Return FALSE
.head 8 -  !
.head 8 -  ! Set sRohCodeEgr[nRoesEgr]  = SplitString (sSplitter, sRoesStrEgr )
.head 8 -  !
.head 8 -  ! Βάζει τις ροές του φοιτητή του WebAit_egr σε Array για να τις συγκρίνει με αυτές που τυχόν έχει καταχωρημένες στη βάση.
.head 8 -  ! Set sRemainStr = sRoesStrEgr
.head 8 -  ! Set nStrLen = SalStrLength ( sRoesStrEgr )
.head 8 +  ! While sRemainStr != ''
.head 9 -  Set nStrOffset = SalStrScan ( sRemainStr, sSplitter)
.head 9 +  If nStrOffset != -1
.head 10 -  Set sRohCodeEgr[nRoesEgr] = SalStrLeftX ( sRemainStr, nStrOffset )
.head 10 -  Set sRemainStr = SalStrMidX ( sRemainStr, nStrOffset + 1, nStrLen - nStrOffset )
.head 10 -  Set nRoesEgr = nRoesEgr + 1
.head 9 -  Else 
.head 8 -  !
.head 5 +  Else
.head 6 -  Set bSxoliRovn = FALSE
.head 5 -  !
.head 5 -  ! Αν υπάρχει εγγραφή στον proyprog για το εξάμηνο δηλούμενης κατεύθυνσης ή για το ΣΕΜΦΕ
δεν υπάρχει αφού η κατεύθυνση είναι ΜΗ ΟΡΙΣΜΕΝΗ
.head 5 +  If nFetch != FETCH_EOF  OR  ( nFetch = FETCH_EOF and sKatEgr = '00' and nCodeTmima = 9 ) 
.head 6 -  !
.head 6 -  ! Αν έχει τιμή το εξάμηνο
.head 6 +  If sEjKatEgr != STRING_Null OR (sEjKatEgr = STRING_Null and sKatEgr = '00' and nCodeTmima = 9 )
.head 7 -  ! Εάν το εξάμηνο δηλούμενης κατεύθυνσης > του εξαμήνου εγγραφής του φοιτητή (Κατεύθυνση ΜΗ ΟΡΙΣΜΕΝΗ ) ή είναι το 10ο δηλ. ανήκει σε καθεστώς χωρίς κατευθύνσεις
.head 7 -  ! Θέλει επανέλεγχο!!!!!!!!!!!!
.head 7 +  If ( sEjKatEgr > sEjEgr and sEjKatEgr != '10' ) OR ( sEjKatEgr = STRING_Null and nCodeTmima = 9 )
.head 8 -  !
.head 8 -  ! 1. Αν η κατεύθυνση του φοιτητή είναι 'ΜΗ ΟΡΙΣΜΕΝΗ' (καταχωρημένη και δηλωμένη)
.head 8 +  If sKatEgr = '00' and sKatStf = '00'
.head 9 +  If NOT bSxoliRovn
.head 10 -  Set bEnableMsg = FALSE
.head 10 -  Set bUpdateStf = FALSE
.head 10 -  Set bInsertRoes = FALSE
.head 10 -  ! Set bInsertYpoxr = TRUE
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  ! Αν υπάρχουν δηλωμένες ροές
.head 10 +  If bExeiRoes
.head 11 -  ! Μήνυμα ότι υπάρχουν δηλωμένες ροές στον ROHFOIT ενώ ο φ. βρίσκεται σε εξάμηνο μη ορισμ. κατ.
.head 11 -  Set bEnableMsg = TRUE
.head 11 -  Set sMsgKatRoes = sMsgKatRoes1
.head 11 -  Return FALSE
.head 10 -  ! Αν δεν υπάρχουν ροές δηλωμένες στον ROHFOIT και είναι σε εξάμηνο με ΜΗ ΟΡΙΣΜΕΝΗ τοτε ...
.head 10 +  Else
.head 11 -  ! Αν υπάρχει δηλωμένος συνδυασμός ροών στον WEBAIT_EGR δεν κανει την εγγραφή και εμφανίζει μνμ λάθους.
.head 11 +  If sOnlyRoesStr != STRING_Null
.head 12 -  Set bEnableMsg = TRUE
.head 12 -  Set bUpdateStf = FALSE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  Set sMsgKatRoes = sMsgKatRoes13
.head 12 -  Return FALSE
.head 11 -  ! Αν ΔΕΝ υπάρχει δηλωμένος συνδυασμός ροών στον WEBAIT_EGR  τότε ολα ΟΚ
.head 11 +  Else
.head 12 -  Set bEnableMsg = FALSE
.head 12 -  Set bUpdateStf = FALSE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  Return TRUE
.head 8 -  ! 2. Αν η καταχωρημένη κατεύθυνση του φοιτητή είναι 'ΜΗ ΟΡΙΣΜΕΝΗ' ή Null και υπάρχει δηλωμένη κατεύθυνση διαφορετική
.head 8 +  Else If sKatEgr != '00' and ( sKatStf = '00' or sKatStf = STRING_Null )
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgKatRoes = sMsgKatRoes2
.head 9 -  Set bUpdateStf = FALSE
.head 9 -  Set bInsertRoes = FALSE
.head 9 -  ! Set bInsertYpoxr = FALSE
.head 9 -  Return FALSE
.head 8 -  ! 11. Αν υπάρχει καταχωρημένη κατεύθυνση του φοιτητή  και υπάρχει και δηλωμένη κατεύθυνση διαφορετική σε εξάμηνο που πρέπει να είναι ΜΗ ΟΡΙΣΜΕΝΗ 
(εκτός Ναυπηγών από το θερινό εξάμηνο του 2009 κατάργηση κατευθύνσεων και ροών) 
.head 8 +  Else If sKatEgr != '00' and ( sKatStf != '00' ) and nCodeTmima != 8
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgKatRoes = sMsgKatRoes11
.head 9 -  Set bUpdateStf = FALSE
.head 9 -  Set bInsertRoes = FALSE
.head 9 -  ! Set bInsertYpoxr = FALSE
.head 9 -  Return FALSE
.head 8 -  ! 3. Αν η καταχωρημένη κατεύθυνση του φοιτητή είναι !=  'ΜΗ ΟΡΙΣΜΕΝΗ' και η δηλωμένη 'ΜΗ ΟΡΙΣΜΕΝΗ'
.head 8 +  If sKatEgr = '00' and sKatStf != '00'
.head 9 +  If NOT bSxoliRovn
.head 10 -  Set bEnableMsg = TRUE
.head 10 -  Set sMsgKatRoes = sMsgKatRoes3a
.head 10 -  Set bUpdateStf = FALSE
.head 10 -  Set bInsertRoes = FALSE
.head 10 -  ! Set bInsertYpoxr = FALSE
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  ! Μήνυμα ότι υπάρχουν δηλωμένες ροές στον ROHFOIT ενώ ο φ. βρίσκεται σε εξάμηνο μη ορισμ. κατ.
.head 10 -  Set bEnableMsg = TRUE
.head 10 -  Set sMsgKatRoes = sMsgKatRoes3b
.head 10 -  Return FALSE
.head 8 -  ! 4. Αν η καταχωρημένη κατεύθυνση του φοιτητή είναι NULL και η δηλωμένη 'ΜΗ ΟΡΙΣΜΕΝΗ'
.head 8 +  If sKatEgr = '00' and sKatStf = STRING_Null
.head 9 -  ! Σχολή χωρίς ροές
.head 9 +  If NOT bSxoliRovn
.head 10 -  Set bEnableMsg = FALSE
.head 10 -  Set bUpdateStf = TRUE
.head 10 -  Set bInsertRoes = FALSE
.head 10 -  ! Set bInsertYpoxr = TRUE
.head 10 -  Return TRUE
.head 9 -  ! Σχολή με ροές
.head 9 +  Else
.head 10 -  ! Αν υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  If bExeiRoes
.head 11 -  ! Μήνυμα ότι υπάρχουν δηλωμένες ροές στον ROHFOIT ενώ ο φ. βρίσκεται σε εξάμηνο μη ορισμ. κατ.
.head 11 -  Set bEnableMsg = TRUE
.head 11 -  Set sMsgKatRoes = sMsgKatRoes4
.head 11 -  Return FALSE
.head 10 -  ! Αν ΔΕΝ υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  Else
.head 11 -  Set bEnableMsg = FALSE
.head 11 -  Set bUpdateStf = TRUE
.head 11 -  Set bInsertRoes = FALSE
.head 11 -  ! Set bInsertYpoxr = TRUE
.head 11 -  Return TRUE
.head 7 -  ! Εάν το εξάμηνο δηλούμενης κατεύθυνσης <= του εξαμήνου εγγραφής του φοιτητή (Κατεύθυνση ΜΗ ΟΡΙΣΜΕΝΗ ) 
ή δεν υποχρεούται να δηλώσει κατεύθυνση (Αρχιτέκτονες και πρόσφατα Ναυπηγοί)
.head 7 +  Else
.head 8 -  !
.head 8 -  ! 5. Αν ΈΧΕΙ δηλωμένη κάποια κατεύθυνση και η καταχωρημένη κατεύθυνση εϊναι 'ΜΗ ΟΡΙΣΜΕΝΗ' ή null
.head 8 +  If sKatEgr != '00' and ( sKatStf = '00' or sKatStf = STRING_Null )
.head 9 +  If NOT bSxoliRovn
.head 10 -  Set bEnableMsg = FALSE
.head 10 -  Set bUpdateStf = TRUE
.head 10 -  Set bInsertRoes = FALSE
.head 10 -  ! Set bInsertYpoxr = TRUE
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  ! Αν υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  If bExeiRoes
.head 11 +  ! If sRoesFoit != sRoesStrEgr
.head 12 -  Set bEnableMsg = TRUE
.head 12 -  Set sMsgKatRoes = sMsgKatRoes5
.head 12 -  ! Μήνυμα ότι υπάρχει δήλωση διαφορετικών ροών
.head 12 -  Return FALSE
.head 11 +  ! Else
.head 12 -  Set bEnableMsg = FALSE
.head 12 -  Set bUpdateStf = TRUE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  ! Set bInsertYpoxr = TRUE
.head 12 -  Return TRUE
.head 11 -  ! Έλεγχος αν οι ροές που δηλώνει είναι διαφορετικές από τις καταχωρημένες.
.head 11 +  If NOT SameRoes(sRohCodeFoit, sRohCodeEgr, nRoesFoit, nRoesEgr )
.head 12 -  Set bEnableMsg = TRUE
.head 12 -  Set sMsgKatRoes = sMsgKatRoes5
.head 12 -  ! Μήνυμα ότι υπάρχει δήλωση διαφορετικών ροών
.head 12 -  Return FALSE
.head 11 +  Else
.head 12 -  Set bEnableMsg = FALSE
.head 12 -  Set bUpdateStf = TRUE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  ! Set bInsertYpoxr = TRUE
.head 12 -  Return TRUE
.head 10 -  ! Αν ΔΕΝ υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  Else
.head 11 -  Set bEnableMsg = FALSE
.head 11 -  Set bUpdateStf = TRUE
.head 11 -  Set bInsertRoes = TRUE
.head 11 -  ! Set bInsertYpoxr = TRUE
.head 11 -  Return TRUE
.head 8 -  !
.head 8 -  ! 6. Αν δηλώνει κάποια κατεύθυνση και η καταχωρημένη κατεύθυνση είναι ίδια != της 'ΜΗ ΟΡΙΣΜΕΝΗΣ'
.head 8 +  If sKatEgr != '00' and ( sKatStf = sKatEgr )
.head 9 +  If NOT bSxoliRovn
.head 10 -  Set bEnableMsg = FALSE
.head 10 -  Set bUpdateStf = FALSE
.head 10 -  Set bInsertRoes = FALSE
.head 10 -  ! Set bInsertYpoxr = TRUE
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  ! Αν υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  If bExeiRoes
.head 11 +  ! If sRoesFoit != sRoesStrEgr
.head 12 -  Set bEnableMsg = TRUE
.head 12 -  Set sMsgKatRoes = sMsgKatRoes6
.head 12 -  ! Μήνυμα ότι υπάρχει δήλωση διαφορετικών ροών (πρόκειται για αλλάγή κατεύθυνσης; )
.head 12 -  Return FALSE
.head 11 +  ! Else
.head 12 -  Set bEnableMsg = FALSE
.head 12 -  Set bUpdateStf = FALSE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  ! Set bInsertYpoxr = TRUE
.head 12 -  Return TRUE
.head 11 -  ! Έλεγχος αν οι ροές που δηλώνει είναι διαφορετικές από τις καταχωρημένες.
.head 11 +  If NOT SameRoes(sRohCodeFoit, sRohCodeEgr, nRoesFoit, nRoesEgr)
.head 12 -  Set bEnableMsg = TRUE
.head 12 -  Set sMsgKatRoes = sMsgKatRoes6
.head 12 -  ! Μήνυμα ότι υπάρχει δήλωση διαφορετικών ροών (πρόκειται για αλλάγή κατεύθυνσης; )
.head 12 -  Return FALSE
.head 11 +  Else
.head 12 -  Set bEnableMsg = FALSE
.head 12 -  Set bUpdateStf = FALSE
.head 12 -  Set bInsertRoes = FALSE
.head 12 -  ! Set bInsertYpoxr = TRUE
.head 12 -  Return TRUE
.head 10 -  ! Αν ΔΕΝ υπάρχουν καταχωρημένες ροές στον ROHFOIT
.head 10 +  Else
.head 11 -  Set bEnableMsg = FALSE
.head 11 -  Set bUpdateStf = FALSE
.head 11 +  If nCodeTmima =  3 and sRoesStrEgr = ''
.head 12 -  Set bInsertRoes = FALSE
.head 11 +  Else
.head 12 -  Set bInsertRoes = TRUE
.head 11 -  ! Set bInsertYpoxr = TRUE
.head 11 -  Return TRUE
.head 8 -  !
.head 8 -  ! 7. Αν δηλώνει κάποια κατεύθυνση και η καταχωρημένη κατεύθυνση διαφέρει της δηλωμένης
.head 8 +  If sKatEgr != '00' and ( sKatStf != sKatEgr )
.head 9 -  ! Μήνυμα ότι έχει επιλεγεί διαφορετική κατεύθυνση.
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgKatRoes = sMsgKatRoes7
.head 9 -  Return FALSE
.head 8 -  !
.head 8 -  ! 8. Αν δηλώνει ΜΗ ΟΡΙΣΜΕΝΗ κατεύθυνση και βρίσκεται σε εξάμηνο που πρέπει να δηλώσει κατεύθυνση (ΟΧΙ ΑΡΧΙΤΕΚΤΟΝΕΣ)
.head 8 +  If sKatEgr = '00' 
.head 9 -  ! Μήνυμα ότι πρέπει να επιλεγεί κάποια κατεύθυνση.
.head 9 -  Set bEnableMsg = TRUE
.head 9 -  Set sMsgKatRoes = sMsgKatRoes8
.head 9 -  Return FALSE
.head 8 -  !
.head 6 -  ! Αν δεν έχει τιμή το εξάμηνο
.head 6 +  Else
.head 7 -  ! Μήνυμα ότι η καταχώρηση είναι κενή στον PROYPROG για το έτος εγγραφής του φοιτητή ενημέρωση το πεδίο EgrReply
.head 7 -  Set bEnableMsg = TRUE
.head 7 -  Set sMsgKatRoes = sMsgKatRoes9
.head 7 -  Return FALSE
.head 5 -  ! Αν δεν υπάρχει καταχώρηση στον PROYPROG για το εξάμηνο δηλούμενης κατεύθυνσης στο έτος εγγραφής του φοιτητή ενημέρωση το πεδίο EgrReply
.head 5 +  Else
.head 6 -  !
.head 6 -  ! Μήνυμα ότι δεν υπάρχει καταχώρηση στον PROYPROG για το έτος εγγραφής του φοιτητή ενημέρωση το πεδίο EgrReply
.head 6 -  Set bEnableMsg = TRUE
.head 6 -  Set sMsgKatRoes = sMsgKatRoes10
.head 6 -  Return FALSE
.head 3 +  ! Function: SetToVarRoes
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 -  Actions 
.head 3 +  ! Function: 3FindCourRoh
.head 4 -  Description: Στην περίπτωση (nMode = 1) ελέγχει αν έχει κάνει δήλωση ροών και επιστρέφει TRUE ή FALSE αντίστοιχα.
Στην περίπτωση (nMode = 2) αν έχει κάνει δήλωση ροών, βρίσκει τις ροές που έχει δηλώσει ώστε να χτιστεί
αργότερα ανάλογα το select για τις υποχρεώσεις και τις επιλογές του φοιτητή.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: nMode
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nIndexVertical
.head 5 -  Number: nIndexHorizon
.head 5 -  Number: nFetch
.head 5 -  String: sSelect
.head 5 -  Number: nIndex
.head 5 -  !
.head 5 -  Number: nTimes
.head 4 +  Actions 
.head 5 -  !
.head 5 -  Set sRohFoitEpilog[0] = ''
.head 5 -  Set sRohFoitEpilog[1] = ''
.head 5 -  Set sRohFoitEpilog[2] = ''
.head 5 -  Set sRohFoitEpilog[3] = ''
.head 5 +  If NOT hGetCourse.bConnected
.head 6 -  !
.head 6 -  Call hGetCourse.Connect()
.head 5 -  ! Βάλε στις μεταβλητές (που κάθε μία αντιστοιχεί σε μία ροή) τις επιλογές του φοιτητή ('Ο' για τις ολόκληρες, 'Μ' για τις μισές)
.head 5 -  Set sSelect = 'Select Y,L,H,D,T,S,Z,E,O,I,M,F,KAT into :frmDilosi.Y,:frmDilosi.L,:frmDilosi.H,:frmDilosi.D,:frmDilosi.T,
:frmDilosi.S,:frmDilosi.Z,:frmDilosi.E,:frmDilosi.O,:frmDilosi.I,:frmDilosi.M,:frmDilosi.F,:frmDilosi.sKatRoh from rohfoit
where k_f = :dfK_fDil '
.head 5 -  Call hGetCourse.Initialize(sSelect )
.head 5 -  Call hGetCourse.Prepare()
.head 5 -  Call hGetCourse.Execute()
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set nIndexHorizon = 0
.head 5 -  Call hGetCourse.Next( nFetch )
.head 5 -  ! Αν δεν έχει κάνει δήλωση ροών μηδένισε τις μεταβλητές και επέστρεψε FALSE
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  !
.head 6 -  Set frmDilosi.sRohFoitEpilog[0] = ''
.head 6 -  Set frmDilosi.sRohFoitEpilog[1] = ''
.head 6 -  Set frmDilosi.sRohFoitEpilog[2] = ''
.head 6 -  Set frmDilosi.sRohFoitEpilog[3] = ''
.head 6 -  Set bRohDil = FALSE
.head 6 +  ! If hGetCourse.bConnected
.head 7 -  !
.head 7 -                                               Call hGetCourse.Disconnect()
.head 6 -  Return FALSE
.head 5 -  Set bRohDil = TRUE
.head 5 -  ! Αν ενδιαφέρομαι αν έχει κάνει δήλωση ροών επέστρεψε TRUE. (περίπτωση 1)
.head 5 +  If nMode = 1
.head 6 -  !
.head 6 +  ! If hGetCourse.bConnected
.head 7 -  !
.head 7 -                                               Call hGetCourse.Disconnect()
.head 6 -  Return TRUE
.head 5 -  ! Αλλιώς αν ενδιαφέρομαι να χτίσω το select με τις υποχρεώσεις ή τις επιλογές του φοιτητή (περίπτωση 2)
  βάλε σε μονοδιάστατο πινακάκι αντιστοιχίζοντας με νούμερα (nIndexVertical) τα σύμβολα των ροών
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set sRohFoit[nIndexVertical] = Y
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = L
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = H
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = D
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = T
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = S
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = Z
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = E
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = O
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = I
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = M
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = F
.head 5 -  ! Βρες τους κωδικούς των ροών που είναι δηλωμένες στον OMADALEKT για τους Ηλεκτρολόγους...
.head 5 -  ! COMBO
.head 5 -  Set sSelect = ' select OMADA into :frmDilosi.sColCode from OMADALEKT where K_TM = :nCodeTmima AND AK = :nAkTrexon AND OMADA between 8000 and 8999 '
.head 5 -  ! Set sSelect = ' select plcode into :frmDilosi.sColCode from pltab where plcolumn = \'OMADA3\' and plcode like \'8%\' '
.head 5 -  ! COMBO
.head 5 -  Call hGetCourse.Initialize(sSelect )
.head 5 -  Call hGetCourse.Prepare()
.head 5 -  Call hGetCourse.Execute()
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set nIndexHorizon = 0
.head 5 -  Call hGetCourse.Next( nFetch )
.head 5 -  !
.head 5 -  Set nTimes = 0
.head 5 -  ! Όσο βρίσκει ροές στον OMADALEKT συνέχισε μέσα στο While...
.head 5 +  While nFetch != FETCH_EOF and nTimes <24
.head 6 -  !
.head 6 -  ! Set sPlOmadaRoh[nIndexVertical,nIndexHorizon] = frmDilosi.sColCode
.head 6 -  !
.head 6 -  ! Όσο οι κωδικοί από το select του OMADALEKT αφορούν ολόκληρες ροές
  αύξαινε το nIndexVertical και άσε το nIndexHorizon = 0 του διδιάστατου πίνακα αντιστοιχίζοντας κάθε ζεύγος με μία ομάδα (ροή)
.head 6 +  If nIndexVertical < 11
.head 7 -  !
.head 7 -  Set sPlOmadaRoh[nIndexVertical,nIndexHorizon] = frmDilosi.sColCode
.head 7 -  Set nIndexVertical = nIndexVertical + 1
.head 6 -  ! Όταν φθάσει στις μισές ροές μηδένισε το IndexVertical και θέσε IndexHorizon = 1 αντιστοιχίζοντας κάθε ζεύγος με μία ομάδα (ροή)
.head 6 +  Else 
.head 7 -  !
.head 7 -  Set nIndexVertical = 0
.head 7 -  Set nIndexHorizon = 1
.head 6 -  Call hGetCourse.Next( nFetch )
.head 6 -  !
.head 6 -  Set nTimes = nTimes + 1
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set nIndex = 0
.head 5 -  ! Όσο το nIndexVertical είναι μικρότερο του μέγιστου αριθμού των ροών (ολόκληρων ή μισών) κάνε το While
.head 5 +  While nIndexVertical < 11
.head 6 -  !
.head 6 -  ! Αν ο φοιτητής έχει επιλέξει την συγκεκριμένη ροή μπες στο If
.head 6 +  If sRohFoit[nIndexVertical] > '0'
.head 7 -  !
.head 7 -  ! Αν είναι ολόκληρη δώσε στη μεταβλητή του νέου μονοδιάστατου πίνακα την τιμή του κωδικού της ομάδας (ροής) που έχει επιλέξει ο φοιτητής
 και έχει αντιστοιχηθεί στο διδιάστατο πίνακα με τις ομάδες από τον PLTAB.
.head 7 +  If ( sRohFoit[nIndexVertical]  =  'O' ) or ( sRohFoit[nIndexVertical]  =  'Ο' )
.head 8 -  !
.head 8 -  Set frmDilosi.sRohFoitEpilog[nIndex] = sPlOmadaRoh[nIndexVertical,0]
.head 7 -  ! Αν είναι μισή δώσε στη μεταβλητή του νέου μονοδιάστατου πίνακα την τιμή του κωδικού της ομάδας (ροής) που έχει επιλέξει ο φοιτητής
 και έχει αντιστοιχηθεί στο διδιάστατο πίνακα με τις ομάδες από τον PLTAB.
.head 7 +  Else 
.head 8 -  !
.head 8 -  Set frmDilosi.sRohFoitEpilog[nIndex] = sPlOmadaRoh[nIndexVertical,1]
.head 7 -  Set nIndex = nIndex + 1
.head 6 -  ! Έτσι και αλλιώς πήγαινε στην επόμενη ροή και συνέχισε τον έλεγχο ξαναμπαίνοντας στο If
.head 6 -  Set nIndexVertical = nIndexVertical + 1
.head 5 +  ! If hGetCourse.bConnected
.head 6 -  !
.head 6 -                                               Call hGetCourse.Disconnect()
.head 5 -  Return TRUE
.head 3 +  ! Function: 3ChkOkRoes3
.head 4 -  Description: Ελέγχει αν έχει δηλωθεί ο προβλεπόμενος αριθμός ροών δηλ. 3 ολοκληρες ή 2 ολόκληρες + 2 μισές
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nColsID
.head 5 -  Number: nWholeRoh
.head 5 -  Number: nHalfRoh
.head 5 -  Number: nSynRoes[*]
.head 5 -  String: sColText
.head 5 -  Boolean: bFalseRoh
.head 4 +  Actions 
.head 5 -  Set nColsID = 2
.head 5 -  Set nWholeRoh = 0
.head 5 -  Set nHalfRoh = 0
.head 5 +  While nColsID <=13
.head 6 -  Call SalTblGetColumnText ( tblRohFoit, nColsID, sColText )
.head 6 +  If sColText != STRING_Null
.head 7 +  If sColText = 'O' OR sColText = 'Ο'
.head 8 -  Set nWholeRoh = nWholeRoh + 1
.head 7 +  Else If sColText = 'M' OR sColText = 'Μ'
.head 8 -  Set nHalfRoh = nHalfRoh + 1
.head 7 +  Else 
.head 8 -  Set bFalseRoh = TRUE
.head 6 -  Set nColsID = nColsID + 1
.head 5 -  Set nSynRoes[0] = nWholeRoh
.head 5 -  Set nSynRoes[1] = nHalfRoh
.head 5 +  If ( ( nSynRoes[0] = 3 and nSynRoes[1] = 0 ) OR ( nSynRoes[0] = 2 and nSynRoes[1] = 2 ) ) and NOT bFalseRoh
.head 6 -  Return TRUE
.head 5 +  Else 
.head 6 -  Set bFalseRoh = FALSE
.head 6 -  Return FALSE
.head 3 +  ! Function: 3InsertDilRohFoit3
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set sSelect = ' select OMADA into :sOmadaRoh3 from OMADALEKT where K_TM = :nCodeTmima AND AK = :nAkTrexon AND OMADA between 8000 and 8999 '
.head 5 +  If sOmadaRoh3 = '80%'
.head 6 -  Set sTypeRoh = 'O'
.head 5 +  Else If sOmadaRoh3 = '81%'
.head 6 -  Set sTypeRoh = 'M'
.head 3 +  ! Function: _Hlektr_YpoxrFoit3
.head 4 -  Description: Function Υπεύθυνη για την χρέωση υποχρεώσεων
(υποχρεωτικών ονομαστικά ,επιλογών αριθμητικά) στον φοιτητή
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sParEj
.head 5 -  Number: nParAk
.head 5 -  String: sParXu
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nFetch1
.head 5 -  Number: nFetch
.head 5 -  String: sSelect
.head 5 -  String: sFunXu
.head 4 +  Actions 
.head 5 -  Set sEjSelDil = sParEj
.head 5 -  Set nAkSelDil = nParAk
.head 5 -  Set sFunXu = sParXu
.head 5 -  ! υποχρεωτικά
.head 5 +  If NOT hGetXr.bConnected
.head 6 -  !
.head 6 -  Call hGetXr.Connect()
.head 5 -  Call hGetXr.Initialize(' SELECT k_m
                                          INTO :nK_mCour
                                          FROM oblistud
                                          WHERE k_f = :dfStf  AND
                                                         ej = :sEjSelDil AND
                                                         k_tm = :nCodeTmima ' )
.head 5 -  Call hGetXr.Prepare()
.head 5 -  Call hGetXr.Execute()
.head 5 -  Call hGetXr.Next( nFetch )
.head 5 -  ! Αν  δεν έχει  χρεωθεί υποχρεώσεις
.head 5 -  ! !!!!!!!!!!!!!!!
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  Call FindCourRoh( 2 )
.head 6 +  If NOT hGetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Connect()
.head 6 -  Set nFetch1 = 0
.head 6 -  ! Set nTest = SalStrToNumber( colEgrafiEjCode )
.head 6 -  ! tbl_yp
.head 6 -  !
.head 6 -  Call _Hlektr_GetYpcourse3()
.head 6 -  !
.head 6 +  If NOT hSetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hSetCourseEgr.Connect()
.head 6 -  Call hSetCourseEgr.Initialize(' INSERT INTO oblistud
                                                        (k_f , k_tm , ej ,k_m,ak, omada)
                                         VALUES ( :dfStf , :nCodeTmima , :sEjSelDil, :nK_mCour, :nAkSelDil, :sYpxOmada)')
.head 6 -  Call hSetCourseEgr.Prepare()
.head 6 -  !
.head 6 -  Call SqlFetchNext (hGetYpcourse3, nFetch1)
.head 6 -  !
.head 6 +  While nFetch1 != FETCH_EOF
.head 7 -  Call hSetCourseEgr.Execute()
.head 7 -  ! !!!!!!!!!!!!r!!!!!!!!!!!
.head 7 -  ! Βρίσκει αν είναι ήδη δηλωμένο το μάθημα
.head 7 +  ! If NOT SqlImmediate (' Select count(k_m) into :nKmExistEgr from Kartella where k_f = :frmEgrafi.dfStf and k_m = :frmEgrafi.nK_mCour and k_tm = :nCodeTmima
		     AND AK =  :frmEgrafi.nAkSelDil ')
.head 8 -  Return FALSE
.head 7 -  ! If nKmExistEgr != NUMBER_Null and nKmExistEgr > 0
.head 7 +  ! Else
.head 8 -  ! Δήλωση των υποχρεωτικών μαθημάτων στην Καρτέλλα για τους Ηλεκτρολόγους!
.head 8 +  If NOT SqlConnect( hSqlInsKartellaEgr )
.head 9 -  !
.head 9 -  Call SqlConnect( hSqlInsKartellaEgr )
.head 8 +  If NOT SqlPrepare ( hSqlInsKartellaEgr, " INSERT INTO Kartella (  K_TM , K_F , EJ , K_M , TYPOS , GRADENOR , OMADA , YPEROMA , AK , GRADEPAN,
		                                                    XU, PERIOD, VELTIOSI, EPEP,  EJANIKI, GRADEXARI )
		             VALUES (:nCodeTmima, :frmEgrafi.dfStf , :frmEgrafi.sEjSelDil , :frmEgrafi.nK_mCour , 'YO', null, :frmEgrafi.sYpxOmada, null,
			              :frmEgrafi.nAkSelDil, null,  :sFunXu , null , '2', '2',  :frmEgrafi.sEjSelDil, null )  ")
.head 9 -  !
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute ( hSqlInsKartellaEgr )
.head 9 -  !
.head 9 -  Return FALSE
.head 7 -  ! !!!!!!!!!!!r!!!!!!!!!!!!!
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Next( nFetch1 )
.head 6 -  !
.head 6 +  If hGetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Disconnect()
.head 6 +  If hSetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hSetCourseEgr.Disconnect()
.head 5 +  If hGetXr.bConnected
.head 6 -  !
.head 6 -  Call hGetXr.Disconnect()
.head 5 -  Return TRUE
.head 3 +  ! Function: 3YpokeitaiSeRoes
.head 4 -  Description: Προσωρινή μέχρι να προστεθεί το πεδίο BROES στον ST_F που θα ελέγχει αν ανήκει σε καθεστώς ροών ή όχι, όταν δεν έχει εγγραφές στον ROHFOIT
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sEJEgr1993
.head 4 +  Actions 
.head 5 +  If nCodeTmima = 3
.head 6 -  Call SqlImmediate ( 'SELECT EJ FROM EGRAFI INTO :sEJEgr1993 WHERE K_F = :dfStf and XU = 1 and AK = 1993 ')
.head 6 -  Call SqlClearImmediate()
.head 6 +  If sEJEgr1993 != STRING_Null
.head 7 +  If SalStrMidX(dfStf,2,2) = '92'  and sEJEgr1993 = '01' OR SalStrMidX(dfStf,2,2) = '93'  and sEJEgr1993 <= '03' OR SalStrMidX(dfStf,2,2) = '94'  and sEJEgr1993 <= '05'
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 6 +  Else 
.head 7 -  Return TRUE
.head 5 +  Else 
.head 6 -  Return FALSE
.head 3 +  Function: Hlektr_FindCourRoh
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sRohFoit[*]
.head 5 -  String: sOmadaRoh[12,12]
.head 5 -  Number: nIndexVertical
.head 5 -  Number: nIndexHorizon
.head 5 -  Number: nFetch
.head 5 -  Number: nFetch1
.head 5 -  Number: nIndex
.head 5 -  !
.head 5 -  Number: nTimes
.head 4 +  Actions
.head 5 -  ! Μηδενισμός Arrays
.head 5 -  Set nRoesFoit = 0
.head 5 -  Set nIndex = 0
.head 5 +  While sRohCodeFoit[nIndex] != STRING_Null
.head 6 -  Set sRohCodeFoit[nIndex] = STRING_Null
.head 6 -  Set nIndex = nIndex + 1
.head 5 -  Set nIndex = 0
.head 5 +  While sRohFoit[nIndex] != STRING_Null
.head 6 -  Set sRohFoit[nIndex] = STRING_Null
.head 6 -  Set nIndex = nIndex + 1
.head 5 -  !
.head 5 -  Set sRohFoitEpilog[0] = ''
.head 5 -  Set sRohFoitEpilog[1] = ''
.head 5 -  Set sRohFoitEpilog[2] = ''
.head 5 -  Set sRohFoitEpilog[3] = ''
.head 5 -  Set nIndex = 0
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set nIndexHorizon = 0
.head 5 -  ! !
.head 5 -  ! Set sSqlCom_ChkRoesFoit3	      =  	' SELECT KAT, Y, L, H, D, T, S, Z, E, O, I, F, M
                                  		FROM ROHFOIT                                  		
                                  		WHERE K_F = :1 '
.head 5 -  ! !
.head 5 +  If NOT SqlRetrieve (hChkRoesFoit3, 'WEB_CHKROES_FOIT3',  sBind_ChkRoesFoit3, sInto_ChkRoesFoit3)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlExecute(hChkRoesFoit3)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hChkRoesFoit3, nFetch)
.head 6 -  ! Return FALSE
.head 5 -  !
.head 5 -  ! Αν δεν έχει ακόμη δηλωμένες ροές στον rohfoit μηδένισε τις μεταβλητές και επέστρεψε FALSE
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  !
.head 6 -  Set sRohFoitEpilog[0] = ''
.head 6 -  Set sRohFoitEpilog[1] = ''
.head 6 -  Set sRohFoitEpilog[2] = ''
.head 6 -  Set sRohFoitEpilog[3] = ''
.head 6 -  Set bRohDil = FALSE
.head 6 +  ! If hGetCourse.bConnected
.head 7 -  !
.head 7 -                                               Call hGetCourse.Disconnect()
.head 6 -  Return FALSE
.head 5 -  Set bRohDil = TRUE
.head 5 -  ! Αν ενδιαφέρομαι αν έχει κάνει δήλωση ροών επέστρεψε TRUE. (περίπτωση 1)
.head 5 +  If nMode = 1
.head 6 -  !
.head 6 +  ! If hGetCourse.bConnected
.head 7 -  !
.head 7 -                                               Call hGetCourse.Disconnect()
.head 6 -  Return TRUE
.head 5 -  ! Αλλιώς αν ενδιαφέρομαι να χτίσω το select με τις υποχρεώσεις ή τις επιλογές του φοιτητή (περίπτωση 2)
  βάλε σε μονοδιάστατο πινακάκι αντιστοιχίζοντας με νούμερα (nIndexVertical) τα σύμβολα των ροών
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set sRohFoit[nIndexVertical] = sY
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sL
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sH
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sD
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sT
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sS
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sZ
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sE
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sO
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sI
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sF
.head 5 -  Set nIndexVertical = nIndexVertical + 1
.head 5 -  Set sRohFoit[nIndexVertical] = sM
.head 5 -  !
.head 5 -  ! Set sRohFoit[nIndexVertical] = sM
.head 5 -  ! Set nIndexVertical = nIndexVertical + 1
.head 5 -  ! Set sRohFoit[nIndexVertical] = sF
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  ! Βρες τους κωδικούς των ροών που είναι δηλωμένες στον OMADALEKT για τους Ηλεκτρολόγους...
.head 5 -  !
.head 5 +  If NOT SqlRetrieve (hOmadalekt3, 'WEB_OMADALEKT3',  sBind_Omadalekt3, sInto_Omadalekt3)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlExecute(hOmadalekt3)
.head 6 -  Return FALSE
.head 5 +  If NOT SqlFetchNext (hOmadalekt3, nFetch1)
.head 6 -  ! Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  Set nTimes = 0
.head 5 -  Set nIndexVertical = 0
.head 5 -  ! Όσο βρίσκει ροές στον OMADALEKT συνέχισε μέσα στο While...
.head 5 +  While nFetch1 != FETCH_EOF and nTimes <24
.head 6 -  !
.head 6 +  If nIndexVertical < 12
.head 7 -  !
.head 7 -  Set sOmadaRoh[nIndexVertical,nIndexHorizon] = sRohOmadalekt
.head 7 -  Set nIndexVertical = nIndexVertical + 1
.head 6 -  ! Όταν φθάσει στις μισές ροές μηδένισε το IndexVertical και θέσε IndexHorizon = 1 αντιστοιχίζοντας κάθε ζεύγος με μία ομάδα (ροή)
.head 6 +  Else
.head 7 -  !
.head 7 -  Set nIndexVertical = 0
.head 7 -  Set nIndexHorizon = 1
.head 7 -  Set sOmadaRoh[nIndexVertical,nIndexHorizon] = sRohOmadalekt
.head 7 -  Set nIndexVertical = nIndexVertical + 1
.head 6 +  If NOT SqlFetchNext (hOmadalekt3, nFetch1)
.head 7 -  ! Return FALSE
.head 6 -  !
.head 6 -  Set nTimes = nTimes + 1
.head 5 -  Set nIndexVertical = 0
.head 5 -  Set nIndex = 0
.head 5 -  ! Όσο το nIndexVertical είναι μικρότερο του μέγιστου αριθμού των ροών (ολόκληρων ή μισών) κάνε το While
.head 5 +  While nIndexVertical < 12
.head 6 -  !
.head 6 -  ! Αν ο φοιτητής έχει επιλέξει την συγκεκριμένη ροή μπες στο If
.head 6 +  If sRohFoit[nIndexVertical] > '0'
.head 7 -  !
.head 7 -  ! Αν είναι ολόκληρη δώσε στη μεταβλητή του νέου μονοδιάστατου πίνακα την τιμή του κωδικού της ομάδας (ροής) που έχει επιλέξει ο φοιτητής
 και έχει αντιστοιχηθεί στο διδιάστατο πίνακα με τις ομάδες από τον OMADALEKT.
.head 7 +  If ( sRohFoit[nIndexVertical]  =  'O' ) or ( sRohFoit[nIndexVertical]  =  'Ο' )
.head 8 -  !
.head 8 -  Set sRohFoitEpilog[nIndex] = sOmadaRoh[nIndexVertical,0]
.head 8 -  Set sRohCodeFoit[nIndex] = sRohFoitEpilog[nIndex]
.head 7 -  ! Αν είναι μισή δώσε στη μεταβλητή του νέου μονοδιάστατου πίνακα την τιμή του κωδικού της ομάδας (ροής) που έχει επιλέξει ο φοιτητής
 και έχει αντιστοιχηθεί στο διδιάστατο πίνακα με τις ομάδες από τον OMADALEKT.
.head 7 +  Else
.head 8 -  !
.head 8 -  Set sRohFoitEpilog[nIndex] = sOmadaRoh[nIndexVertical,1]
.head 8 -  Set sRohCodeFoit[nIndex] = sRohFoitEpilog[nIndex]
.head 7 -  Set nIndex = nIndex + 1
.head 7 -  Set nRoesFoit = nIndex
.head 6 -  ! Έτσι και αλλιώς πήγαινε στην επόμενη ροή και συνέχισε τον έλεγχο ξαναμπαίνοντας στο If
.head 6 -  Set nIndexVertical = nIndexVertical + 1
.head 3 +  ! Function: 3YpoxrFoit3
.head 4 -  Description: Function Υπεύθυνη για την χρέωση υποχρεώσεων
(υποχρεωτικών ονομαστικά ,επιλογών αριθμητικά) στον φοιτητή
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sParEj
.head 5 -  Number: nParAk
.head 5 -  String: sParXu
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nFetch1
.head 5 -  Number: nFetch
.head 5 -  String: sSelect
.head 5 -  String: sFunXu
.head 4 +  Actions 
.head 5 -  Set frmEgrafi.sEjSelDil = sParEj
.head 5 -  Set frmEgrafi.nAkSelDil = nParAk
.head 5 -  Set sFunXu = sParXu
.head 5 -  ! υποχρεωτικά
.head 5 +  If NOT hGetXr.bConnected
.head 6 -  !
.head 6 -  Call hGetXr.Connect()
.head 5 -  Call hGetXr.Initialize(' SELECT k_m
                                          INTO :frmEgrafi.nK_mCour
                                          FROM oblistud
                                          WHERE k_f = :frmEgrafi.dfStf  AND
                                                         ej = :frmEgrafi.sEjSelDil AND
                                                         k_tm = :nCodeTmima ' )
.head 5 -  Call hGetXr.Prepare()
.head 5 -  Call hGetXr.Execute()
.head 5 -  Call hGetXr.Next( nFetch )
.head 5 -  ! Αν  δεν έχει  χρεωθεί υποχρεώσεις
.head 5 -  ! !!!!!!!!!!!!!!!
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  Call FindCourRoh( 2 )
.head 6 +  If NOT hGetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Connect()
.head 6 -  Set nFetch1 = 0
.head 6 -  ! Set nTest = SalStrToNumber( colEgrafiEjCode )
.head 6 -  ! tbl_yp
.head 6 -  Set sSelect = ' SELECT ypcourse.k_m, omada
                        FROM  YPCOURSE
                         INTO :frmEgrafi.nK_mCour , :frmEgrafi.sYpxOmada
                         WHERE  ypcourse.ej = :frmEgrafi.sEjSelDil  AND
                                         ypcourse.kat =' || '\'05\'  AND
                                         ypcourse.ak = :frmEgrafi.nAkSelDil  AND
                                         ypcourse.k_tm = :nCodeTmima  AND  '
.head 6 +  If frmEgrafi.sRohFoitEpilog[3]  = ''
.head 7 -  !
.head 7 -  Set sSelect = sSelect || ' ( omada =  :frmEgrafi.sRohFoitEpilog[0]  or omada = :frmEgrafi.sRohFoitEpilog[1]  or omada = :frmEgrafi.sRohFoitEpilog[2]  ) '
.head 6 +  Else 
.head 7 -  !
.head 7 -  Set sSelect = sSelect || ' ( omada = :frmEgrafi.sRohFoitEpilog[0]  or omada =:frmEgrafi.sRohFoitEpilog[1]  or omada = :frmEgrafi.sRohFoitEpilog[2] or omada =:frmEgrafi.sRohFoitEpilog[3]  ) '
.head 6 -  Call hGetCourseEgr.Initialize(sSelect)
.head 6 -  Call hGetCourseEgr.Prepare()
.head 6 -  Call hGetCourseEgr.Execute()
.head 6 +  If NOT hSetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hSetCourseEgr.Connect()
.head 6 -  Call hSetCourseEgr.Initialize(' INSERT INTO oblistud
                                                        (k_f , k_tm , ej ,k_m,ak, omada)
                                         VALUES ( :frmEgrafi.dfStf , :nCodeTmima , :frmEgrafi.sEjSelDil, :frmEgrafi.nK_mCour, :frmEgrafi.nAkSelDil, :frmEgrafi.sYpxOmada)')
.head 6 -  Call hSetCourseEgr.Prepare()
.head 6 -  Call hGetCourseEgr.Next( nFetch1 )
.head 6 +  While nFetch1 != FETCH_EOF
.head 7 -  Call hSetCourseEgr.Execute()
.head 7 -  ! !!!!!!!!!!!!r!!!!!!!!!!!
.head 7 -  ! Βρίσκει αν είναι ήδη δηλωμένο το μάθημα
.head 7 +  If NOT SqlImmediate (' Select count(k_m) into :nKmExistEgr from Kartella where k_f = :frmEgrafi.dfStf and k_m = :frmEgrafi.nK_mCour and k_tm = :nCodeTmima
		     AND AK =  :frmEgrafi.nAkSelDil ')
.head 8 -  Return FALSE
.head 7 -  If nKmExistEgr != NUMBER_Null and nKmExistEgr > 0
.head 7 +  Else 
.head 8 -  ! Δήλωση των υποχρεωτικών μαθημάτων στην Καρτέλλα για τους Ηλεκτρολόγους!
.head 8 +  If NOT SqlConnect( hSqlInsKartellaEgr )
.head 9 -  !
.head 9 -  Call SqlConnect( hSqlInsKartellaEgr )
.head 8 +  If NOT SqlPrepare ( hSqlInsKartellaEgr, " INSERT INTO Kartella (  K_TM , K_F , EJ , K_M , TYPOS , GRADENOR , OMADA , YPEROMA , AK , GRADEPAN,
		                                                    XU, PERIOD, VELTIOSI, EPEP,  EJANIKI, GRADEXARI )
		             VALUES (:nCodeTmima, :frmEgrafi.dfStf , :frmEgrafi.sEjSelDil , :frmEgrafi.nK_mCour , 'YO', null, :frmEgrafi.sYpxOmada, null,
			              :frmEgrafi.nAkSelDil, null,  :sFunXu , null , '2', '2',  :frmEgrafi.sEjSelDil, null )  ")
.head 9 -  !
.head 9 -  Return FALSE
.head 8 +  If NOT SqlExecute ( hSqlInsKartellaEgr )
.head 9 -  !
.head 9 -  Return FALSE
.head 7 -  ! !!!!!!!!!!!r!!!!!!!!!!!!!
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Next( nFetch1 )
.head 6 -  !
.head 6 +  If hGetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hGetCourseEgr.Disconnect()
.head 6 +  If hSetCourseEgr.bConnected
.head 7 -  !
.head 7 -  Call hSetCourseEgr.Disconnect()
.head 5 +  If hGetXr.bConnected
.head 6 -  !
.head 6 -  Call hGetXr.Disconnect()
.head 5 -  Return TRUE
.head 3 +  ! Function: ChkRoes
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sKFPar
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nDilomRoes
.head 4 +  Actions 
.head 5 -  Call SqlImmediate (' select count(*) from ROHFOIT where k_f = :sKFPar INTO :nDilomRoes ' )
.head 5 -  ! Call SqlImmediate (' select count(*) from ROHFOIT where k_f = :dfK_fDil INTO :nDilomRoes ' )
.head 5 -  Call SqlClearImmediate()
.head 5 +  If nDilomRoes > 0
.head 6 -  Return TRUE
.head 5 +  Else 
.head 6 -  Return FALSE
.head 3 +  Function: Hlek_GetYpcourse
.head 4 -  Description: Βρίσκει τις υποχρεώσεις για εξάμηνο ροών των Ηλεκτρολόγων
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sRohF[*]
.head 5 -  Receive Number: nFetch
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Number: nFetch
.head 4 +  Actions
.head 5 -  !
.head 5 -  !
.head 5 -  ! ! 	!INTO
.head 5 -  Set sInto_Hlek_GetYpcourse 		= 	' :nK_mEgr, :sOmadaEgr '
.head 5 -  !
.head 5 -  ! ! 	!BIND
.head 5 +  If sRohF[3]  = ''
.head 6 -  Set sBind_Hlek_GetYpcourse 		= 	' :sEjEgr, :nAkEgr, :nCodeTmima, :sRohF[0] , :sRohF[1], :sRohF[2] '
.head 5 +  Else
.head 6 -  Set sBind_Hlek_GetYpcourse 		= 	' :sEjEgr, :nAkEgr, :nCodeTmima, :sRohF[0] , :sRohF[1], :sRohF[2], :sRohF[3] '
.head 5 -  !
.head 5 -  ! ! 	!COMMAND
.head 5 -  Set sSqlCom_Hlek_GetYpcourse= 	' SELECT ypcourse.k_m, omada
                        			FROM  YPCOURSE                        			 
                         			WHERE  ypcourse.ej = :1  AND
                                        			ypcourse.kat =' || '\'05\'  AND
                                         			ypcourse.ak = :2  AND
                                         			ypcourse.k_tm = :3  AND '
.head 5 -  !
.head 5 +  If sRohF[3]  = ''
.head 6 -  !
.head 6 -  Set sSqlCom_Hlek_GetYpcourse = sSqlCom_Hlek_GetYpcourse || ' ( omada =  :4  or omada = :5  or omada = :6  ) '
.head 5 +  Else
.head 6 -  !
.head 6 -  Set sSqlCom_Hlek_GetYpcourse = sSqlCom_Hlek_GetYpcourse || ' ( omada = :4 or omada =:5  or omada = :6 or omada =:7  ) '
.head 5 -  !
.head 5 -  ! !	!STORE
.head 5 +  If NOT SqlStore(hHlek_GetYpcourse, 'WEB_HLEK_GETYX', sSqlCom_Hlek_GetYpcourse )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! !	!RETRIEVE
.head 5 +  If NOT SqlRetrieve (hHlek_GetYpcourse, 'WEB_HLEK_GETYX',  sBind_Hlek_GetYpcourse, sInto_Hlek_GetYpcourse )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! !	! EXECUTE
.head 5 +  If NOT SqlExecute(hHlek_GetYpcourse)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  !
.head 5 -  ! !	! FETCH
.head 5 +  If SqlFetchNext (hHlek_GetYpcourse, nFetch)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return TRUE
.head 3 +  Function: Hlektr_GetSymbolRoh
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sRoesDilEgr[*]
.head 5 -  Receive String: sRoh[*]
.head 5 -  Receive String: sRohType[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sRoesSymbolEgr
.head 5 -  ! String: sR1
.head 5 -  ! String: sR2
.head 5 -  ! String: sR3
.head 5 -  ! String: sR4
.head 5 -  Number: nR
.head 5 -  Number: nFetch
.head 5 -  Number: n
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! Μηδενισμός Arrays
.head 5 -  Set n = 0
.head 5 +  While sRoh[n] != STRING_Null
.head 6 -  Set sRoh[n] = STRING_Null
.head 6 -  Set n = n + 1
.head 5 -  Set n = 0
.head 5 +  While sRohType[n] != STRING_Null
.head 6 -  Set sRohType[n] = STRING_Null
.head 6 -  Set n = n + 1
.head 5 -  ! While sRoesDilEgr != STRING_Null
.head 5 -  !
.head 5 -  ! ! 	!INTO
.head 5 -  Set sInto_Hlek_GetSymbolRoh 		= 	' :sRoesSymbolEgr '
.head 5 -  !
.head 5 -  ! ! 	!BIND
.head 5 -  Set sBind_Hlek_GetSymbolRoh 		= 	' :nCodeTmima, :nAkEgr,  :sRoesDilEgr[0], :sRoesDilEgr[1], :sRoesDilEgr[2], :sRoesDilEgr[3] '
.head 5 -  !
.head 5 -  ! ! 	!COMMAND
.head 5 -  Set sSqlCom_Hlek_GetSymbolRoh	= 	' SELECT OMADALEKT
                        			FROM  OMADALEKT                        			 
                         			WHERE  OMADALEKT.AK = :2 AND
					OMADALEKT.K_TM = :1 AND
					OMADALEKT.OMADA IN ( :3, :4, :5, :6) '
                                        			
.head 5 -  ! !	!STORE
.head 5 -  Call SqlStore(hHlek_GetSymbolRoh, 'WEB_HLEK_GETSROH', sSqlCom_Hlek_GetSymbolRoh )
.head 5 -  !
.head 5 -  ! !	!RETRIEVE
.head 5 -  Call SqlRetrieve (hHlek_GetSymbolRoh, 'WEB_HLEK_GETSROH',  sBind_Hlek_GetSymbolRoh, sInto_Hlek_GetSymbolRoh )
.head 5 -  !
.head 5 -  ! !	! EXECUTE
.head 5 -  Call SqlExecute(hHlek_GetSymbolRoh)
.head 5 -  !
.head 5 -  ! !	! FETCH
.head 5 +  If NOT SqlFetchNext (hHlek_GetSymbolRoh, nFetch)
.head 6 -  Return FALSE
.head 5 +  While nFetch != FETCH_EOF
.head 6 -  Set sRoh[nR] = SalStrMidX(sRoesSymbolEgr,0,1)
.head 6 +  If SalStrMidX(sRoesSymbolEgr,1,1) = STRING_Null
.head 7 -  Set sRohType[nR] = 'O'
.head 6 +  Else
.head 7 +  If SalStrMidX(sRoesSymbolEgr,1,1) = 'Μ' or SalStrMidX(sRoesSymbolEgr,1,1) = 'M' 
.head 8 -  Set sRohType[nR] = 'M'
.head 6 +  If NOT SqlFetchNext (hHlek_GetSymbolRoh, nFetch)
.head 7 -  ! Return FALSE
.head 6 -  Set nR = nR + 1
.head 5 +  If nFetch = FETCH_EOF
.head 6 -  Return TRUE
.head 3 +  Function: Hlek_InsRohFoit
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sAAPar
.head 5 -  String: sRoh[*]
.head 5 -  String: sRohType[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nR
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! Μηδενισμός μεταβλητών
.head 5 -  Set sY = STRING_Null
.head 5 -  Set sL = STRING_Null
.head 5 -  Set sH = STRING_Null
.head 5 -  Set sD = STRING_Null
.head 5 -  Set sT = STRING_Null
.head 5 -  Set sS = STRING_Null
.head 5 -  Set sZ = STRING_Null
.head 5 -  Set sE = STRING_Null
.head 5 -  Set sO = STRING_Null
.head 5 -  Set sI = STRING_Null
.head 5 -  Set sM = STRING_Null
.head 5 -  Set sF = STRING_Null
.head 5 -  Set nR = 0
.head 5 -  !
.head 5 +  While sRoh[nR] != STRING_Null
.head 6 +  If sRoh[nR] = 'Υ'
.head 7 -  Set sY = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Λ'
.head 7 -  Set sL = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Η'
.head 7 -  Set sH = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Δ'
.head 7 -  Set sD = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Τ'
.head 7 -  Set sT = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Σ'
.head 7 -  Set sS = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Ζ'
.head 7 -  Set sZ = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Ε'
.head 7 -  Set sE = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Ο'
.head 7 -  Set sO = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Ι'
.head 7 -  Set sI = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Μ'
.head 7 -  Set sM = sRohType[nR]
.head 6 +  Else If sRoh[nR] = 'Φ'
.head 7 -  Set sF = sRohType[nR]
.head 6 -  Set nR = nR + 1
.head 5 -  !
.head 5 -  ! DOKIMH
.head 5 -  Set sAARoh = sAAPar
.head 5 -  !
.head 5 -  ! ! 	!BIND
.head 5 -  Set sBindHlek_InsRohFoit	= ' :sK_F, :sKatEgr, :sAARoh, :sY, :sL, :sH, :sD, :sT, :sS, :sZ, :sE, :sO, :sI, :sM, :sF '
.head 5 -  !
.head 5 -  ! ! 	!COMMAND
.head 5 -  Set sSqlComHlek_InsRohFoit	      =  	' INSERT INTO ROHFOIT
				( K_F, KAT, AA, Y, L, H, D, T, S, Z, E, O, I, M, F )
                                  		VALUES ( :1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15 ) '                               		
                                  		
.head 5 -  ! !	!STORE
.head 5 +  If NOT SqlStore(hHlek_InsRohFoit, 'WEBHlek_InsRohFoit', sSqlComHlek_InsRohFoit )
.head 6 -  Return FALSE
.head 5 -  ! Call SqlCommit(hInsRohfoit3)
.head 5 -  !
.head 5 -  ! !	!RETRIEVE
.head 5 +  If NOT SqlRetrieve (hHlek_InsRohFoit, 'WEBHlek_InsRohFoit',  sBindHlek_InsRohFoit, '' )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! !	! EXECUTE
.head 5 +  If NOT SqlExecute(hHlek_InsRohFoit)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 5 -  ! !	! FETCH
.head 5 +  ! If SqlFetchNext (hInsRohfoit3, nFetch)
.head 6 -  Return TRUE
.head 5 +  ! Else
.head 6 -  Return FALSE
.head 3 +  Function: Hlek_UpdtAlterRoh
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! ! 	!BIND
.head 5 -  Set sBind_Hlek_UpdtAlterRoh	= ' :sK_F '
.head 5 -  !
.head 5 -  ! ! 	!COMMAND
.head 5 -  Set sSqlCom_Hlek_UpdtAlterRoh	      =  	' UPDATE ST_F
				 SET ALTEROH = 0
                                  		 WHERE K_F = :1 '                               		
                                  		
.head 5 -  ! !	!STORE
.head 5 +  If NOT SqlStore(hHlek_UpdtAlterRoh, 'WEB_HLEK_ALTEROH', sSqlCom_Hlek_UpdtAlterRoh )
.head 6 -  Return FALSE
.head 5 -  ! Call SqlCommit(hInsRohfoit3)
.head 5 -  !
.head 5 -  ! !	!RETRIEVE
.head 5 +  If NOT SqlRetrieve (hHlek_UpdtAlterRoh, 'WEB_HLEK_ALTEROH',  sBind_Hlek_UpdtAlterRoh, '' )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  ! !	! EXECUTE
.head 5 +  If NOT SqlExecute(hHlek_UpdtAlterRoh)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  ! Function: SameRoes
.head 4 -  Description: Βρίσκει αν οι ροές που υπάρχουν στον webait_egr είναι ίδιες με τις ροές που είναι καταχωρημένες στον rohfoit.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sRFoit[*]
.head 5 -  String: sREgr[*]
.head 5 -  Number: nRFoit
.head 5 -  Number: nREgr
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRF
.head 5 -  Number: nRE
.head 4 +  Actions 
.head 5 -  Set nRF = 0
.head 5 -  Set nRE = 0
.head 5 +  If nRFoit = nREgr
.head 6 +  While nRF < nRFoit
.head 7 +  If sRFoit[nRF] != sREgr[nRE]
.head 8 -  Set nRF = nRF + 1
.head 7 +  Else 
.head 8 -  Set nRF = 0
.head 8 -  Set nRE = nRE + 1
.head 6 +  If nRF >= nRFoit
.head 7 -  Return FALSE
.head 6 -  Return TRUE
.head 5 +  Else 
.head 6 -  Return FALSE
.head 3 +  ! Function: SameRoes2
.head 4 -  Description: Βρίσκει αν οι ροές που υπάρχουν στον webait_egr είναι ίδιες με τις ροές που είναι καταχωρημένες στον rohfoit.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  String: sRFoit[*]
.head 5 -  String: sREgr[*]
.head 5 -  Number: nRFoit
.head 5 -  Number: nREgr
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRF
.head 5 -  Number: nRE
.head 4 +  Actions 
.head 5 -  Set nRF = 0
.head 5 -  Set nRE = 0
.head 5 +  If nRFoit = nREgr
.head 6 +  While nRE < nREgr
.head 7 +  While nRF < nRFoit
.head 8 +  If sRFoit[nRF] != sREgr[nRE]
.head 9 -  Set nRF = nRF + 1
.head 8 +  Else 
.head 9 -  Set nRF = 0
.head 9 -  Set nRE = nRE + 1
.head 7 +  If nRF > nRFoit
.head 8 -  Return FALSE
.head 6 +  If nRE >= nREgr
.head 7 -  Return TRUE
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Return FALSE
.head 3 +  Function: SameRoes
.head 4 -  Description: Βρίσκει αν οι ροές που υπάρχουν στον webait_egr είναι ίδιες με τις ροές που είναι καταχωρημένες στον rohfoit.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sRFoit[*]
.head 5 -  String: sREgr[*]
.head 5 -  Number: nRFoit
.head 5 -  Number: nREgr
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: m
.head 5 -  Boolean: bEqual
.head 4 +  Actions
.head 5 -  Set i = 0
.head 5 -  Set m = 0
.head 5 +  If nRFoit = nREgr
.head 6 +  While i < nRFoit
.head 7 -  Set bEqual = FALSE
.head 7 -  Set m = 0
.head 7 +  While m < nRFoit and NOT bEqual
.head 8 +  If sRFoit[i] = sREgr[m]
.head 9 -  Set bEqual = TRUE
.head 9 -  Set i = i + 1
.head 8 +  Else
.head 9 -  Set m = m + 1
.head 7 +  If NOT bEqual
.head 8 -  Return FALSE
.head 6 -  Return bEqual
.head 6 -  !
.head 3 +  ! Function: Hlektr_FindAA_Roes
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  If sKat = '01'
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! clsSqlHandleSelect: hInsEgr
.head 3 -  ! clsSqlHandleSelect: hInsObl
.head 3 -  ! clsSqlHandleSelect: hInsEpilo
.head 3 -  ! clsSqlHandleSelect: hSqlInsKartEgr
.head 3 -  ! clsSqlHandleSelect: hTrex
.head 3 -  ! Boolean: bFirstTime
.head 3 -  ! Boolean: bMore
.head 3 -  ! Boolean: bTrexon
.head 3 -  Boolean: bEnableTimer
.head 3 -  Boolean: bEnableMsg
.head 3 -  Boolean: bUpdateStf
.head 3 -  Boolean: bInsertRoes
.head 3 -  Boolean: bInsertYpoxr
.head 3 -  Boolean: bSxoliRovn
.head 3 -  Boolean: bExeiRoes
.head 3 -  Boolean: bRohDil
.head 3 -  ! String: sCodeFoitIns
.head 3 -  ! String: sEjEgrTre
.head 3 -  Number: nOmMaxChoice
.head 3 -  Number: nYpMaxChoice
.head 3 -  Number: nTotMaxChoice
.head 3 -  ! Number: nDoDilosi
.head 3 -  ! Number: nAkTrexon
.head 3 -  ! Number: am_pro
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  ! New variables
.head 3 -  ! clsSqlHandleSelect: hEgrSel
.head 3 -  ! clsSqlHandleSelect: hEgrIns
.head 3 -  ! clsSqlHandleSelect: hEgrUpdt
.head 3 -  ! clsSqlHandleSelect: hEgrChkExist
.head 3 -  ! clsSqlHandleSelect: hEgrReply
.head 3 -  ! clsSqlHandleSelect: hSelYpcourse
.head 3 -  ! Number: nEgrExist
.head 3 -  ! Number: nAkEgr
.head 3 -  ! Number: nCountEgr
.head 3 -  ! Number: nCountOblistu
.head 3 -  ! String: sEjEgr
.head 3 -  ! String: sKatEgrFoit
.head 3 -  ! Date/Time: dDateEgr
.head 3 -  !
.head 3 -  String: sRemainStr
.head 3 -  ! String: sFind
.head 3 -  Number: nStrOffset
.head 3 -  Number: nStrLen
.head 3 -  Number: nPlithos
.head 3 -  Number: nZero
.head 3 -  ! Number: nMode
.head 3 -  !
.head 3 -  String: sY
.head 3 -  String: sL
.head 3 -  String: sH
.head 3 -  String: sD
.head 3 -  String: sT
.head 3 -  String: sS
.head 3 -  String: sZ
.head 3 -  String: sE
.head 3 -  String: sO
.head 3 -  String: sI
.head 3 -  String: sM
.head 3 -  String: sF
.head 3 -  String: sRohFoitEpilog[4]
.head 3 -  String: sRohOmadalekt
.head 3 -  String: sTroposEis
.head 3 -  !
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCreateWindow( frmSplash,  hWndForm )
.head 4 -  Call SalSendMsg( frmSplash ,  SAM_Create, 0 , 0 )
.head 4 -  !
.head 4 -  ! Εκκίνηση της διαδικασίας !
.head 4 -  !
.head 4 +  If NOT Procedure_GeneralCall()
.head 5 -  Call RollbackSession()
.head 4 -  ! Call InitMessages()
.head 4 -  ! Call ConnectHandles()
.head 4 -  ! Call InsProcedure()
.head 4 -  !
.head 4 -  !
.head 3 +  On SAM_Destroy
.head 4 -  ! ses
.head 4 -  ! Call DisconnectHandles()
.head 4 -  ! Call SqlClearImmediate()
.head 4 -  ! ses
.head 4 +  If NOT bSqlError
.head 5 +  If NOT bEnableTimer
.head 6 -  !
.head 6 -  Call CountFinEgr()
.head 6 -  !
.head 6 -  Set nBeginEgr = nBeginEgr - nFinalEgr 
.head 6 -  ! Set frmSplash.dfMsgToUser = ' Η διαδικασία ολοκληρώθηκε επιτυχώς. Καταχωρήθηκαν οι εγγραφές ' || SalNumberToStrX(nBeginEgr,0) || ' φοιτητών. '
.head 6 -  Set frmSplash.dfMsgToUser = ' Η διαδικασία ολοκληρώθηκε επιτυχώς. Καταχωρήθηκαν οι εγγραφές ' || SalNumberToStrX(nCountFoitEgrafi,0) || ' φοιτητών. '
.head 6 -  Set frmSplash.dfMsgToUser1 = ' Καταχωρήθηκαν οι υποχρεώσεις ' || SalNumberToStrX(nCountFoitOblistud,0) || ' φοιτητών. '
.head 6 -  Set frmSplash.dfMsgToUser2 = ' Καταχωρήθηκε η αριθμ. υποχρέωση σε ' || SalNumberToStrX(nCountFoitOblistu,0) || ' φοιτητές. '
.head 6 -  ! ses
.head 6 -  Call RestoreValues()
.head 6 -  ! Call RollbackSession()
.head 6 +  If NOT CommitSession()
.head 7 -  Call RollbackSession()
.head 6 -  Call FreeSession()
.head 6 -  ! ses
.head 6 -  !
.head 6 -  ! Timer
.head 6 -  Set bEnableTimer = SalTimerSet ( frmSplash, 1, 1000 )
.head 6 -  !
.head 4 -  !
.head 4 -  !
.head 3 -  On SAM_Close
.head 1 +  Form Window: frmSplash
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Εισαγωγή εγγραφών-υποχρεώσεων online αιτήσεων
.head 2 -  Icon File: C:\NTUARIS\IMAGES\ICO\ACADEMY.ico
.data RESOURCE 2 0 1 2143424337
0000: FE020000F2010000 0000000000000000 0200A20001000120 3010000000E80200
0020: 0000160000002800 0000002000000040 0008000001040000 00A380020000FFFF
0040: 8FC000000300C0C0 00C000680000C0C0 C00D00C000808080 80000000FF000003
0060: 00FFFF00FF006800 00FFFFFF4D00FF00 11D011111000007F 1940B9B9B1000000
0080: 876870FF00000120 119B9B10008777C0 0FF7700000000519 10087777FF800FF7
00A0: 80F00000000B0177 7FFFFF5007787000 00780078781917FF FFF7771080878000
00C0: 00077780F7FF1B91 7780003E000FFFD2 FF8000003F07FF80 FF80009000000007
00E0: 0399330077F28000 000739BB110000FE 00073B31000000FF 4739100000FF4733
0100: 100000FF773900FF 773900FF7739001F 7770007500390007 0778000770620003
0120: 3910003B07000780 00000091000000D3 800000B087000091 00F0080000000587
0140: 3900000008FB0087 33000000FFC10993 000000FFB0993000 0808BD00096B0080
0160: 001FF93000FC0000 F680006F8000ED80 00DB0800FFED0800 DB0800F68000F708
0180: FD008F0808003E00 C07F00C0FFC03F00 3FE00800001FFC00 000FC00010000780
01A0: 003F000000007F00 01FFFF001F00FFE0 81FFFFC0C7F0000F C3FFC003C7FF8000
01C0: 01C7FF0000C7FE00 300047FE00FF0019 C7FF87FF0031CFFF 00F8002200E00000
01E0: 00000C003F000F80 001107E00003F000 1107FC003FFF0045 FF8007FFE0003FFF
0200: FFF8FFFF
.enddata
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 1.65"
.head 4 -  Top: 1.74"
.head 4 -  Width:  8.483"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.214"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 36907
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.183"
.head 5 -  Top: 0.24"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: Πρόγραμμα ομαδικής εισαγωγής εγγραφών και
.head 4 -  Resource Id: 36908
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.283"
.head 5 -  Top: 0.344"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: υποχρεώσεων των φοιτητών από τις αιτήσεις
.head 4 -  Resource Id: 36909
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.483"
.head 5 -  Top: 0.594"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: που πραγματοποιήθηκαν από το διαδίκτυο
.head 4 -  Resource Id: 36910
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.25"
.head 5 -  Top: 0.865"
.head 5 -  Width:  5.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 +  Data Field: dfMsgToUser
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.15"
.head 6 -  Top: 1.427"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMsgToUser1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.15"
.head 6 -  Top: 1.702"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfMsgToUser2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.15"
.head 6 -  Top: 1.976"
.head 6 -  Width:  8.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbΕxit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Έξοδος
.head 4 -  Window Location and Size
.head 5 -  Left: 3.083"
.head 5 -  Top: 3.821"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg ( frmSplash, SAM_Destroy, 0, 0 )
.head 3 +  Pushbutton: pbDetail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: που καταχωρήθηκαν
.head 4 -  Window Location and Size
.head 5 -  Left: 5.583"
.head 5 -  Top: 3.655"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Set bDetails = TRUE
.head 6 -  ! If bDetails
.head 6 -  ! Call SalDisableWindow(pbDetail)
.head 6 -  Call SalModalDialog( dlgDetail, hWndForm )
.head 6 -  ! Call SalSendMsg(hWndForm,SAM_Destroy,0,0)
.head 3 +  Pushbutton: pbPreviewProblem
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: που έχουν πρόβλημα
.head 4 -  Window Location and Size
.head 5 -  Left: 5.583"
.head 5 -  Top: 4.012"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalModalDialog( dlgDetailProblem, hWndForm )
.head 3 -  Background Text: Δημιουργήθηκε από τον Θωμά Παπαδημητρίου
υπάλληλο της Διεύθυνσης Πληροφορικής του Ε.Μ.Π.
.head 4 -  Resource Id: 17674
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.917"
.head 5 -  Top: 4.976"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.536"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Gray
.head 4 -  Background Color: Default
.head 3 -  Group Box: Εγγραφές αναλυτικά
.head 4 -  Resource Id: 18491
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.317"
.head 5 -  Top: 3.369"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfOkEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.617"
.head 6 -  Top: 2.869"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfProblemEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.617"
.head 6 -  Top: 2.869"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPendingEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.617"
.head 6 -  Top: 2.869"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSynoloEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.417"
.head 6 -  Top: 2.869"
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: καταχωρήθηκαν
.head 4 -  Resource Id: 18497
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.317"
.head 5 -  Top: 2.56"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: έχουν πρόβλημα
.head 4 -  Resource Id: 18493
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.417"
.head 5 -  Top: 2.56"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: εκκρεμούν
.head 4 -  Resource Id: 18496
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.617"
.head 5 -  Top: 2.56"
.head 5 -  Width:  0.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Σύνολο
.head 4 -  Resource Id: 18495
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.517"
.head 5 -  Top: 2.56"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Αριθμός εγγραφών που:
.head 4 -  Resource Id: 18494
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.117"
.head 5 -  Top: 2.286"
.head 5 -  Width:  7.767"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Boolean: bOk
.head 2 +  Message Actions
.head 3 +  ! On SAM_Timer
.head 4 -  ! Call SalSendMsg( hWndForm,  SAM_Close, 0, 0 )
.head 4 -  ! Call CommitSession()
.head 4 -  ! Call FreeSession()
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalDisableWindow(pbΕxit)
.head 4 -  Call SalDisableWindow(pbDetail)
.head 4 -  Call SalDisableWindow(pbPreviewProblem)
.head 4 -  Set dfMsgToUser = 'Παρακαλώ περιμένετε, οι εγγραφές καταχωρούνται ...'
.head 4 -  Call SalSetFocus(pbΕxit)
.head 3 +  On SAM_Destroy
.head 4 +  ! If bDetails
.head 5 -  Call SalDisableWindow(pbDetail)
.head 5 -  Call SalModalDialog( dlgDetail, hWndForm )
.head 4 -  Call SalQuit()
.head 3 +  On SAM_Close
.head 4 -  ! ses
.head 4 -  ! Call RestoreValues()
.head 4 -  ! Call RollbackSession()
.head 4 -  ! Call CommitSession()
.head 4 -  ! Call FreeSession()
.head 4 -  ! ses
.head 4 -  ! Call ConnectH() 
.head 4 +  ! If NOT Del_Tbls_Pros()
.head 5 -  Call SalMessageBox( 'Αδυναμία καθαρισμού βοηθητικών πινάκων. Ενημερώστε τον διαχειριστή του συστήματος!', 'error!', MB_Ok )
.head 4 -  ! Call DisconnectH() 
.head 4 -  ! ses
.head 4 -  Return FALSE
.head 4 -  ! Call SalQuit()
.head 1 +  Form Window: frmLogin
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Σύνδεση χρήστη στη βάση δεδομένων & εισαγωγή/επισκόπηση στοιχείων
.head 2 -  Icon File: C:\NTUARIS\IMAGES\ICO\ACADEMY.ico
.data RESOURCE 2 0 1 2143424337
0000: FE020000F2010000 0000000000000000 0200A20001000120 3010000000E80200
0020: 0000160000002800 0000002000000040 0008000001040000 00A380020000FFFF
0040: 8FC000000300C0C0 00C000680000C0C0 C00D00C000808080 80000000FF000003
0060: 00FFFF00FF006800 00FFFFFF4D00FF00 11D011111000007F 1940B9B9B1000000
0080: 876870FF00000120 119B9B10008777C0 0FF7700000000519 10087777FF800FF7
00A0: 80F00000000B0177 7FFFFF5007787000 00780078781917FF FFF7771080878000
00C0: 00077780F7FF1B91 7780003E000FFFD2 FF8000003F07FF80 FF80009000000007
00E0: 0399330077F28000 000739BB110000FE 00073B31000000FF 4739100000FF4733
0100: 100000FF773900FF 773900FF7739001F 7770007500390007 0778000770620003
0120: 3910003B07000780 00000091000000D3 800000B087000091 00F0080000000587
0140: 3900000008FB0087 33000000FFC10993 000000FFB0993000 0808BD00096B0080
0160: 001FF93000FC0000 F680006F8000ED80 00DB0800FFED0800 DB0800F68000F708
0180: FD008F0808003E00 C07F00C0FFC03F00 3FE00800001FFC00 000FC00010000780
01A0: 003F000000007F00 01FFFF001F00FFE0 81FFFFC0C7F0000F C3FFC003C7FF8000
01C0: 01C7FF0000C7FE00 300047FE00FF0019 C7FF87FF0031CFFF 00F8002200E00000
01E0: 00000C003F000F80 001107E00003F000 1107FC003FFF0045 FF8007FFE0003FFF
0200: FFF8FFFF
.enddata
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 2.2"
.head 4 -  Top: 2.25"
.head 4 -  Width:  11.467"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.214"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Light Periwinkle
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfBaseName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.183"
.head 6 -  Top: 1.571"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set sBaseName = dfBaseName
.head 6 +  ! If dfBaseName = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Return FALSE
.head 3 +  Data Field: dfUsername
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.183"
.head 6 -  Top: 2.321"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set sUsername = dfUsername
.head 6 +  ! If dfUsername = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Return FALSE
.head 3 +  Data Field: dfPassword
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.183"
.head 6 -  Top: 3.071"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Set sPassword = dfPassword
.head 6 +  ! If dfPassword = ''
.head 7 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Return FALSE
.head 6 -  Call SalSetFocus(pbConnect)
.head 3 +  Pushbutton: pbConnect
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Σύνδεση
.head 4 -  Window Location and Size
.head 5 -  Left: 7.783"
.head 5 -  Top: 1.571"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Εάν δεν συνδεθεί μήνυμα ... 
.head 6 +  If NOT ConnectToDB()
.head 7 -  Call SalMessageBox( 'Αποτυχία σύνδεσης με τη βάση δεδομένων!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call RollbackSession()
.head 6 +  If 1!= 1
.head 7 +  If dfBaseName = ''
.head 8 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 8 -  Call SalSetFocus(dfBaseName)
.head 8 -  Return FALSE
.head 7 +  If dfUsername = ''
.head 8 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 8 -  Call SalSetFocus(dfUsername)
.head 8 -  Return FALSE
.head 7 +  If dfPassword = ''
.head 8 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 8 -  Call SalSetFocus(dfPassword)
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set SqlDatabase = sBaseName
.head 7 -  Set SqlUser = sUsername
.head 7 -  Set SqlPassword = sPassword
.head 7 -  ! Set SqlIsolationLevel = 'RL'
.head 7 -  Set sIsolationLevel = SqlIsolationLevel
.head 7 -  !
.head 7 -  ! Ανοίγει το session των εγγραφών σε εξάμηνο
.head 7 -  Call CreateSession()
.head 7 -  !
.head 7 -  ! Σύνδεση των Handles του session των εγγραφών σε εξάμηνο
.head 7 +  ! If NOT ConnectHandles()
.head 8 -  Call RollbackSession()
.head 7 -  !
.head 7 -  ! Δημιουργεί τα statements των εγγραφών σε εξάμηνο
.head 7 +  If NOT CreateStatements()
.head 8 -  Call RollbackSession()
.head 7 -  !
.head 7 -  ! Αρχικοποίηση μεταβλητών
.head 7 -  Call Initialize_INTO()
.head 7 -  Call Initialize_BINDS()
.head 7 -  Call Initialize_COMMANDS()
.head 7 -  !
.head 7 -  ! Αποθηκέυει τις απαιτούμενες εντολές στη βάση αν δεν έχει γίνει ήδη.
.head 7 +  If NOT StoreCommand ()
.head 8 -  Call RollbackSession()
.head 7 -  !
.head 7 +  If NOT SetInitValues()
.head 8 -  Call RollbackSession()
.head 7 -  !
.head 7 +  If bOkSession
.head 8 -  Call SalDisableWindow(pbConnect)
.head 8 -  Call SalEnableWindow(pbContinue)
.head 8 -  Call SalEnableWindow(pbPreview)
.head 8 -  Call SalEnableWindow(pbPreviewProblem)
.head 8 -  Call SalSetFocus(pbContinue)
.head 7 -  !
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Έξοδος
.head 4 -  Window Location and Size
.head 5 -  Left: 7.783"
.head 5 -  Top: 3.488"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set bExit = TRUE
.head 6 -  Call SalQuit()
.head 3 +  Pushbutton: pbContinue
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Εισαγωγή
.head 4 -  Window Location and Size
.head 5 -  Left: 7.783"
.head 5 -  Top: 1.988"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfBaseName = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfBaseName)
.head 7 -  Return FALSE
.head 6 +  If dfUsername = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfUsername)
.head 7 -  Return FALSE
.head 6 +  If dfPassword = ''
.head 7 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfPassword)
.head 7 -  Return FALSE
.head 6 +  If SalMessageBox (' Είστε σίγουροι ότι θέλετε να προχωρήσετε στην εισαγωγή των εγγραφών στο σύστημα; ',
 'Προειδοποίηση' , MB_YesNo | MB_IconExclamation ) = IDYES			
.head 7 +  If bOkSession
.head 8 -  Set bPreview = FALSE
.head 8 -  Call SalDestroyWindow(  hWndForm  )
.head 6 -  ! Call SalEndDialog( frmLogin,TRUE)
.head 3 +  Pushbutton: pbPreview
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: που εισήχθηκαν
.head 4 -  Window Location and Size
.head 5 -  Left: 7.783"
.head 5 -  Top: 2.655"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfBaseName = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfBaseName)
.head 7 -  Return FALSE
.head 6 +  If dfUsername = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfUsername)
.head 7 -  Return FALSE
.head 6 +  If dfPassword = ''
.head 7 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfPassword)
.head 7 -  Return FALSE
.head 6 +  If bOkSession
.head 7 -  Set bPreview = TRUE
.head 7 -  ! Call SalDestroyWindow(  hWndForm  )
.head 7 -  !
.head 7 +  If bOkSession and NOT bExit
.head 8 -  Call SalModalDialog( dlgDetail, hWndForm )
.head 6 -  ! Call SalEndDialog( frmLogin,TRUE)
.head 3 +  Pushbutton: pbPreviewProblem
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: με πρόβλημα
.head 4 -  Window Location and Size
.head 5 -  Left: 7.75"
.head 5 -  Top: 3.012"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfBaseName = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε το όνομα της βάσης δεδομένων που θέλετε να συνδεθείτε!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfBaseName)
.head 7 -  Return FALSE
.head 6 +  If dfUsername = ''
.head 7 -  Call SalMessageBox( 'Παρακαλώ συμπληρώστε όνομα χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfUsername)
.head 7 -  Return FALSE
.head 6 +  If dfPassword = ''
.head 7 -  Call SalMessageBox( 'Το πεδίο δεν μπορεί να είναι κενό. Πληκτρολογείστε τον κωδικό χρήστη!', 'Προειδοποίηση!', MB_Ok )
.head 7 -  Call SalSetFocus(dfPassword)
.head 7 -  Return FALSE
.head 6 +  If bOkSession
.head 7 -  Set bPreview = TRUE
.head 7 -  ! Call SalDestroyWindow(  hWndForm  )
.head 7 -  !
.head 7 +  If bOkSession and NOT bExit
.head 8 -  Call SalModalDialog( dlgDetailProblem, hWndForm )
.head 6 -  ! Call SalEndDialog( frmLogin,TRUE)
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 0.238"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: C:\NTUARIS\IMAGES\BMP\SYMBOL3_new.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Size for Best Fit
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 3
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Charcoal
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Όνομα Βάσης δεδομένων
.head 4 -  Resource Id: 24455
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.483"
.head 5 -  Top: 1.595"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Light Gray
.head 4 -  Background Color: Periwinkle
.head 3 -  Background Text: Όνομα Χρήστη
.head 4 -  Resource Id: 24456
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.483"
.head 5 -  Top: 2.369"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Light Gray
.head 4 -  Background Color: Periwinkle
.head 3 -  Background Text: Κωδικός Χρήστη
.head 4 -  Resource Id: 24457
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.283"
.head 5 -  Top: 3.143"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Light Gray
.head 4 -  Background Color: Periwinkle
.head 3 -  Frame
.head 4 -  Resource Id: 24458
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.283"
.head 5 -  Top: 0.238"
.head 5 -  Width:  7.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Periwinkle
.head 3 -  Frame
.head 4 -  Resource Id: 6036
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.483"
.head 5 -  Top: 0.429"
.head 5 -  Width:  6.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: Πρόγραμμα ομαδικής εισαγωγής εγγραφών και
.head 4 -  Resource Id: 6035
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.15"
.head 5 -  Top: 0.536"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: υποχρεώσεων των φοιτητών από τις αιτήσεις
.head 4 -  Resource Id: 6038
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.35"
.head 5 -  Top: 0.786"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: που πραγματοποιήθηκαν από το διαδίκτυο
.head 4 -  Resource Id: 6037
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.117"
.head 5 -  Top: 1.06"
.head 5 -  Width:  5.333"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: White
.head 4 -  Background Color: Light Periwinkle
.head 3 -  Background Text: Δημιουργήθηκε από τον Θωμά Παπαδημητρίου
υπάλληλο της Διεύθυνσης Πληροφορικής του Ε.Μ.Π.
.head 4 -  Resource Id: 17675
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.55"
.head 5 -  Top: 4.119"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Gray
.head 4 -  Background Color: Default
.head 3 -  Group Box: Επισκόπηση εγγραφών
.head 4 -  Resource Id: 18492
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.483"
.head 5 -  Top: 2.405"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Receive String: sBaseName
.head 3 -  ! Receive String: sUsername
.head 3 -  ! Receive String: sPassword
.head 2 +  Window Variables
.head 3 -  Boolean: bPreview
.head 2 +  Message Actions
.head 3 +  On SAM_Destroy
.head 4 +  If bOkSession and NOT bExit
.head 5 +  If bPreview
.head 6 -  Call SalModalDialog( dlgDetail, hWndForm )
.head 5 +  Else
.head 6 -  ! ses
.head 6 -  ! Call ConnectH() 
.head 6 +  If NOT Del_Tbls_Pros()
.head 7 -  Call SalMessageBox( 'Αδυναμία καθαρισμού βοηθητικών πινάκων. Ενημερώστε τον διαχειριστή του συστήματος!', 'error!', MB_Ok )
.head 6 -  ! Call DisconnectH() 
.head 6 -  ! ses
.head 6 -  Call SalCreateWindowEx(frmWebOmadEgrYX,hWndForm,0,0,0,0,CREATE_Hidden)
.head 3 +  On SAM_Close
.head 4 -  Return FALSE
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalDisableWindow(pbContinue)
.head 4 -  Call SalDisableWindow(pbPreview)
.head 4 -  Call SalDisableWindow(pbPreviewProblem)
.head 4 -  Set dfBaseName = 'BASE'
.head 4 -  ! Set dfBaseName = 'BASE01'
.head 4 -  Set sBaseName = dfBaseName
.head 4 -  Call SalSetFocus(dfUsername)
.head 1 +  Dialog Box: dlgDetail
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Καταχωρήσεις αναλυτικά
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  13.283"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 9.595"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 +  Contents
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Έξοδος
.head 5 -  Window Location and Size
.head 6 -  Left: 10.483"
.head 6 -  Top: 0.238"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If NOT Del_Tbls_Pros()
.head 8 -  Call SalMessageBox( 'Αδυναμία καθαρισμού βοηθητικών πινάκων. Ενημερώστε τον διαχειριστή του συστήματος!', 'error!', MB_Ok )
.head 7 -  Call DisconnectH()
.head 7 -  Call SalSendMsg(hWndForm, SAM_Close,0,0)
.head 2 +  Contents
.head 3 +  Child Table: tblWebEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 0.238"
.head 6 -  Width:  11.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 5000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Α/Α
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colK_f
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κωδ.Φοιτ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.033"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colK_f, SalTblQueryColumnID( colK_f ) )
.head 5 +  Column: colEpvn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Επώνυμο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.217"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEpvn, SalTblQueryColumnID( colEpvn ) )
.head 5 +  Column: colOnoma
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Όνομα
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colOnoma, SalTblQueryColumnID( colOnoma ) )
.head 5 +  Column: colPatr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Πατρ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colPatr, SalTblQueryColumnID( colPatr ) )
.head 5 +  Column: colAk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ακ. Έτος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colAk, SalTblQueryColumnID( colAk ) )
.head 5 +  Column: colXu
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Χ/Θ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colXu, SalTblQueryColumnID( colXu ) )
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colEgrDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ημερ.Εγγραφής
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEgrDate, SalTblQueryColumnID( colEgrDate ) )
.head 5 +  Column: colKat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κατ/νση
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colKat, SalTblQueryColumnID( colKat ) )
.head 5 +  Column: colRoes
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ροές
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEgrReply
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Μήνυμα                                                                                                                       
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  6.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Set mlEgrReply = ''
.head 6 -  Set sK_f_Selected = "'"|| tblWebEgr.colK_f ||"'"
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblD, hSel_OblDPros, "SELECT WEB_OBLD_PROS.K_M, TITLOS, WEB_OBLD_PROS.EJ, WEB_OBLD_PROS.AK, WEB_OBLD_PROS.OMADA
					FROM  WEB_OBLD_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLD_PROS.K_M AND ST_M.K_TM = WEB_OBLD_PROS.K_TM
					AND WEB_OBLD_PROS.AK = ST_M.AK AND WEB_OBLD_PROS.K_F  in ( "|| sK_f_Selected ||" ) 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblU, hSel_OblUPros, "SELECT WEB_OBLU_PROS.EJ, TOTEPIL
					FROM  WEB_OBLU_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLU_PROS.K_F AND WEB_OBLU_PROS.K_F  in ( "|| sK_f_Selected ||" )  
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 6 -  !
.head 6 -  !
.head 6 -  Set mlEgrReply = tblWebEgr.colEgrReply
.head 5 +  On SAM_RowSetContext
.head 6 -  Set mlEgrReply = ''
.head 6 -  Set sK_f_Selected = "'"|| tblWebEgr.colK_f ||"'"
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblD, hSel_OblDPros, "SELECT WEB_OBLD_PROS.K_M, TITLOS, WEB_OBLD_PROS.EJ, WEB_OBLD_PROS.AK, WEB_OBLD_PROS.OMADA
					FROM  WEB_OBLD_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLD_PROS.K_M AND ST_M.K_TM = WEB_OBLD_PROS.K_TM
					AND WEB_OBLD_PROS.AK = ST_M.AK AND WEB_OBLD_PROS.K_F  in ( "|| sK_f_Selected ||" ) 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblU, hSel_OblUPros, "SELECT WEB_OBLU_PROS.EJ, TOTEPIL
					FROM  WEB_OBLU_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLU_PROS.K_F AND WEB_OBLU_PROS.K_F  in ( "|| sK_f_Selected ||" )  
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 6 -  !
.head 6 -  Set mlEgrReply = tblWebEgr.colEgrReply
.head 5 +  ! On SAM_RowSetContext
.head 6 -  Set LsAitnoPrint = STRING_Null
.head 6 -  ! Call SqlImmediate (' Select PISTOREPLY  from WEBAIT_PISTOP INTO :LsAitnoPrint WHERE UriID = :colUriIDRep and K_PISTOP = :colK_Pistop ')
.head 6 -  Call SqlImmediate (' Select PISTOREPLY  from WEBAIT_PISTOP INTO :LsAitnoPrint WHERE WEBAIT_PISTOP.AID = :colaIDRep and k_tm = :nCodeTmima  ')
.head 6 -  Set mlMsgPrint  = LsAitnoPrint
.head 6 -  Call SqlClearImmediate()
.head 3 +  Child Table: tblWebOblD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 5.321"
.head 6 -  Width:  7.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colK_m
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κωδ. μαθ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colK_m, SalTblQueryColumnID( colK_m ) )
.head 5 +  Column: colTitlos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Τίτλος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.167"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colTitlos, SalTblQueryColumnID( colTitlos ) )
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colAk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ακ. Έτος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colAk, SalTblQueryColumnID( colAk ) )
.head 5 +  Column: colOmada
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ομάδα
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colOmada, SalTblQueryColumnID( colOmada ) )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Child Table: tblWebOblU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.483"
.head 6 -  Top: 5.321"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblU,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colTotepil
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Αρ. επιλογών
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblU,colTotepil, SalTblQueryColumnID( colTotepil ) )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Group Box: Υποχρεώσεις φοιτητή/τριας που καταχωρήθηκαν για το εξάμηνο εγγραφής
.head 4 -  Resource Id: 3443
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: 5.071"
.head 5 -  Width:  7.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Αριθμητική υποχρέωση φ. στο εξάμηνο
.head 4 -  Resource Id: 3444
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 8.283"
.head 5 -  Top: 5.071"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Εγγραφές φοιτητών/τριών σε εξάμηνο σπουδών ( Τελευταία στοιχεία που εισήχθησαν στο σύστημα )
.head 4 -  Resource Id: 3445
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: -0.012"
.head 5 -  Width:  12.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlEgrReply
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.383"
.head 6 -  Top: 4.071"
.head 6 -  Width:  11.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: Del_Tbls_Pros
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_EgrPros, 'DELETE FROM WEB_EGR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblDPros, 'DELETE FROM WEB_OBLD_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblUPros, 'DELETE FROM WEB_OBLU_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_EgrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblDPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblUPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If bReturnMsg
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Return TRUE
.head 3 +  ! Function: DisconnectH
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call SqlDisconnect( hSel_EgrPros )
.head 5 -  Call SqlDisconnect( hSel_OblDPros )
.head 5 -  Call SqlDisconnect( hSel_OblUPros )
.head 5 -  Call SqlDisconnect( hDel_EgrPros )
.head 5 -  Call SqlDisconnect( hDel_OblDPros )
.head 5 -  Call SqlDisconnect( hDel_OblUPros )
.head 3 +  ! Function: ConnectH
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call SqlConnect( hSel_EgrPros )
.head 5 -  Call SqlConnect( hSel_OblDPros )
.head 5 -  Call SqlConnect( hSel_OblUPros )
.head 5 -  Call SqlConnect( hDel_EgrPros )
.head 5 -  Call SqlConnect( hDel_OblDPros )
.head 5 -  Call SqlConnect( hDel_OblUPros )
.head 3 +  Function: SetAA
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblSetRange ( tblWebEgr, 0, nRowCount - 1 )
.head 5 -  Set nMaxRow = nRowCount
.head 5 -  Call SalTblQueryScroll ( tblWebEgr, nPosRow, nMinRow, nMaxRow )
.head 5 -  Call SalTblSetRow( tblWebEgr, TBL_SetFirstRow )
.head 5 -  Set nRow = nMinRow
.head 5 +  While nRow <= nMaxRow
.head 6 -  Set nRow = nRow + 1
.head 6 -  Call SalTblSetColumnText ( tblWebEgr, 1, SalNumberToStrX(nRow,0) )
.head 6 -  Call SalTblSetRow(tblWebEgr, TBL_SetNextRow )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Sql Handle: hSel_EgrPros
.head 3 -  ! Sql Handle: hSel_OblDPros
.head 3 -  ! Sql Handle: hSel_OblUPros
.head 3 -  ! Sql Handle: hDel_EgrPros
.head 3 -  ! Sql Handle: hDel_OblDPros
.head 3 -  ! Sql Handle: hDel_OblUPros
.head 3 -  String: sK_f_Selected
.head 3 -  ! Boolean: bReturnMsg
.head 3 -  Number: nRow
.head 3 -  Number: nMinRow
.head 3 -  Number: nMaxRow
.head 3 -  Number: nPosRow
.head 3 -  Number: nRowCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ConnectH()
.head 4 -  Call SalTblPopulate( tblWebEgr, hSel_EgrPros, "SELECT WEB_EGR_PROS.K_F, EPVN, ONOMA, PATR, WEB_EGR_PROS.AK, WEB_EGR_PROS.XU ,WEB_EGR_PROS.EJ, EGRDATE, 
						WEB_EGR_PROS.KAT, WEB_EGR_PROS.ROH,  WEB_EGR_PROS.EGRREPLY
					FROM  WEB_EGR_PROS, ST_F
					WHERE ST_F.K_F = WEB_EGR_PROS.K_F 
					INTO :tblWebEgr.colK_f, :tblWebEgr.colEpvn, :tblWebEgr.colOnoma, :tblWebEgr.colPatr, :tblWebEgr.colAk, :tblWebEgr.colXu, :tblWebEgr.colEj, :tblWebEgr.colEgrDate,
						 :tblWebEgr.colKat, :tblWebEgr.colRoes, :tblWebEgr.colEgrReply ", 2 )
.head 4 -  !
.head 4 -  ! Call SalTblPopulate( tblWebOblD, hSel_OblDPros, "SELECT WEB_OBLD_PROS.K_M, TITLOS, WEB_OBLD_PROS.EJ, WEB_OBLD_PROS.AK, WEB_OBLD_PROS.OMADA
					FROM  WEB_OBLD_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLD_PROS.K_M AND ST_M.K_TM = WEB_OBLD_PROS.K_TM
					AND WEB_OBLD_PROS.K_F = :1 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 4 -  !
.head 4 -  ! Call SalTblPopulate( tblWebOblU, hSel_OblUPros, "SELECT WEB_OBLU_PROS.EJ, TOTEPIL
					FROM  WEB_OBLU_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLU_PROS.K_F AND WEB_OBLU_PROS.K_F = :1
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 4 -  !
.head 4 -  ! Μετράει τις εγγραφές που εισάγονται στον πίνακα
.head 4 -  Call SqlGetResultSetCount ( hSel_EgrPros, nRowCount )
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  !
.head 4 -  ! Δίνει τον αύξοντα αριθμό στον πίνακα
.head 4 -  Call SetAA()
.head 4 -  !
.head 3 +  On SAM_Close
.head 4 -  Call SalDestroyWindow(hWndForm)
.head 1 +  Dialog Box: dlgDetailProblem
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Φοιτητές που οι εγγραφές τους δεν καταχωρήθηκαν, αναλυτικά στοιχεία
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  13.283"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 9.595"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Etched
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 +  Contents
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Έξοδος
.head 5 -  Window Location and Size
.head 6 -  Left: 10.483"
.head 6 -  Top: 0.238"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  ! If NOT Del_Tbls_Pros()
.head 8 -  Call SalMessageBox( 'Αδυναμία καθαρισμού βοηθητικών πινάκων. Ενημερώστε τον διαχειριστή του συστήματος!', 'error!', MB_Ok )
.head 7 -  Call DisconnectH()
.head 7 -  Call SalSendMsg(hWndForm, SAM_Close,0,0)
.head 2 +  Contents
.head 3 +  Child Table: tblWebEgr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 0.238"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.75"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Α/Α
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colK_f
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κωδ.Φοιτ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colK_f, SalTblQueryColumnID( colK_f ) )
.head 5 +  Column: colEpvn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Επώνυμο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.867"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEpvn, SalTblQueryColumnID( colEpvn ) )
.head 5 +  Column: colOnoma
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Όνομα
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colOnoma, SalTblQueryColumnID( colOnoma ) )
.head 5 +  Column: colPatr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Πατρ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colPatr, SalTblQueryColumnID( colPatr ) )
.head 5 +  Column: colAk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ακ. Έτος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colAk, SalTblQueryColumnID( colAk ) )
.head 5 +  Column: colXu
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Χ/Θ
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colXu, SalTblQueryColumnID( colXu ) )
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colEgrDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ημερ.Εγγραφής
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colEgrDate, SalTblQueryColumnID( colEgrDate ) )
.head 5 +  Column: colKat
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κατ/νση
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.867"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebEgr,colKat, SalTblQueryColumnID( colKat ) )
.head 5 +  Column: colRoes
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ροές
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEgrReply
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Αιτία                                                                                                                       
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2000
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  4.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Set mlEgrReply = ''
.head 6 -  Set sK_f_Selected = "'"|| tblWebEgr.colK_f ||"'"
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblD, hSel_OblDPrPros, "SELECT WEB_OBLDPR_PROS.K_M, TITLOS, WEB_OBLDPR_PROS.EJ, WEB_OBLDPR_PROS.AK, WEB_OBLDPR_PROS.OMADA
					FROM  WEB_OBLDPR_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLDPR_PROS.K_M AND ST_M.K_TM = WEB_OBLDPR_PROS.K_TM
					AND WEB_OBLDPR_PROS.AK = ST_M.AK AND WEB_OBLDPR_PROS.K_F  in ( "|| sK_f_Selected ||" ) 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblU, hSel_OblUPrPros, "SELECT WEB_OBLUPR_PROS.EJ, TOTEPIL
					FROM  WEB_OBLUPR_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLUPR_PROS.K_F AND WEB_OBLUPR_PROS.K_F  in ( "|| sK_f_Selected ||" )  
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 6 -  !
.head 6 -  Set mlEgrReply = tblWebEgr.colEgrReply
.head 6 -  !
.head 5 +  On SAM_RowSetContext
.head 6 -  Set mlEgrReply = ''
.head 6 -  Set sK_f_Selected = "'"|| tblWebEgr.colK_f ||"'"
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblD, hSel_OblDPrPros, "SELECT WEB_OBLDPR_PROS.K_M, TITLOS, WEB_OBLDPR_PROS.EJ, WEB_OBLDPR_PROS.AK, WEB_OBLDPR_PROS.OMADA
					FROM  WEB_OBLDPR_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLDPR_PROS.K_M AND ST_M.K_TM = WEB_OBLDPR_PROS.K_TM
					AND WEB_OBLDPR_PROS.AK = ST_M.AK AND WEB_OBLDPR_PROS.K_F  in ( "|| sK_f_Selected ||" ) 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 6 -  !
.head 6 -  Call SalTblPopulate( tblWebOblU, hSel_OblUPrPros, "SELECT WEB_OBLUPR_PROS.EJ, TOTEPIL
					FROM  WEB_OBLUPR_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLUPR_PROS.K_F AND WEB_OBLUPR_PROS.K_F  in ( "|| sK_f_Selected ||" )  
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 6 -  !
.head 6 -  Set mlEgrReply = tblWebEgr.colEgrReply
.head 3 +  Child Table: tblWebOblD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 5.321"
.head 6 -  Width:  7.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colK_m
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Κωδ. μαθ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colK_m, SalTblQueryColumnID( colK_m ) )
.head 5 +  Column: colTitlos
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Τίτλος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colTitlos, SalTblQueryColumnID( colTitlos ) )
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colAk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ακ. Έτος
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colAk, SalTblQueryColumnID( colAk ) )
.head 5 +  Column: colOmada
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ομάδα
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblD,colOmada, SalTblQueryColumnID( colOmada ) )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 +  Child Table: tblWebOblU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.683"
.head 6 -  Top: 5.321"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colEj
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Εξάμηνο
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblU,colEj, SalTblQueryColumnID( colEj ) )
.head 5 +  Column: colTotepil
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Αρ. επιλογών
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_CaptionDoubleClick
.head 8 -  !
.head 8 -  Call Tbl_SortCols (tblWebOblU,colTotepil, SalTblQueryColumnID( colTotepil ) )
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 -  Message Actions
.head 3 -  Group Box: Υποχρεώσεις φοιτητή/τριας που ΔΕΝ καταχωρήθηκαν για το εξάμηνο εγγραφής
.head 4 -  Resource Id: 18488
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: 5.071"
.head 5 -  Width:  8.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Αριθμητική υποχρέωση φ. στο εξάμηνο
.head 4 -  Resource Id: 18489
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 8.483"
.head 5 -  Top: 5.071"
.head 5 -  Width:  4.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Προβληματικές εγγραφές φοιτητών/τριών σε εξάμηνο σπουδών
.head 4 -  Resource Id: 18490
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: -0.012"
.head 5 -  Width:  12.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 5.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Multiline Field: mlEgrReply
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 4.071"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.857"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: Del_Tbls_Pros
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_EgrPros, 'DELETE FROM WEB_EGR_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblDPros, 'DELETE FROM WEB_OBLD_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlPrepareAndExecute ( hDel_OblUPros, 'DELETE FROM WEB_OBLU_PROS ' )
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_EgrPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblDPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If NOT SqlCommit(hDel_OblUPros)
.head 6 -  Set bReturnMsg = TRUE
.head 5 +  If bReturnMsg
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Return TRUE
.head 3 +  ! Function: DisconnectH
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call SqlDisconnect( hSel_EgrPros )
.head 5 -  Call SqlDisconnect( hSel_OblDPros )
.head 5 -  Call SqlDisconnect( hSel_OblUPros )
.head 5 -  Call SqlDisconnect( hDel_EgrPros )
.head 5 -  Call SqlDisconnect( hDel_OblDPros )
.head 5 -  Call SqlDisconnect( hDel_OblUPros )
.head 3 +  ! Function: ConnectH
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call SqlConnect( hSel_EgrPros )
.head 5 -  Call SqlConnect( hSel_OblDPros )
.head 5 -  Call SqlConnect( hSel_OblUPros )
.head 5 -  Call SqlConnect( hDel_EgrPros )
.head 5 -  Call SqlConnect( hDel_OblDPros )
.head 5 -  Call SqlConnect( hDel_OblUPros )
.head 3 +  Function: SetAA
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblSetRange ( tblWebEgr, 0, nRowCount - 1 )
.head 5 -  Set nMaxRow = nRowCount
.head 5 -  Call SalTblQueryScroll ( tblWebEgr, nPosRow, nMinRow, nMaxRow )
.head 5 -  Call SalTblSetRow( tblWebEgr, TBL_SetFirstRow )
.head 5 -  Set nRow = nMinRow
.head 5 +  While nRow <= nMaxRow
.head 6 -  Set nRow = nRow + 1
.head 6 -  Call SalTblSetColumnText ( tblWebEgr, 1, SalNumberToStrX(nRow,0) )
.head 6 -  Call SalTblSetRow(tblWebEgr, TBL_SetNextRow )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Sql Handle: hSel_EgrPros
.head 3 -  ! Sql Handle: hSel_OblDPros
.head 3 -  ! Sql Handle: hSel_OblUPros
.head 3 -  ! Sql Handle: hDel_EgrPros
.head 3 -  ! Sql Handle: hDel_OblDPros
.head 3 -  ! Sql Handle: hDel_OblUPros
.head 3 -  String: sK_f_Selected
.head 3 -  ! Boolean: bReturnMsg
.head 3 -  Number: nRow
.head 3 -  Number: nMinRow
.head 3 -  Number: nMaxRow
.head 3 -  Number: nPosRow
.head 3 -  Number: nRowCount
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call ConnectH()
.head 4 -  Call SalTblPopulate( tblWebEgr, hSel_EgrPrPros, "SELECT WEB_EGRPR_PROS.K_F, EPVN, ONOMA, PATR, WEB_EGRPR_PROS.AK, WEB_EGRPR_PROS.XU ,
					WEB_EGRPR_PROS.EJ, EGRDATE, WEB_EGRPR_PROS.KAT, WEB_EGRPR_PROS.ROH, WEB_EGRPR_PROS.EGRREPLY
					FROM  WEB_EGRPR_PROS, ST_F
					WHERE ST_F.K_F = WEB_EGRPR_PROS.K_F 
					INTO :tblWebEgr.colK_f, :tblWebEgr.colEpvn, :tblWebEgr.colOnoma, :tblWebEgr.colPatr, :tblWebEgr.colAk, :tblWebEgr.colXu, 
					:tblWebEgr.colEj, :tblWebEgr.colEgrDate, :tblWebEgr.colKat, :tblWebEgr.colRoes, :tblWebEgr.colEgrReply ", 2 )
.head 4 -  !
.head 4 -  ! Call SalTblPopulate( tblWebOblD, hSel_OblDPros, "SELECT WEB_OBLD_PROS.K_M, TITLOS, WEB_OBLD_PROS.EJ, WEB_OBLD_PROS.AK, WEB_OBLD_PROS.OMADA
					FROM  WEB_OBLD_PROS, ST_M
					WHERE ST_M.K_M = WEB_OBLD_PROS.K_M AND ST_M.K_TM = WEB_OBLD_PROS.K_TM
					AND WEB_OBLD_PROS.K_F = :1 
					INTO :tblWebOblD.colK_m, :tblWebOblD.colTitlos, :tblWebOblD.colEj, :tblWebOblD.colAk, :tblWebOblD.colOmada ", 2 )
.head 4 -  !
.head 4 -  ! Call SalTblPopulate( tblWebOblU, hSel_OblUPros, "SELECT WEB_OBLU_PROS.EJ, TOTEPIL
					FROM  WEB_OBLU_PROS, ST_F
					WHERE ST_F.K_F = WEB_OBLU_PROS.K_F AND WEB_OBLU_PROS.K_F = :1
					INTO  :tblWebOblU.colEj, :tblWebOblU.colTotepil  ", 2 )
.head 4 -  !
.head 4 -  ! Μετράει τις εγγραφές που εισάγονται στον πίνακα
.head 4 -  Call SqlGetResultSetCount ( hSel_EgrPrPros, nRowCount )
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  !
.head 4 -  ! Δίνει τον αύξοντα αριθμό στον πίνακα
.head 4 -  Call SetAA()
.head 4 -  !
.head 3 +  On SAM_Close
.head 4 -  Call SalDestroyWindow(hWndForm)
